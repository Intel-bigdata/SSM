{"version":3,"sources":["webpack:///app.a01a462d75c8f7e54e09.js","webpack:///webpack/bootstrap a01a462d75c8f7e54e09","webpack:///./src/index.js","webpack:///./src/app/app.js","webpack:///./src/app/app.controller.js","webpack:///./src/app/home/home.controller.js","webpack:///./src/app/handsontable/handsonHelper.js","webpack:///./src/app/notebook/notebook.controller.js","webpack:///./src/app/tabledata/tabledata.js","webpack:///./src/app/tabledata/transformation.js","webpack:///./src/app/tabledata/pivot.js","webpack:///./src/app/tabledata/passthrough.js","webpack:///./src/app/tabledata/columnselector.js","webpack:///./src/app/visualization/visualization.js","webpack:///./src/app/visualization/builtins/visualization-table.js","webpack:///./src/app/visualization/builtins/visualization-nvd3chart.js","webpack:///./src/app/visualization/builtins/visualization-barchart.js","webpack:///./src/app/visualization/builtins/visualization-piechart.js","webpack:///./src/app/visualization/builtins/visualization-areachart.js","webpack:///./src/app/visualization/builtins/visualization-linechart.js","webpack:///./src/app/visualization/builtins/visualization-scatterchart.js","webpack:///./src/app/jobmanager/jobmanager.controller.js","webpack:///./src/app/jobmanager/jobs/job.controller.js","webpack:///./src/app/jobmanager/jobmanager.filter.js","webpack:///./src/app/interpreter/interpreter.controller.js","webpack:///./src/app/interpreter/interpreter.filter.js","webpack:///./src/app/credential/credential.controller.js","webpack:///./src/app/configuration/configuration.controller.js","webpack:///./src/app/notebook/paragraph/paragraph.controller.js","webpack:///./src/app/notebook/paragraph/result/result.controller.js","webpack:///./src/app/search/result-list.controller.js","webpack:///./src/app/notebookRepos/notebookRepos.controller.js","webpack:///./src/app/helium/helium.controller.js","webpack:///./src/components/arrayOrderingSrv/arrayOrdering.service.js","webpack:///./src/components/clipboard/clipboard.controller.js","webpack:///./src/components/navbar/navbar.controller.js","webpack:///./src/components/ngescape/ngescape.directive.js","webpack:///./src/components/interpreter/interpreter.directive.js","webpack:///./src/components/expandCollapse/expandCollapse.directive.js","webpack:///./src/components/noteName-create/notename.controller.js","webpack:///./src/components/noteName-import/notenameImport.controller.js","webpack:///./src/components/popover-html-unsafe/popover-html-unsafe.directive.js","webpack:///./src/components/popover-html-unsafe/popover-html-unsafe-popup.directive.js","webpack:///./src/components/editor/codeEditor.directive.js","webpack:///./src/components/ngenter/ngenter.directive.js","webpack:///./src/components/dropdowninput/dropdowninput.directive.js","webpack:///./src/components/resizable/resizable.directive.js","webpack:///./src/components/noteName-create/visible.directive.js","webpack:///./src/components/websocketEvents/websocketMsg.service.js","webpack:///./src/components/websocketEvents/websocketEvents.factory.js","webpack:///./src/components/noteListDataFactory/noteList.datafactory.js","webpack:///./src/components/baseUrl/baseUrl.service.js","webpack:///./src/components/browser-detect/browserDetect.service.js","webpack:///./src/components/saveAs/saveAs.service.js","webpack:///./src/components/searchService/search.service.js","webpack:///./src/components/login/login.controller.js","webpack:///./src/components/elasticInputCtrl/elasticInput.controller.js","webpack:///./src/components/noteAction/noteAction.service.js","webpack:///./src/components/notevarshareService/notevarshare.service.js","webpack:///./src/components/rename/rename.controller.js","webpack:///./src/components/rename/rename.service.js","webpack:///./src/components/helium/helium.service.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","auth","$http","angular","injector","get","baseUrlSrv","defaults","withCredentials","jQuery","ajaxSetup","dataType","xhrFields","crossDomain","getRestApiBase","then","response","zeppelinWebApp","run","$rootScope","ticket","fromJson","data","body","errorResponse","bootstrapApplication","$location","$on","event","next","current","$$route","publicAccess","path","bootstrap","document","filter","text","replace","config","$httpProvider","$routeProvider","ngToastProvider","visBundleLoad","load","heliumService","when","templateUrl","controller","resolve","controllerAs","otherwise","redirectTo","configure","dismissButton","dismissOnClick","combineDuplications","timeout","$provide","factory","$q","responseError","rejection","status","info","$broadcast","reject","interceptors","push","constant","element","ready","String","prototype","endsWith","searchString","position","subjectString","this","toString","isFinite","Math","floor","length","lastIndex","indexOf","MainCtrl","$scope","$window","arrayOrderingSrv","looknfeel","init","asIframe","location","href","defaultPrevented","preventDefault","noteName","note","_","isEmpty","getNoteName","BootstrapDialog","defaultOptions","onshown","find","focus","configDefaultOptions","animate","$inject","HomeCtrl","noteListDataFactory","websocketMsgSrv","ngToast","noteActionSrv","TRASH_FOLDER_ID","dismiss","vm","notes","notebookHome","noteCustomHome","undefined","staticHome","isReloading","query","q","initHome","getHomeNote","reloadNoteList","reloadAllNotesFromRepo","isReloadingNotes","toggleFolderNode","node","hidden","on","e","viewOnly","renameNote","nodeId","nodePath","moveNoteToTrash","noteId","moveFolderToTrash","folderId","restoreNote","restoreFolder","restoreAll","renameFolder","removeNote","removeFolder","emptyTrash","clearAllParagraphOutput","isFilterNote","name","toLowerCase","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_createClass","defineProperties","target","props","i","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","HandsonHelper","columns","rows","comment","_numericValidator","bind","columnNames","resultRows","self","colHeaders","rowHeaders","stretchH","sortIndicator","columnSorting","contextMenu","manualColumnResize","manualRowResize","readOnly","readOnlyCellClassName","fillHandle","fragmentSelection","disableVisualSelection","cells","ro","co","pro","cellProperties","colType","type","renderer","td","row","col","prop","_cellRenderer","afterGetColHeader","TH","menu","_buildDropDownMenu","button","_buildTypeSwitchButton","_addButtonMenuEvent","Handsontable","Dom","addEvent","nodeName","_setColumnType","firstChild","lastChild","removeChild","appendChild","style","changeTypeMenu","removeMenu","stopImmediatePropagation","querySelectorAll","len","display","getBoundingClientRect","top","window","scrollY","pageYOffset","left","parentNode","removeEvent","activeCellType","item","createElement","types","className","innerText","textContent","innerHTML","isNaN","Number","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","_isNumeric","format","textAlign","renderers","NumericRenderer","apply","arguments","substring","TextRenderer","callback","d","moment","isValid","_setColumnValidator","updateSettings","validateCells","_isColumnSorted","sort","sortOrder","sortingEnabled","sortColumn","validator","_dateValidator","default","NotebookCtrl","$route","$routeParams","$timeout","saveAsService","noteVarShareService","convertPermissionsToArray","permissions","owners","val","readers","writers","editorToggled","tableToggled","showSetting","looknfeelOption","cronOption","interpreterSettings","interpreterBindings","isNoteDirty","saveTimer","connectedOnce","isRevisionPath","pattern","RegExp","test","noteRevisions","currentRevision","revisionView","param","initNotebook","getCronOptionNameFromValue","o","blockAnonUsers","zeppelinVersion","url","content","show","closable","closeByBackdrop","closeByKeyboard","title","message","buttons","label","action","dialog","close","clear","revisionId","getNoteByRevision","getNote","listRevisionHistory","currentRoute","setTimeout","routeParams","params","$id","paragraph","offset","scrollTo","focusParagraphOnClick","clickEvent","paragraphs","paragraphId","contains","addEventListener","keyboardShortcut","keyEvent","paragraphOnDoubleClick","isTrash","split","exportNote","jsonContent","JSON","stringify","saveAs","cloneNote","confirm","result","checkpointNote","commitMessage","getElementById","setNoteRevision","revisionList","splice","index","findIndex","initializeLookAndFeel","visitRevision","revision","danger","verticalPosition","dismissOnTimeout","runAllParagraphs","map","settings","saveNote","forEach","par","scope","saveParagraph","toggleAllEditor","showAllEditor","hideAllEditor","toggleAllTable","showAllTable","hideAllTable","isNoteRunning","killSaveTimer","cancel","startSaveTimer","setLookAndFeel","setConfig","setCronScheduler","cronExpr","cronExecutingUser","principal","cron","setCronExecutingUser","setReleaseResource","releaseresource","updateNote","updateNoteName","newName","trimmedNewName","trim","cleanParagraphExcept","noteCopy","editorHide","tableHide","addPara","each","para","removePara","removeIdx","idx","paragraphUrl","newIdx","removedPara","getInterpreterBindings","interpreterBindingsOrig","copy","setting","selected","selectedIntp","interpreterSelectionListeners","accept","sourceItemHandleScope","destSortableScope","itemMoved","orderChanged","openSetting","closeSetting","isSettingDirty","$apply","saveSetting","selectedSettingIds","no","saveInterpreterBindings","n","regExp","exec","toggleSetting","closePermissions","getPermissions","success","headers","permissionsOrig","selectJson","tokenSeparators","ajax","term","delay","processResults","results","users","children","roles","pagination","more","cache","width","tags","minimumInputLength","setIamOwner","select2","error","openPermissions","showPermissions","isPermissionsDirty","restartInterpreter","interpreter","thisConfirm","payload","$modalFooter","addClass","html","put","savePermissions","alert","modal","togglePermissions","isAnonymous","isOwner","toggleNotePersonalizedMode","personalizedMode","modeText","updatePersonalizedMode","equals","click","hide","newIndex","prevParagraph","moveParagraph","nextParagraph","currentParagraphId","insertParagraph","$unBindKeyEvent","isPersonalized","off","removeEventListener","actionbarHeight","lastElementChild","clientHeight","css","TableData","paragraphResult","array","textRows","msg","commentRow","textRow","textCols","cols","cols2","j","aggr","Transformation","_emitter","tableData","targetEl","getSetting","_scope","k","_prevSettingScope","_createNewScope","template","_templateRequest","t","_render","_targetEl","_compile","contents","_interopRequireDefault","obj","__esModule","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_transformation","_transformation2","PivotTransformation","_Transformation","getPrototypeOf","configObj","common","pivot","tableDataColumns","save","emitConfig","removeKey","keys","removeGroup","groups","removeValue","values","setValueAggr","firstTime","removeUnknown","selectDefault","unique","list","found","a","b","aggrFunc","sum","varA","parseFloat","varB","count","parseInt","min","max","avg","aggrFuncDiv","schema","s","order","keyKey","g","group","groupKey","v","valueKey","PassthroughTransformation","ColumnselectorTransformation","columnSelectorProp","_this","remove","selectorName","fields","f","Array","_renderSetting","Visualization","_dirty","_active","refresh","isActive","_visualization","_visualization2","_passthrough","_passthrough2","_handsonHelper","_handsonHelper2","TableVisualization","_Visualization","passthrough","hot","render","height","container","pluck","destroy","handsonHelper","getHandsonTableConfig","Nvd3ChartVisualization","append","chart","update","d3g","nv","models","configureChart","animationDuration","numberOfDataThreshold","ignoreErr","d3","select","attr","datum","transition","duration","x","round","slice","xLabels","abs","pow","customAbbrevFormatter","groupedThousandsWith3DigitsFormatter","allowTextXAxis","fillMissingValues","multiBarChart","concat","getSchemaUnderKey","traverse","sKey","rKey","r","func","rowName","rowValue","colName","valueOnly","cs","noKey","isMultiBarChart","rowNameIndex","rowIdx","colNameIndex","colIdx","rowIndexValue","xVar","yVar","y","withoutAggr","namesWithoutAggr","lastIndexOf","valueIndex","d3gIndex","join","selectAll","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getter","_visualizationNvd3chart","_visualizationNvd3chart2","_pivot","_pivot2","BarchartVisualization","_Nvd3ChartVisualizati","d3Data","d3DataFromPivot","yAxis","axisLabelDistance","tickFormat","yAxisTickFormat","stacked","dispatch","PiechartVisualization","generateLabel","suffix","prefix","showLabels","showTooltipPercent","AreachartVisualization","xAxis","xAxisTickFormat","useInteractiveGuideline","LinechartVisualization","lineWithFocus","currentMode","forceY","_columnselector","_columnselector2","ScatterchartVisualization","columnselectorProps","tooltip","columnselector","setScatterChart","yLabels","showDistX","showDistY","xValue","yValue","size","xValues","yValues","grpNameIndex","colIndexValue","grpIndexValue","grpIdx","grpName","isAllDiscrete","isDiscrete","setDiscreteScatterData","epsilon","sz","xval","yval","random","d3gvalues","grp","newRows","newRow","field","getUnique","uniqObj","uniqArr","threshold","options","JobmanagerCtrl","$interval","jobManagerFilter","asyncNotebookJobFilter","jobInfomations","filterConfig","JobInfomationsByFilter","jobTypeFilter","doFiltering","isLoadingFilter","filterValueToName","filterValue","maxStringLength","activeInterpreters","substr","setFilterValue","filterValueInterpreter","onChangeRunJobToAlwaysTopToggle","isRunningAlwaysTop","onChangeSortAsc","isSortByAsc","doFilterInputTyping","RETURN_KEY_CODE","dofilterTimeoutObject","isActiveSearchTimer","which","doForceFilterInputTyping","filterValueNotebookName","sortTooltipMsg","getNoteJobsList","$watch","unsubscribeJobManager","responseData","lastJobServerUnixTime","lastResponseUnixTime","jobs","jobInfomationsIndexs","indexBy","interpreterLists","uniq","indexStore","changedItem","newItem","changeOriginTarget","isRemoved","removeIndex","isRunningJob","noteType","unixTimeLastRun","JobCtrl","jobInformation","progressValue","getProgress","statusList","notebookJob","runningJob","countBy","totalCount","runningJobCount","matchCount","ceil","runNotebookJob","notebookId","method","Content-Type","errorText","stopNotebookJob","lastExecuteTime","unixtime","unix","fromNow","filterContext","jobItems","filterItems","jobItem","where","lowerFilterValue","toLocaleLowerCase","lowerNotebookName","match","sortBy","sortItem","reverse","InterpreterCtrl","interpreterSettingsTmp","availableInterpreters","showAddNewSetting","showRepositoryInfo","searchInterpreter","showInterpreterAuth","getSelectJson","multiple","intpName","getInterpreterSettings","checkDownloadingDependencies","isDownloading","errorReason","originalPath","getAvailableInterpreters","emptyNewProperty","extend","propertyValue","propertyKey","emptyNewDependency","depArtifact","depExclude","removeTMPSettings","copyOriginInterpreterSettingProperties","settingId","setPerNoteOption","sessionOption","option","newInterpreterSetting","perNote","session","process","setPerUserOption","perUser","getPerNoteOption","getPerUserOption","getInterpreterRunningOption","sharedModeName","globallyModeName","perNoteModeName","perUserModeName","setInterpreterRunningOption","isPerNoteMode","isPerUserMode","updateInterpreterSetting","form","addNewInterpreterProperty","addNewInterpreterDependency","isExistingProcess","setPermission","isUserImpersonate","remote","request","properties","dependencies","$show","resetInterpreterSetting","removeInterpreterSetting","delete","newInterpreterGroupChange","el","intpInfo","defaultValue","description","restartInterpreterSetting","errorMsg","addNewInterpreterSetting","newSetting","newProperties","post","resetNewInterpreterSetting","cancelInterpreterSetting","removeInterpreterProperty","removeInterpreterDependency","artifact","groupArtifactVersion","exclusions","dep","resetNewRepositorySetting","newRepoSetting","snapshot","username","password","proxyProtocol","proxyHost","proxyPort","proxyLogin","proxyPassword","getRepositories","repositories","addNewRepository","removeRepository","repoId","isDefaultRepository","showErrorMessage","showSparkUI","open","sortByKey","sortedKeys","CredentialCtrl","credentialInfo","showAddNewCredentialInfo","getCredentialInfo","userCredentials","entity","addNewCredentialInfo","newCredential","resetCredentialInfo","autocomplete","source","toggleAddNewCredentialInfo","cancelCredentialInfo","copyOriginCredentialsInfo","updateCredentialInfo","removeCredentialInfo","ConfigurationCtrl","configrations","getConfigurations","configurations","ParagraphCtrl","$compile","ANGULAR_FUNCTION_OBJECT_NAME_PREFIX","parentNote","originalText","editor","editorSetting","pastePercentSign","setInterpreterBindings","paragraphScope","$new","compiledScope","z","runParagraph","filtered","angularBind","varName","clientBindAngularObject","angularUnbind","clientUnbindAngularObject","angularObjectRegistry","newParagraph","baseMapOption","colWidthOption","paragraphFocused","initializeDefault","forms","colWidth","enabled","runOnSelectionChange","editOnDblClick","isOutputHidden","getIframeDimensions","paragraphid","newValue","oldValue","$$absUrl","postMessage","toJson","getEditor","setReadOnly","isRunning","cancelParagraph","cancelParagraphRun","dirtyText","closeEditorAndOpenTable","openEditorAndOpenTable","commitParagraph","toggleEnableDisable","editorValue","turnOnAutoRun","moveUp","$emit","moveDown","insertNew","copyPara","getEditorValue","copyParagraph","removeParagraph","clearParagraphOutput","toggleEditor","openEditor","closeEditor","closeTable","openTable","openEditorAndCloseTable","manageEditorAndTableState","hideEditor","hideTable","showTitle","hideTitle","setTitle","showLineNumbers","lineNumbers","setShowGutter","hideLineNumbers","columnWidthClass","changeColWidth","removeClass","toggleOutput","loadForm","formulaire","toggleCheckbox","aceChanged","getSession","getValue","setParagraphMode","getCursorPosition","aceLoaded","_editor","langTools","ace","require","Range","$blockScrolling","Infinity","setShowFoldWidgets","setHighlightActiveLine","setHighlightGutterLine","setUseWrapMode","setTheme","goToEnd","autoAdjustEditorHeight","resize","navigator","appVersion","setKeyboardHandler","isMac","remoteCompleter","getCompletions","pos","isFocused","getTextRange","column","buf","completion","completions","score","setCompleters","keyWordCompleter","snippetCompleter","textCompleter","setOptions","enableBasicAutocompletion","enableSnippets","enableLiveAutocompletion","handleFocus","editSession","commands","bindKey","removeCommand","keyBindingEditorFocusAction","scrollValue","numRows","getLength","currentRow","scrollToCursor","keyBinding","origOnCommandKey","onCommandKey","hashId","keyCode","completer","activated","cursorPos","$cursorLayer","getPixelPosition","ROW_UP","ROW_DOWN","ctrlKey","altKey","isDigestPass","$digest","getEditorSetting","interpreterName","deferred","defer","promise","setEditorLanguage","language","mode","editorMode","setMode","paragraphText","magic","getInterpreterName","merge","intpNameRegexp","$parent","getScreenLength","lineHeight","scrollBar","getWidth","lastCursorMove","scrollTargetPos","headerHeight","scrollTriggerEdgeMargin","documentHeight","windowHeight","scrollPosition","scrollTop","editorPosition","lastCursorPosition","calculatedCursorPosition","bodyEl","stop","finish","axis","interrupt","currentProgress","getExecutionTime","pdata","timeMs","Date","parse","dateFinished","dateStarted","isResultOutdated","user","getElapsedTime","dateUpdated","navigateFileEnd","getResultType","parseTableCell","cell","goToSingleParagraph","pathParams","redirectToUrl","protocol","host","pathname","showScrollDownIcon","doc","scrollHeight","innerHeight","scrollParagraphDown","keepScrollDown","showScrollUpIcon","scrollParagraphUp","registry","angularObject","interpreterGroupId","skipEmit","clearWatcher","updateAngularObject","funcName","dateCreated","jobName","errorMessage","statusChanged","resultRefreshed","newResult","oldResult","newConfig","oldConfig","aborted","progress","noShortcutDefined","shiftKey","mouseEvent","gotoLine","blur","ResultCtrl","$templateRequest","$sce","builtInTableDataVisualizationList","icon","transformation","builtInVisualizations","table","class","pieChart","stackedAreaChart","lineChart","scatterChart","resultIndex","enableHelium","graphMode","imageData","heliumVis","vis","trustAsHtml","updateData","renderResult","paragraphRef","appendTextOutput","clearTextOutput","graph","optionOpen","_tabledata2","loadParagraphResult","tableDataComment","activeApp","getSuggestions","getApplicationStates","app","apps","renderApp","retryRenderer","elem","renderGraph","renderHtml","renderAngular","renderText","htmlEl","hljs","highlightBlock","MathJax","Hub","Queue","err","getTextEl","textRendererInitialized","textEl","flushAppendQueue","textAppendQueueBeforeInitialize","pop","lines","graphContainerEl","builtInViz","deactivate","transformationSettingTargetEl","visualizationSettingTargetEl","getVizConfig","getTransformation","transformed","transform","renderSetting","activate","emitter","graphSetting","commitVizConfigChange","createNewScope","switchViz","newMode","newParams","set","commitParagraphResult","newParagraphConfig","toggleGraphSetting","vizId","commonSetting","changeHeight","exportToDSV","delimiter","dsv","exportedFileName","titleIndex","dsvRow","stringValue","extension","getBase64ImageSrc","base64Data","suggestion","switchApp","appId","commitConfig","loadApp","heliumPackage","appStates","pkg","output","currentAppState","newAppState","appState","getAppScope","paragraphAppState","getAppRegistry","_tabledata","_visualizationTable","_visualizationTable2","_visualizationBarchart","_visualizationBarchart2","_visualizationPiechart","_visualizationPiechart2","_visualizationAreachart","_visualizationAreachart2","_visualizationLinechart","_visualizationLinechart2","_visualizationScatterchart","_visualizationScatterchart2","SearchResultCtrl","searchService","isResult","searchTerm","search","$promise","page","allResults","highlightSearchResults","getEditorMode","editorModes","ace/mode/scala","ace/mode/python","ace/mode/r","ace/mode/sql","ace/mode/markdown","ace/mode/sh","reduce","res","getIndeces","str","indeces","setOption","header","snippet","line","__line","start","end","addMarker","setValue","NotebookReposCtrl","saveNotebookRepo","valueform","repo","notebookRepos","showDropdownSelected","_getInterpreterSettings","_init","HeliumCtrl","packageInfos","defaultVersions","showVersions","visualizationOrder","visualizationOrderChanged","buildDefaultVersionListToDisplay","pkgs","pkgIdx","getAllPackageInfo","getVisualizationOrder","visualizationOrderListeners","saveVisualizationOrder","setVisualizationOrder","getLicense","license","enable","disable","toggleVersions","pkgName","getPackageSize","pkgSearchResult","noteListOrdering","service","clipboardCtrl","complete","copied","clipError","NavCtrl","getZeppelinVersion","initController","isDrawNavbarNoteList","perfectScrollbar","suppressScrollX","loadNotes","listConfigurations","getNoteList","logout","logoutURL","userName","showLoginWindow","initNotebookListEventListener","connected","isConnected","searchForm","setNotes","ngEscape","attrs","$eval","directive","interpreterDirective","restrict","link","$last","expandCollapse","slideUp","toggleClass","first","slideToggle","stopPropagation","NotenameCtrl","clone","defaultInterpreter","createNote","notename","defaultInterpreterId","createNotebook","handleNameEnter","preVisible","sourceNoteName","cloneNoteName","newNoteName","newCount","flatList","lastCount","copyCount","newCloneName","endsWithNumber","noteNamePrefix","regexp","lastCopyCount","NoteImportCtrl","step1","step2","maxLimit","limit","resetFlags","uploadFile","importFile","files","file","reader","FileReader","onloadend","processImportJson","readAsText","uploadURL","importBack","importNote","importUrl","jsonp","xhr","ajaxOptions","thrownError","done","_typeof","noteImportName","Symbol","iterator","popoverHtmlUnsafe","$uibTooltip","popoverHtmlUnsafePopup","placement","animation","isOpen","codeEditor","onLoad","editorHtml","ngEnter","dropdownInput","resizable","resizableConfig","autoHide","handles","helper","$observe","resetResize","colStep","innerWidth","conf","graphType","grid","minHeight","maxWidth","allowresize","modalvisible","preVisibleCallback","postVisibleCallback","targetinput","previsibleMethod","postVisibleMethod","relatedTarget","websocketEvents","sendNewEvent","op","deleteNote","noteIdToClone","noteConfig","modeValue","personalized","folderName","paragraphTitle","paragraphData","paragraphConfig","paragraphParams","cursor","replName","getUpdateNoteJobsList","lastUpdateServerUnixTime","lastUpdateUnixTime","$websocket","pingIntervalId","websocketCalls","ws","getWebsocketUrl","reconnectIfNotNormalClose","onOpen","setInterval","send","socket","readyState","onMessage","noteJobs","noteRunningJobs","btn","closeAll","onError","onClose","clearInterval","root","flatFolderMap","notesList","nodes","addNode","curDir","shift","dir","newDir","getPort","port","wsProtocol","hostname","skipTrailingSlash","browserDetectService","detectIE","ua","userAgent","msie","trident","rv","edge","filename","BOM","frameSaveAs","contentWindow","write","t1","now","execCommand","t2","encodeURIComponent","saveAsElement","$resource","encQuery","LoginCtrl","$httpParamSerializer","SigningIn","loginParams","login","redirectLocation","$$search","initValues","locationPath","ElasticInputCtrl","showEditor","renameSrv","normalizeFolderId","redirectToHome","TYPE_WARNING","notePath","openRenameModal","oldName","newFolderId","has","store","del","RenameCtrl","defaultValidator","rename","validate","visualizations","eval"],"mappings":"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","file":"app.a01a462d75c8f7e54e09.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(1);\n\t\n\t__webpack_require__(2);\n\t\n\t__webpack_require__(3);\n\t\n\t__webpack_require__(4);\n\t\n\t__webpack_require__(5);\n\t\n\t__webpack_require__(6);\n\t\n\t__webpack_require__(7);\n\t\n\t__webpack_require__(8);\n\t\n\t__webpack_require__(9);\n\t\n\t__webpack_require__(10);\n\t\n\t__webpack_require__(11);\n\t\n\t__webpack_require__(12);\n\t\n\t__webpack_require__(13);\n\t\n\t__webpack_require__(14);\n\t\n\t__webpack_require__(15);\n\t\n\t__webpack_require__(16);\n\t\n\t__webpack_require__(17);\n\t\n\t__webpack_require__(18);\n\t\n\t__webpack_require__(19);\n\t\n\t__webpack_require__(20);\n\t\n\t__webpack_require__(21);\n\t\n\t__webpack_require__(22);\n\t\n\t__webpack_require__(23);\n\t\n\t__webpack_require__(24);\n\t\n\t__webpack_require__(25);\n\t\n\t__webpack_require__(26);\n\t\n\t__webpack_require__(27);\n\t\n\t__webpack_require__(28);\n\t\n\t__webpack_require__(29);\n\t\n\t__webpack_require__(30);\n\t\n\t__webpack_require__(31);\n\t\n\t__webpack_require__(32);\n\t\n\t__webpack_require__(33);\n\t\n\t__webpack_require__(34);\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(36);\n\t\n\t__webpack_require__(37);\n\t\n\t__webpack_require__(38);\n\t\n\t__webpack_require__(39);\n\t\n\t__webpack_require__(40);\n\t\n\t__webpack_require__(41);\n\t\n\t__webpack_require__(42);\n\t\n\t__webpack_require__(43);\n\t\n\t__webpack_require__(44);\n\t\n\t__webpack_require__(45);\n\t\n\t__webpack_require__(46);\n\t\n\t__webpack_require__(47);\n\t\n\t__webpack_require__(48);\n\t\n\t__webpack_require__(49);\n\t\n\t__webpack_require__(50);\n\t\n\t__webpack_require__(51);\n\t\n\t__webpack_require__(52);\n\t\n\t__webpack_require__(53);\n\t\n\t__webpack_require__(54);\n\t\n\t__webpack_require__(55);\n\t\n\t__webpack_require__(56);\n\t\n\t__webpack_require__(57);\n\t\n\t__webpack_require__(58);\n\t\n\t__webpack_require__(59);\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed to the Apache Software Foundation (ASF) under one or more\n\t * contributor license agreements.  See the NOTICE file distributed with\n\t * this work for additional information regarding copyright ownership.\n\t * The ASF licenses this file to You under the Apache License, Version 2.0\n\t * (the \"License\"); you may not use this file except in compliance with\n\t * the License.  You may obtain a copy of the License at\n\t *\n\t *    http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tvar zeppelinWebApp = angular.module('zeppelinWebApp', ['ngCookies', 'ngAnimate', 'ngRoute', 'ngSanitize', 'angular-websocket', 'ui.ace', 'ui.bootstrap', 'as.sortable', 'ngTouch', 'ngDragDrop', 'angular.filter', 'monospaced.elastic', 'puElasticInput', 'xeditable', 'ngToast', 'focus-if', 'ngResource', 'ngclipboard']).filter('breakFilter', function () {\n\t  return function (text) {\n\t    if (!!text) {\n\t      return text.replace(/\\n/g, '<br />');\n\t    }\n\t  };\n\t}).config([\"$httpProvider\", \"$routeProvider\", \"ngToastProvider\", function ($httpProvider, $routeProvider, ngToastProvider) {\n\t  // withCredentials when running locally via grunt\n\t  $httpProvider.defaults.withCredentials = true;\n\t\n\t  var visBundleLoad = {\n\t    load: ['heliumService', function (heliumService) {\n\t      return heliumService.load;\n\t    }]\n\t  };\n\t\n\t  $routeProvider.when('/', {\n\t    templateUrl: 'app/home/home.html'\n\t  }).when('/notebook/:noteId', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/notebook/:noteId/paragraph?=:paragraphId', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/notebook/:noteId/paragraph/:paragraphId?', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/notebook/:noteId/revision/:revisionId', {\n\t    templateUrl: 'app/notebook/notebook.html',\n\t    controller: 'NotebookCtrl',\n\t    resolve: visBundleLoad\n\t  }).when('/jobmanager', {\n\t    templateUrl: 'app/jobmanager/jobmanager.html',\n\t    controller: 'JobmanagerCtrl'\n\t  }).when('/interpreter', {\n\t    templateUrl: 'app/interpreter/interpreter.html',\n\t    controller: 'InterpreterCtrl'\n\t  }).when('/notebookRepos', {\n\t    templateUrl: 'app/notebookRepos/notebookRepos.html',\n\t    controller: 'NotebookReposCtrl',\n\t    controllerAs: 'noterepo'\n\t  }).when('/credential', {\n\t    templateUrl: 'app/credential/credential.html',\n\t    controller: 'CredentialCtrl'\n\t  }).when('/helium', {\n\t    templateUrl: 'app/helium/helium.html',\n\t    controller: 'HeliumCtrl'\n\t  }).when('/configuration', {\n\t    templateUrl: 'app/configuration/configuration.html',\n\t    controller: 'ConfigurationCtrl'\n\t  }).when('/search/:searchTerm', {\n\t    templateUrl: 'app/search/result-list.html',\n\t    controller: 'SearchResultCtrl'\n\t  }).otherwise({\n\t    redirectTo: '/'\n\t  });\n\t\n\t  ngToastProvider.configure({\n\t    dismissButton: true,\n\t    dismissOnClick: false,\n\t    combineDuplications: true,\n\t    timeout: 6000\n\t  });\n\t}]\n\t\n\t//handel logout on API failure\n\t).config([\"$httpProvider\", \"$provide\", function ($httpProvider, $provide) {\n\t  $provide.factory('httpInterceptor', [\"$q\", \"$rootScope\", function ($q, $rootScope) {\n\t    return {\n\t      'responseError': function responseError(rejection) {\n\t        if (rejection.status === 405) {\n\t          var data = {};\n\t          data.info = '';\n\t          $rootScope.$broadcast('session_logout', data);\n\t        }\n\t        $rootScope.$broadcast('httpResponseError', rejection);\n\t        return $q.reject(rejection);\n\t      }\n\t    };\n\t  }]);\n\t  $httpProvider.interceptors.push('httpInterceptor');\n\t}]).constant('TRASH_FOLDER_ID', '~Trash');\n\t\n\tfunction auth() {\n\t  var $http = angular.injector(['ng']).get('$http');\n\t  var baseUrlSrv = angular.injector(['zeppelinWebApp']).get('baseUrlSrv');\n\t  // withCredentials when running locally via grunt\n\t  $http.defaults.withCredentials = true;\n\t  jQuery.ajaxSetup({\n\t    dataType: 'json',\n\t    xhrFields: {\n\t      withCredentials: true\n\t    },\n\t    crossDomain: true\n\t  });\n\t  return $http.get(baseUrlSrv.getRestApiBase() + '/security/ticket').then(function (response) {\n\t    zeppelinWebApp.run([\"$rootScope\", function ($rootScope) {\n\t      $rootScope.ticket = angular.fromJson(response.data).body;\n\t    }]);\n\t  }, function (errorResponse) {\n\t    // Handle error case\n\t  });\n\t}\n\t\n\tfunction bootstrapApplication() {\n\t  zeppelinWebApp.run([\"$rootScope\", \"$location\", function ($rootScope, $location) {\n\t    $rootScope.$on('$routeChangeStart', function (event, next, current) {\n\t      if (!$rootScope.ticket && next.$$route && !next.$$route.publicAccess) {\n\t        $location.path('/');\n\t      }\n\t    });\n\t  }]);\n\t  angular.bootstrap(document, ['zeppelinWebApp']);\n\t}\n\t\n\tangular.element(document).ready(function () {\n\t  auth().then(bootstrapApplication);\n\t}\n\t\n\t// See ZEPPELIN-2577. No graphs visible on IE 11\n\t// Polyfill. https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\n\t);if (!String.prototype.endsWith) {\n\t  // eslint-disable-next-line no-extend-native\n\t  String.prototype.endsWith = function (searchString, position) {\n\t    var subjectString = this.toString();\n\t    if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {\n\t      position = subjectString.length;\n\t    }\n\t    position -= searchString.length;\n\t    var lastIndex = subjectString.indexOf(searchString, position);\n\t    return lastIndex !== -1 && lastIndex === position;\n\t  };\n\t}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('MainCtrl', MainCtrl);\n\t\n\tMainCtrl.$inject = ['$scope', '$rootScope', '$window', 'arrayOrderingSrv'];\n\t\n\tfunction MainCtrl($scope, $rootScope, $window, arrayOrderingSrv) {\n\t  $scope.looknfeel = 'default';\n\t\n\t  var init = function init() {\n\t    $scope.asIframe = $window.location.href.indexOf('asIframe') > -1 ? true : false;\n\t  };\n\t\n\t  init();\n\t\n\t  $rootScope.$on('setIframe', function (event, data) {\n\t    if (!event.defaultPrevented) {\n\t      $scope.asIframe = data;\n\t      event.preventDefault();\n\t    }\n\t  });\n\t\n\t  $rootScope.$on('setLookAndFeel', function (event, data) {\n\t    if (!event.defaultPrevented && data && data !== '' && data !== $scope.looknfeel) {\n\t      $scope.looknfeel = data;\n\t      event.preventDefault();\n\t    }\n\t  });\n\t\n\t  // Set The lookAndFeel to default on every page\n\t  $rootScope.$on('$routeChangeStart', function (event, next, current) {\n\t    $rootScope.$broadcast('setLookAndFeel', 'default');\n\t  });\n\t\n\t  $rootScope.noteName = function (note) {\n\t    if (!_.isEmpty(note)) {\n\t      return arrayOrderingSrv.getNoteName(note);\n\t    }\n\t  };\n\t\n\t  BootstrapDialog.defaultOptions.onshown = function () {\n\t    angular.element('#' + this.id).find('.btn:last').focus();\n\t  };\n\t\n\t  // Remove BootstrapDialog animation\n\t  BootstrapDialog.configDefaultOptions({ animate: false });\n\t}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('HomeCtrl', HomeCtrl);\n\t\n\tHomeCtrl.$inject = ['$scope', 'noteListDataFactory', 'websocketMsgSrv', '$rootScope', 'arrayOrderingSrv', 'ngToast', 'noteActionSrv', 'TRASH_FOLDER_ID'];\n\t\n\tfunction HomeCtrl($scope, noteListDataFactory, websocketMsgSrv, $rootScope, arrayOrderingSrv, ngToast, noteActionSrv, TRASH_FOLDER_ID) {\n\t  ngToast.dismiss();\n\t  var vm = this;\n\t  vm.notes = noteListDataFactory;\n\t  vm.websocketMsgSrv = websocketMsgSrv;\n\t  vm.arrayOrderingSrv = arrayOrderingSrv;\n\t\n\t  vm.notebookHome = false;\n\t  vm.noteCustomHome = true;\n\t  if ($rootScope.ticket !== undefined) {\n\t    vm.staticHome = false;\n\t  } else {\n\t    vm.staticHome = true;\n\t  }\n\t\n\t  $scope.isReloading = false;\n\t  $scope.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n\t  $scope.query = { q: '' };\n\t\n\t  $scope.initHome = function () {\n\t    websocketMsgSrv.getHomeNote();\n\t    vm.noteCustomHome = false;\n\t  };\n\t\n\t  $scope.reloadNoteList = function () {\n\t    websocketMsgSrv.reloadAllNotesFromRepo();\n\t    $scope.isReloadingNotes = true;\n\t  };\n\t\n\t  $scope.toggleFolderNode = function (node) {\n\t    node.hidden = !node.hidden;\n\t  };\n\t\n\t  angular.element('#loginModal').on('hidden.bs.modal', function (e) {\n\t    $rootScope.$broadcast('initLoginValues');\n\t  });\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteMenu', function (event, notes) {\n\t    $scope.isReloadingNotes = false;\n\t  });\n\t\n\t  $scope.$on('setNoteContent', function (event, note) {\n\t    if (vm.noteCustomHome) {\n\t      return;\n\t    }\n\t\n\t    if (note) {\n\t      vm.note = note;\n\t\n\t      // initialize look And Feel\n\t      $rootScope.$broadcast('setLookAndFeel', 'home');\n\t\n\t      // make it read only\n\t      vm.viewOnly = true;\n\t\n\t      vm.notebookHome = true;\n\t      vm.staticHome = false;\n\t    } else {\n\t      vm.staticHome = true;\n\t      vm.notebookHome = false;\n\t    }\n\t  });\n\t\n\t  $scope.renameNote = function (nodeId, nodePath) {\n\t    noteActionSrv.renameNote(nodeId, nodePath);\n\t  };\n\t\n\t  $scope.moveNoteToTrash = function (noteId) {\n\t    noteActionSrv.moveNoteToTrash(noteId, false);\n\t  };\n\t\n\t  $scope.moveFolderToTrash = function (folderId) {\n\t    noteActionSrv.moveFolderToTrash(folderId);\n\t  };\n\t\n\t  $scope.restoreNote = function (noteId) {\n\t    websocketMsgSrv.restoreNote(noteId);\n\t  };\n\t\n\t  $scope.restoreFolder = function (folderId) {\n\t    websocketMsgSrv.restoreFolder(folderId);\n\t  };\n\t\n\t  $scope.restoreAll = function () {\n\t    noteActionSrv.restoreAll();\n\t  };\n\t\n\t  $scope.renameFolder = function (node) {\n\t    noteActionSrv.renameFolder(node.id);\n\t  };\n\t\n\t  $scope.removeNote = function (noteId) {\n\t    noteActionSrv.removeNote(noteId, false);\n\t  };\n\t\n\t  $scope.removeFolder = function (folderId) {\n\t    noteActionSrv.removeFolder(folderId);\n\t  };\n\t\n\t  $scope.emptyTrash = function () {\n\t    noteActionSrv.emptyTrash();\n\t  };\n\t\n\t  $scope.clearAllParagraphOutput = function (noteId) {\n\t    noteActionSrv.clearAllParagraphOutput(noteId);\n\t  };\n\t\n\t  $scope.isFilterNote = function (note) {\n\t    if (!$scope.query.q) {\n\t      return true;\n\t    }\n\t\n\t    var noteName = note.name;\n\t    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n\t      return true;\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.getNoteName = function (note) {\n\t    return arrayOrderingSrv.getNoteName(note);\n\t  };\n\t}\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * HandsonHelper class\n\t */\n\tvar HandsonHelper = function () {\n\t  function HandsonHelper(columns, rows, comment) {\n\t    _classCallCheck(this, HandsonHelper);\n\t\n\t    this.columns = columns || [];\n\t    this.rows = rows || [];\n\t    this.comment = comment || '';\n\t    this._numericValidator = this._numericValidator.bind(this);\n\t  }\n\t\n\t  _createClass(HandsonHelper, [{\n\t    key: 'getHandsonTableConfig',\n\t    value: function getHandsonTableConfig(columns, columnNames, resultRows) {\n\t      var self = this;\n\t      return {\n\t        colHeaders: columnNames,\n\t        data: resultRows,\n\t        rowHeaders: false,\n\t        stretchH: 'all',\n\t        sortIndicator: true,\n\t        columns: columns,\n\t        columnSorting: true,\n\t        contextMenu: false,\n\t        manualColumnResize: true,\n\t        manualRowResize: true,\n\t        readOnly: true,\n\t        readOnlyCellClassName: '',\n\t        fillHandle: false,\n\t        fragmentSelection: true,\n\t        disableVisualSelection: true,\n\t        cells: function cells(ro, co, pro) {\n\t          var cellProperties = {};\n\t          var colType = columns[co].type;\n\t          cellProperties.renderer = function (instance, td, row, col, prop, value, cellProperties) {\n\t            self._cellRenderer(instance, td, row, col, prop, value, cellProperties, colType);\n\t          };\n\t          return cellProperties;\n\t        },\n\t        afterGetColHeader: function afterGetColHeader(col, TH) {\n\t          var instance = this;\n\t          var menu = self._buildDropDownMenu(columns[col].type);\n\t          var button = self._buildTypeSwitchButton();\n\t\n\t          self._addButtonMenuEvent(button, menu);\n\t\n\t          Handsontable.Dom.addEvent(menu, 'click', function (event) {\n\t            if (event.target.nodeName === 'LI') {\n\t              self._setColumnType(columns, event.target.data.colType, instance, col);\n\t            }\n\t          });\n\t          if (TH.firstChild.lastChild.nodeName === 'BUTTON') {\n\t            TH.firstChild.removeChild(TH.firstChild.lastChild);\n\t          }\n\t          TH.firstChild.appendChild(button);\n\t          TH.style['white-space'] = 'normal';\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: '_addButtonMenuEvent',\n\t\n\t\n\t    /*\n\t    ** Private Service Functions\n\t    */\n\t\n\t    value: function _addButtonMenuEvent(button, menu) {\n\t      Handsontable.Dom.addEvent(button, 'click', function (event) {\n\t        var changeTypeMenu;\n\t        var position;\n\t        var removeMenu;\n\t\n\t        document.body.appendChild(menu);\n\t\n\t        event.preventDefault();\n\t        event.stopImmediatePropagation();\n\t\n\t        changeTypeMenu = document.querySelectorAll('.changeTypeMenu');\n\t\n\t        for (var i = 0, len = changeTypeMenu.length; i < len; i++) {\n\t          changeTypeMenu[i].style.display = 'none';\n\t        }\n\t        menu.style.display = 'block';\n\t        position = button.getBoundingClientRect();\n\t\n\t        menu.style.top = position.top + (window.scrollY || window.pageYOffset) + 2 + 'px';\n\t        menu.style.left = position.left + 'px';\n\t\n\t        removeMenu = function removeMenu(event) {\n\t          if (menu.parentNode) {\n\t            menu.parentNode.removeChild(menu);\n\t          }\n\t        };\n\t        Handsontable.Dom.removeEvent(document, 'click', removeMenu);\n\t        Handsontable.Dom.addEvent(document, 'click', removeMenu);\n\t      });\n\t    }\n\t  }, {\n\t    key: '_buildDropDownMenu',\n\t    value: function _buildDropDownMenu(activeCellType) {\n\t      var menu = document.createElement('UL');\n\t      var types = ['text', 'numeric', 'date'];\n\t      var item;\n\t\n\t      menu.className = 'changeTypeMenu';\n\t\n\t      for (var i = 0, len = types.length; i < len; i++) {\n\t        item = document.createElement('LI');\n\t        if ('innerText' in item) {\n\t          item.innerText = types[i];\n\t        } else {\n\t          item.textContent = types[i];\n\t        }\n\t\n\t        item.data = { 'colType': types[i] };\n\t\n\t        if (activeCellType === types[i]) {\n\t          item.className = 'active';\n\t        }\n\t        menu.appendChild(item);\n\t      }\n\t\n\t      return menu;\n\t    }\n\t  }, {\n\t    key: '_buildTypeSwitchButton',\n\t    value: function _buildTypeSwitchButton() {\n\t      var button = document.createElement('BUTTON');\n\t\n\t      button.innerHTML = '\\u25BC';\n\t      button.className = 'changeType';\n\t\n\t      return button;\n\t    }\n\t  }, {\n\t    key: '_isNumeric',\n\t    value: function _isNumeric(value) {\n\t      if (!isNaN(value)) {\n\t        if (value.length !== 0) {\n\t          if (Number(value) <= Number.MAX_SAFE_INTEGER && Number(value) >= Number.MIN_SAFE_INTEGER) {\n\t            return true;\n\t          }\n\t        }\n\t      }\n\t      return false;\n\t    }\n\t  }, {\n\t    key: '_cellRenderer',\n\t    value: function _cellRenderer(instance, td, row, col, prop, value, cellProperties, colType) {\n\t      if (colType === 'numeric' && this._isNumeric(value)) {\n\t        cellProperties.format = '0,0.[00000]';\n\t        td.style.textAlign = 'left';\n\t        Handsontable.renderers.NumericRenderer.apply(this, arguments);\n\t      } else if (value.length > '%html'.length && '%html ' === value.substring(0, '%html '.length)) {\n\t        td.innerHTML = value.substring('%html'.length);\n\t      } else {\n\t        Handsontable.renderers.TextRenderer.apply(this, arguments);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_dateValidator',\n\t    value: function _dateValidator(value, callback) {\n\t      var d = moment(value);\n\t      return callback(d.isValid());\n\t    }\n\t  }, {\n\t    key: '_numericValidator',\n\t    value: function _numericValidator(value, callback) {\n\t      return callback(this._isNumeric(value));\n\t    }\n\t  }, {\n\t    key: '_setColumnType',\n\t    value: function _setColumnType(columns, type, instance, col) {\n\t      columns[col].type = type;\n\t      this._setColumnValidator(columns, col);\n\t      instance.updateSettings({ columns: columns });\n\t      instance.validateCells(null);\n\t      if (this._isColumnSorted(instance, col)) {\n\t        instance.sort(col, instance.sortOrder);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_isColumnSorted',\n\t    value: function _isColumnSorted(instance, col) {\n\t      return instance.sortingEnabled && instance.sortColumn === col;\n\t    }\n\t  }, {\n\t    key: '_setColumnValidator',\n\t    value: function _setColumnValidator(columns, col) {\n\t      if (columns[col].type === 'numeric') {\n\t        columns[col].validator = this._numericValidator;\n\t      } else if (columns[col].type === 'date') {\n\t        columns[col].validator = this._dateValidator;\n\t      } else {\n\t        columns[col].validator = null;\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return HandsonHelper;\n\t}();\n\t\n\texports.default = HandsonHelper;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NotebookCtrl', NotebookCtrl);\n\t\n\tNotebookCtrl.$inject = ['$scope', '$route', '$routeParams', '$location', '$rootScope', '$http', 'websocketMsgSrv', 'baseUrlSrv', '$timeout', 'saveAsService', 'ngToast', 'noteActionSrv', 'noteVarShareService', 'TRASH_FOLDER_ID'];\n\t\n\tfunction NotebookCtrl($scope, $route, $routeParams, $location, $rootScope, $http, websocketMsgSrv, baseUrlSrv, $timeout, saveAsService, ngToast, noteActionSrv, noteVarShareService, TRASH_FOLDER_ID) {\n\t\n\t  ngToast.dismiss();\n\t\n\t  $scope.note = null;\n\t  $scope.moment = moment;\n\t  $scope.editorToggled = false;\n\t  $scope.tableToggled = false;\n\t  $scope.viewOnly = false;\n\t  $scope.showSetting = false;\n\t  $scope.looknfeelOption = ['default', 'simple', 'report'];\n\t  $scope.cronOption = [{ name: 'None', value: undefined }, { name: '1m', value: '0 0/1 * * * ?' }, { name: '5m', value: '0 0/5 * * * ?' }, { name: '1h', value: '0 0 0/1 * * ?' }, { name: '3h', value: '0 0 0/3 * * ?' }, { name: '6h', value: '0 0 0/6 * * ?' }, { name: '12h', value: '0 0 0/12 * * ?' }, { name: '1d', value: '0 0 0 * * ?' }];\n\t\n\t  $scope.interpreterSettings = [];\n\t  $scope.interpreterBindings = [];\n\t  $scope.isNoteDirty = null;\n\t  $scope.saveTimer = null;\n\t\n\t  var connectedOnce = false;\n\t  var isRevisionPath = function isRevisionPath(path) {\n\t    var pattern = new RegExp('^.*\\/notebook\\/[a-zA-Z0-9_]*\\/revision\\/[a-zA-Z0-9_]*');\n\t    return pattern.test(path);\n\t  };\n\t\n\t  $scope.noteRevisions = [];\n\t  $scope.currentRevision = 'Head';\n\t  $scope.revisionView = isRevisionPath($location.path());\n\t\n\t  $scope.$on('setConnectedStatus', function (event, param) {\n\t    if (connectedOnce && param) {\n\t      initNotebook();\n\t    }\n\t    connectedOnce = true;\n\t  });\n\t\n\t  $scope.getCronOptionNameFromValue = function (value) {\n\t    if (!value) {\n\t      return '';\n\t    }\n\t\n\t    for (var o in $scope.cronOption) {\n\t      if ($scope.cronOption[o].value === value) {\n\t        return $scope.cronOption[o].name;\n\t      }\n\t    }\n\t    return value;\n\t  };\n\t\n\t  $scope.blockAnonUsers = function () {\n\t    var zeppelinVersion = $rootScope.zeppelinVersion;\n\t    var url = 'https://zeppelin.apache.org/docs/' + zeppelinVersion + '/security/notebook_authorization.html';\n\t    var content = 'Only authenticated user can set the permission.' + '<a data-toggle=\"tooltip\" data-placement=\"top\" title=\"Learn more\" target=\"_blank\" href=' + url + '>' + '<i class=\"icon-question\" />' + '</a>';\n\t    BootstrapDialog.show({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: 'No permission',\n\t      message: content,\n\t      buttons: [{\n\t        label: 'Close',\n\t        action: function action(dialog) {\n\t          dialog.close();\n\t        }\n\t      }]\n\t    });\n\t  };\n\t\n\t  /** Init the new controller */\n\t  var initNotebook = function initNotebook() {\n\t    noteVarShareService.clear();\n\t    if ($routeParams.revisionId) {\n\t      websocketMsgSrv.getNoteByRevision($routeParams.noteId, $routeParams.revisionId);\n\t    } else {\n\t      websocketMsgSrv.getNote($routeParams.noteId);\n\t    }\n\t    websocketMsgSrv.listRevisionHistory($routeParams.noteId);\n\t    var currentRoute = $route.current;\n\t    if (currentRoute) {\n\t      setTimeout(function () {\n\t        var routeParams = currentRoute.params;\n\t        var $id = angular.element('#' + routeParams.paragraph + '_container');\n\t\n\t        if ($id.length > 0) {\n\t          // adjust for navbar\n\t          var top = $id.offset().top - 103;\n\t          angular.element('html, body').scrollTo({ top: top, left: 0 });\n\t        }\n\t      }, 1000);\n\t    }\n\t  };\n\t\n\t  initNotebook();\n\t\n\t  $scope.focusParagraphOnClick = function (clickEvent) {\n\t    if (!$scope.note) {\n\t      return;\n\t    }\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      var paragraphId = $scope.note.paragraphs[i].id;\n\t      if (jQuery.contains(angular.element('#' + paragraphId + '_container')[0], clickEvent.target)) {\n\t        $scope.$broadcast('focusParagraph', paragraphId, 0, true);\n\t        break;\n\t      }\n\t    }\n\t  };\n\t\n\t  // register mouseevent handler for focus paragraph\n\t  document.addEventListener('click', $scope.focusParagraphOnClick);\n\t\n\t  $scope.keyboardShortcut = function (keyEvent) {\n\t    // handle keyevent\n\t    if (!$scope.viewOnly && !$scope.revisionView) {\n\t      $scope.$broadcast('keyEvent', keyEvent);\n\t    }\n\t  };\n\t\n\t  // register mouseevent handler for focus paragraph\n\t  document.addEventListener('keydown', $scope.keyboardShortcut);\n\t\n\t  $scope.paragraphOnDoubleClick = function (paragraphId) {\n\t    $scope.$broadcast('doubleClickParagraph', paragraphId);\n\t  };\n\t\n\t  // Move the note to trash and go back to the main page\n\t  $scope.moveNoteToTrash = function (noteId) {\n\t    noteActionSrv.moveNoteToTrash(noteId, true);\n\t  };\n\t\n\t  // Remove the note permanently if it's in the trash\n\t  $scope.removeNote = function (noteId) {\n\t    noteActionSrv.removeNote(noteId, true);\n\t  };\n\t\n\t  $scope.isTrash = function (note) {\n\t    return note ? note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n\t  };\n\t\n\t  //Export notebook\n\t  $scope.exportNote = function () {\n\t    var jsonContent = JSON.stringify($scope.note);\n\t    saveAsService.saveAs(jsonContent, $scope.note.name, 'json');\n\t  };\n\t\n\t  //Clone note\n\t  $scope.cloneNote = function (noteId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to clone this note?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.cloneNote(noteId);\n\t          $location.path('/');\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  // checkpoint/commit notebook\n\t  $scope.checkpointNote = function (commitMessage) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Commit note to current repository?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.checkpointNote($routeParams.noteId, commitMessage);\n\t        }\n\t      }\n\t    });\n\t    document.getElementById('note.checkpoint.message').value = '';\n\t  };\n\t\n\t  // set notebook head to given revision\n\t  $scope.setNoteRevision = function () {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Set notebook head to current revision?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.setNoteRevision($routeParams.noteId, $routeParams.revisionId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.$on('listRevisionHistory', function (event, data) {\n\t    console.log('received list of revisions %o', data);\n\t    $scope.noteRevisions = data.revisionList;\n\t    $scope.noteRevisions.splice(0, 0, {\n\t      id: 'Head',\n\t      message: 'Head'\n\t    });\n\t    if ($routeParams.revisionId) {\n\t      var index = _.findIndex($scope.noteRevisions, { 'id': $routeParams.revisionId });\n\t      if (index > -1) {\n\t        $scope.currentRevision = $scope.noteRevisions[index].message;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('noteRevision', function (event, data) {\n\t    console.log('received note revision %o', data);\n\t    if (data.note) {\n\t      $scope.note = data.note;\n\t      initializeLookAndFeel();\n\t    } else {\n\t      $location.path('/');\n\t    }\n\t  });\n\t\n\t  $scope.$on('setNoteRevisionResult', function (event, data) {\n\t    console.log('received set note revision result %o', data);\n\t    if (data.status) {\n\t      $location.path('/notebook/' + $routeParams.noteId);\n\t    }\n\t  });\n\t\n\t  $scope.visitRevision = function (revision) {\n\t    if (revision.id) {\n\t      if (revision.id === 'Head') {\n\t        $location.path('/notebook/' + $routeParams.noteId);\n\t      } else {\n\t        $location.path('/notebook/' + $routeParams.noteId + '/revision/' + revision.id);\n\t      }\n\t    } else {\n\t      ngToast.danger({ content: 'There is a problem with this Revision',\n\t        verticalPosition: 'top', dismissOnTimeout: false });\n\t    }\n\t  };\n\t\n\t  $scope.runAllParagraphs = function (noteId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Run all paragraphs?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          var paragraphs = $scope.note.paragraphs.map(function (p) {\n\t            return {\n\t              id: p.id,\n\t              title: p.title,\n\t              paragraph: p.text,\n\t              config: p.config,\n\t              params: p.settings.params\n\t            };\n\t          });\n\t          websocketMsgSrv.runAllParagraphs(noteId, paragraphs);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.saveNote = function () {\n\t    if ($scope.note && $scope.note.paragraphs) {\n\t      _.forEach($scope.note.paragraphs, function (par) {\n\t        angular.element('#' + par.id + '_paragraphColumn_main').scope().saveParagraph(par);\n\t      });\n\t      $scope.isNoteDirty = null;\n\t    }\n\t  };\n\t\n\t  $scope.clearAllParagraphOutput = function (noteId) {\n\t    noteActionSrv.clearAllParagraphOutput(noteId);\n\t  };\n\t\n\t  $scope.toggleAllEditor = function () {\n\t    if ($scope.editorToggled) {\n\t      $scope.$broadcast('openEditor');\n\t    } else {\n\t      $scope.$broadcast('closeEditor');\n\t    }\n\t    $scope.editorToggled = !$scope.editorToggled;\n\t  };\n\t\n\t  $scope.showAllEditor = function () {\n\t    $scope.$broadcast('openEditor');\n\t  };\n\t\n\t  $scope.hideAllEditor = function () {\n\t    $scope.$broadcast('closeEditor');\n\t  };\n\t\n\t  $scope.toggleAllTable = function () {\n\t    if ($scope.tableToggled) {\n\t      $scope.$broadcast('openTable');\n\t    } else {\n\t      $scope.$broadcast('closeTable');\n\t    }\n\t    $scope.tableToggled = !$scope.tableToggled;\n\t  };\n\t\n\t  $scope.showAllTable = function () {\n\t    $scope.$broadcast('openTable');\n\t  };\n\t\n\t  $scope.hideAllTable = function () {\n\t    $scope.$broadcast('closeTable');\n\t  };\n\t\n\t  $scope.isNoteRunning = function () {\n\t    if (!$scope.note) {\n\t      return false;\n\t    }\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      var status = $scope.note.paragraphs[i].status;\n\t      if (status === 'PENDING' || status === 'RUNNING') {\n\t        return true;\n\t      }\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.killSaveTimer = function () {\n\t    if ($scope.saveTimer) {\n\t      $timeout.cancel($scope.saveTimer);\n\t      $scope.saveTimer = null;\n\t    }\n\t  };\n\t\n\t  $scope.startSaveTimer = function () {\n\t    $scope.killSaveTimer();\n\t    $scope.isNoteDirty = true;\n\t    //console.log('startSaveTimer called ' + $scope.note.id);\n\t    $scope.saveTimer = $timeout(function () {\n\t      $scope.saveNote();\n\t    }, 10000);\n\t  };\n\t\n\t  angular.element(window).on('beforeunload', function (e) {\n\t    $scope.killSaveTimer();\n\t    $scope.saveNote();\n\t  });\n\t\n\t  $scope.setLookAndFeel = function (looknfeel) {\n\t    $scope.note.config.looknfeel = looknfeel;\n\t    if ($scope.revisionView === true) {\n\t      $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n\t    } else {\n\t      $scope.setConfig();\n\t    }\n\t  };\n\t\n\t  /** Set cron expression for this note **/\n\t  $scope.setCronScheduler = function (cronExpr) {\n\t    if (cronExpr) {\n\t      if (!$scope.note.config.cronExecutingUser) {\n\t        $scope.note.config.cronExecutingUser = $rootScope.ticket.principal;\n\t      }\n\t    } else {\n\t      $scope.note.config.cronExecutingUser = '';\n\t    }\n\t    $scope.note.config.cron = cronExpr;\n\t    $scope.setConfig();\n\t  };\n\t\n\t  /** Set the username of the user to be used to execute all notes in notebook **/\n\t  $scope.setCronExecutingUser = function (cronExecutingUser) {\n\t    $scope.note.config.cronExecutingUser = cronExecutingUser;\n\t    $scope.setConfig();\n\t  };\n\t\n\t  /** Set release resource for this note **/\n\t  $scope.setReleaseResource = function (value) {\n\t    $scope.note.config.releaseresource = value;\n\t    $scope.setConfig();\n\t  };\n\t\n\t  /** Update note config **/\n\t  $scope.setConfig = function (config) {\n\t    if (config) {\n\t      $scope.note.config = config;\n\t    }\n\t    websocketMsgSrv.updateNote($scope.note.id, $scope.note.name, $scope.note.config);\n\t  };\n\t\n\t  /** Update the note name */\n\t  $scope.updateNoteName = function (newName) {\n\t    var trimmedNewName = newName.trim();\n\t    if (trimmedNewName.length > 0 && $scope.note.name !== trimmedNewName) {\n\t      $scope.note.name = trimmedNewName;\n\t      websocketMsgSrv.renameNote($scope.note.id, $scope.note.name);\n\t    }\n\t  };\n\t\n\t  var initializeLookAndFeel = function initializeLookAndFeel() {\n\t    if (!$scope.note.config.looknfeel) {\n\t      $scope.note.config.looknfeel = 'default';\n\t    } else {\n\t      $scope.viewOnly = $scope.note.config.looknfeel === 'report' ? true : false;\n\t    }\n\t\n\t    if ($scope.note.paragraphs && $scope.note.paragraphs[0]) {\n\t      $scope.note.paragraphs[0].focus = true;\n\t    }\n\t    $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n\t  };\n\t\n\t  var cleanParagraphExcept = function cleanParagraphExcept(paragraphId, note) {\n\t    var noteCopy = {};\n\t    noteCopy.id = note.id;\n\t    noteCopy.name = note.name;\n\t    noteCopy.config = note.config;\n\t    noteCopy.info = note.info;\n\t    noteCopy.paragraphs = [];\n\t    for (var i = 0; i < note.paragraphs.length; i++) {\n\t      if (note.paragraphs[i].id === paragraphId) {\n\t        noteCopy.paragraphs[0] = note.paragraphs[i];\n\t        if (!noteCopy.paragraphs[0].config) {\n\t          noteCopy.paragraphs[0].config = {};\n\t        }\n\t        noteCopy.paragraphs[0].config.editorHide = true;\n\t        noteCopy.paragraphs[0].config.tableHide = false;\n\t        break;\n\t      }\n\t    }\n\t    return noteCopy;\n\t  };\n\t\n\t  var addPara = function addPara(paragraph, index) {\n\t    $scope.note.paragraphs.splice(index, 0, paragraph);\n\t    _.each($scope.note.paragraphs, function (para) {\n\t      if (para.id === paragraph.id) {\n\t        para.focus = true;\n\t        $scope.$broadcast('focusParagraph', para.id, 0, false);\n\t      }\n\t    });\n\t  };\n\t\n\t  var removePara = function removePara(paragraphId) {\n\t    var removeIdx;\n\t    _.each($scope.note.paragraphs, function (para, idx) {\n\t      if (para.id === paragraphId) {\n\t        removeIdx = idx;\n\t      }\n\t    });\n\t    return $scope.note.paragraphs.splice(removeIdx, 1);\n\t  };\n\t\n\t  $scope.$on('addParagraph', function (event, paragraph, index) {\n\t    if ($scope.paragraphUrl) {\n\t      return;\n\t    }\n\t    addPara(paragraph, index);\n\t  });\n\t\n\t  $scope.$on('removeParagraph', function (event, paragraphId) {\n\t    if ($scope.paragraphUrl) {\n\t      return;\n\t    }\n\t    removePara(paragraphId);\n\t  });\n\t\n\t  $scope.$on('moveParagraph', function (event, paragraphId, newIdx) {\n\t    var removedPara = removePara(paragraphId);\n\t    if (removedPara && removedPara.length === 1) {\n\t      addPara(removedPara[0], newIdx);\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateNote', function (event, name, config, info) {\n\t    /** update Note name */\n\t    if (name !== $scope.note.name) {\n\t      console.log('change note name to : %o', $scope.note.name);\n\t      $scope.note.name = name;\n\t    }\n\t    $scope.note.config = config;\n\t    $scope.note.info = info;\n\t    initializeLookAndFeel();\n\t  });\n\t\n\t  var getInterpreterBindings = function getInterpreterBindings() {\n\t    websocketMsgSrv.getInterpreterBindings($scope.note.id);\n\t  };\n\t\n\t  $scope.$on('interpreterBindings', function (event, data) {\n\t    $scope.interpreterBindings = data.interpreterBindings;\n\t    $scope.interpreterBindingsOrig = angular.copy($scope.interpreterBindings); // to check dirty\n\t\n\t    var selected = false;\n\t    var key;\n\t    var setting;\n\t\n\t    for (key in $scope.interpreterBindings) {\n\t      setting = $scope.interpreterBindings[key];\n\t      if (setting.selected) {\n\t        selected = true;\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (!selected) {\n\t      // make default selection\n\t      var selectedIntp = {};\n\t      for (key in $scope.interpreterBindings) {\n\t        setting = $scope.interpreterBindings[key];\n\t        if (!selectedIntp[setting.name]) {\n\t          setting.selected = true;\n\t          selectedIntp[setting.name] = true;\n\t        }\n\t      }\n\t      $scope.showSetting = true;\n\t    }\n\t  });\n\t\n\t  $scope.interpreterSelectionListeners = {\n\t    accept: function accept(sourceItemHandleScope, destSortableScope) {\n\t      return true;\n\t    },\n\t    itemMoved: function itemMoved(event) {},\n\t    orderChanged: function orderChanged(event) {}\n\t  };\n\t\n\t  $scope.openSetting = function () {\n\t    $scope.showSetting = true;\n\t    getInterpreterBindings();\n\t  };\n\t\n\t  $scope.closeSetting = function () {\n\t    if (isSettingDirty()) {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: '',\n\t        message: 'Interpreter setting changes will be discarded.',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            $scope.$apply(function () {\n\t              $scope.showSetting = false;\n\t            });\n\t          }\n\t        }\n\t      });\n\t    } else {\n\t      $scope.showSetting = false;\n\t    }\n\t  };\n\t\n\t  $scope.saveSetting = function () {\n\t    var selectedSettingIds = [];\n\t    for (var no in $scope.interpreterBindings) {\n\t      var setting = $scope.interpreterBindings[no];\n\t      if (setting.selected) {\n\t        selectedSettingIds.push(setting.id);\n\t      }\n\t    }\n\t    websocketMsgSrv.saveInterpreterBindings($scope.note.id, selectedSettingIds);\n\t    console.log('Interpreter bindings %o saved', selectedSettingIds);\n\t\n\t    _.forEach($scope.note.paragraphs, function (n, key) {\n\t      var regExp = /^\\s*%/g;\n\t      if (n.text && !regExp.exec(n.text)) {\n\t        $scope.$broadcast('saveInterpreterBindings', n.id);\n\t      }\n\t    });\n\t\n\t    $scope.showSetting = false;\n\t  };\n\t\n\t  $scope.toggleSetting = function () {\n\t    if ($scope.showSetting) {\n\t      $scope.closeSetting();\n\t    } else {\n\t      $scope.openSetting();\n\t      $scope.closePermissions();\n\t    }\n\t  };\n\t\n\t  var getPermissions = function getPermissions(callback) {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions').success(function (data, status, headers, config) {\n\t      $scope.permissions = data.body;\n\t      $scope.permissionsOrig = angular.copy($scope.permissions); // to check dirty\n\t\n\t      var selectJson = {\n\t        tokenSeparators: [',', ' '],\n\t        ajax: {\n\t          url: function url(params) {\n\t            if (!params.term) {\n\t              return false;\n\t            }\n\t            return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n\t          },\n\t          delay: 250,\n\t          processResults: function processResults(data, params) {\n\t            var results = [];\n\t\n\t            if (data.body.users.length !== 0) {\n\t              var users = [];\n\t              for (var len = 0; len < data.body.users.length; len++) {\n\t                users.push({\n\t                  'id': data.body.users[len],\n\t                  'text': data.body.users[len]\n\t                });\n\t              }\n\t              results.push({\n\t                'text': 'Users :',\n\t                'children': users\n\t              });\n\t            }\n\t            if (data.body.roles.length !== 0) {\n\t              var roles = [];\n\t              for (var len = 0; len < data.body.roles.length; len++) {\n\t                roles.push({\n\t                  'id': data.body.roles[len],\n\t                  'text': data.body.roles[len]\n\t                });\n\t              }\n\t              results.push({\n\t                'text': 'Roles :',\n\t                'children': roles\n\t              });\n\t            }\n\t            return {\n\t              results: results,\n\t              pagination: {\n\t                more: false\n\t              }\n\t            };\n\t          },\n\t          cache: false\n\t        },\n\t        width: ' ',\n\t        tags: true,\n\t        minimumInputLength: 3\n\t      };\n\t\n\t      $scope.setIamOwner();\n\t      angular.element('#selectOwners').select2(selectJson);\n\t      angular.element('#selectReaders').select2(selectJson);\n\t      angular.element('#selectWriters').select2(selectJson);\n\t      if (callback) {\n\t        callback();\n\t      }\n\t    }).error(function (data, status, headers, config) {\n\t      if (status !== 0) {\n\t        console.log('Error %o %o', status, data.message);\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.openPermissions = function () {\n\t    $scope.showPermissions = true;\n\t    getPermissions();\n\t  };\n\t\n\t  $scope.closePermissions = function () {\n\t    if (isPermissionsDirty()) {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: '',\n\t        message: 'Changes will be discarded.',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            $scope.$apply(function () {\n\t              $scope.showPermissions = false;\n\t            });\n\t          }\n\t        }\n\t      });\n\t    } else {\n\t      $scope.showPermissions = false;\n\t    }\n\t  };\n\t\n\t  function convertPermissionsToArray() {\n\t    $scope.permissions.owners = angular.element('#selectOwners').val();\n\t    $scope.permissions.readers = angular.element('#selectReaders').val();\n\t    $scope.permissions.writers = angular.element('#selectWriters').val();\n\t  }\n\t\n\t  $scope.restartInterpreter = function (interpreter) {\n\t    var thisConfirm = BootstrapDialog.confirm({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: '',\n\t      message: 'Do you want to restart ' + interpreter.name + ' interpreter?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          var payload = {\n\t            'noteId': $scope.note.id\n\t          };\n\t\n\t          thisConfirm.$modalFooter.find('button').addClass('disabled');\n\t          thisConfirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\t\n\t          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + interpreter.id, payload).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.interpreterSettings, { 'id': interpreter.id });\n\t            $scope.interpreterSettings[index] = data.body;\n\t            thisConfirm.close();\n\t          }).error(function (data, status, headers, config) {\n\t            thisConfirm.close();\n\t            console.log('Error %o %o', status, data.message);\n\t            BootstrapDialog.show({\n\t              title: 'Error restart interpreter.',\n\t              message: data.message\n\t            });\n\t          });\n\t          return false;\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.savePermissions = function () {\n\t    convertPermissionsToArray();\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions', $scope.permissions, { withCredentials: true }).success(function (data, status, headers, config) {\n\t      getPermissions(function () {\n\t        console.log('Note permissions %o saved', $scope.permissions);\n\t        BootstrapDialog.alert({\n\t          closable: true,\n\t          title: 'Permissions Saved Successfully!!!',\n\t          message: 'Owners : ' + $scope.permissions.owners + '\\n\\n' + 'Readers : ' + $scope.permissions.readers + '\\n\\n' + 'Writers  : ' + $scope.permissions.writers\n\t        });\n\t        $scope.showPermissions = false;\n\t      });\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t      BootstrapDialog.show({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: 'Insufficient privileges',\n\t        message: data.message,\n\t        buttons: [{\n\t          label: 'Login',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            angular.element('#loginModal').modal({\n\t              show: 'true'\n\t            });\n\t          }\n\t        }, {\n\t          label: 'Cancel',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            $location.path('/');\n\t          }\n\t        }]\n\t      });\n\t    });\n\t  };\n\t\n\t  $scope.togglePermissions = function () {\n\t    var principal = $rootScope.ticket.principal;\n\t    $scope.isAnonymous = principal === 'anonymous' ? true : false;\n\t    if (!!principal && $scope.isAnonymous) {\n\t      $scope.blockAnonUsers();\n\t    } else {\n\t      if ($scope.showPermissions) {\n\t        $scope.closePermissions();\n\t        angular.element('#selectOwners').select2({});\n\t        angular.element('#selectReaders').select2({});\n\t        angular.element('#selectWriters').select2({});\n\t      } else {\n\t        $scope.openPermissions();\n\t        $scope.closeSetting();\n\t      }\n\t    }\n\t  };\n\t\n\t  $scope.setIamOwner = function () {\n\t    if ($scope.permissions.owners.length > 0 && _.indexOf($scope.permissions.owners, $rootScope.ticket.principal) < 0) {\n\t      $scope.isOwner = false;\n\t      return false;\n\t    }\n\t    $scope.isOwner = true;\n\t    return true;\n\t  };\n\t\n\t  $scope.toggleNotePersonalizedMode = function () {\n\t    var personalizedMode = $scope.note.config.personalizedMode;\n\t    if ($scope.isOwner) {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: 'Setting the result display',\n\t        message: function message(dialog) {\n\t          var modeText = $scope.note.config.personalizedMode === 'true' ? 'collaborate' : 'personalize';\n\t          return 'Do you want to <span class=\"text-info\">' + modeText + '</span> your analysis?';\n\t        },\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            if ($scope.note.config.personalizedMode === undefined) {\n\t              $scope.note.config.personalizedMode = 'false';\n\t            }\n\t            $scope.note.config.personalizedMode = personalizedMode === 'true' ? 'false' : 'true';\n\t            websocketMsgSrv.updatePersonalizedMode($scope.note.id, $scope.note.config.personalizedMode);\n\t          }\n\t        }\n\t      });\n\t    }\n\t  };\n\t\n\t  var isSettingDirty = function isSettingDirty() {\n\t    if (angular.equals($scope.interpreterBindings, $scope.interpreterBindingsOrig)) {\n\t      return false;\n\t    } else {\n\t      return true;\n\t    }\n\t  };\n\t\n\t  var isPermissionsDirty = function isPermissionsDirty() {\n\t    if (angular.equals($scope.permissions, $scope.permissionsOrig)) {\n\t      return false;\n\t    } else {\n\t      return true;\n\t    }\n\t  };\n\t\n\t  angular.element(document).click(function () {\n\t    angular.element('.ace_autocomplete').hide();\n\t  });\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setConnectedStatus', function (event, param) {\n\t    if (connectedOnce && param) {\n\t      initNotebook();\n\t    }\n\t    connectedOnce = true;\n\t  });\n\t\n\t  $scope.$on('moveParagraphUp', function (event, paragraph) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === paragraph.id) {\n\t        newIndex = i - 1;\n\t        break;\n\t      }\n\t    }\n\t    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t    // save dirtyText of moving paragraphs.\n\t    var prevParagraph = $scope.note.paragraphs[newIndex];\n\t    angular.element('#' + paragraph.id + '_paragraphColumn_main').scope().saveParagraph(paragraph);\n\t    angular.element('#' + prevParagraph.id + '_paragraphColumn_main').scope().saveParagraph(prevParagraph);\n\t    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n\t  });\n\t\n\t  $scope.$on('moveParagraphDown', function (event, paragraph) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === paragraph.id) {\n\t        newIndex = i + 1;\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t    // save dirtyText of moving paragraphs.\n\t    var nextParagraph = $scope.note.paragraphs[newIndex];\n\t    angular.element('#' + paragraph.id + '_paragraphColumn_main').scope().saveParagraph(paragraph);\n\t    angular.element('#' + nextParagraph.id + '_paragraphColumn_main').scope().saveParagraph(nextParagraph);\n\t    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n\t  });\n\t\n\t  $scope.$on('moveFocusToPreviousParagraph', function (event, currentParagraphId) {\n\t    var focus = false;\n\t    for (var i = $scope.note.paragraphs.length - 1; i >= 0; i--) {\n\t      if (focus === false) {\n\t        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n\t          focus = true;\n\t          continue;\n\t        }\n\t      } else {\n\t        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, -1);\n\t        break;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('moveFocusToNextParagraph', function (event, currentParagraphId) {\n\t    var focus = false;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if (focus === false) {\n\t        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n\t          focus = true;\n\t          continue;\n\t        }\n\t      } else {\n\t        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, 0);\n\t        break;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('insertParagraph', function (event, paragraphId, position) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === paragraphId) {\n\t        //determine position of where to add new paragraph; default is below\n\t        if (position === 'above') {\n\t          newIndex = i;\n\t        } else {\n\t          newIndex = i + 1;\n\t        }\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t    websocketMsgSrv.insertParagraph(newIndex);\n\t  });\n\t\n\t  $scope.$on('setNoteContent', function (event, note) {\n\t    if (note === undefined) {\n\t      $location.path('/');\n\t    }\n\t\n\t    $scope.note = note;\n\t\n\t    $scope.paragraphUrl = $routeParams.paragraphId;\n\t    $scope.asIframe = $routeParams.asIframe;\n\t    if ($scope.paragraphUrl) {\n\t      $scope.note = cleanParagraphExcept($scope.paragraphUrl, note);\n\t      $scope.$broadcast('$unBindKeyEvent', $scope.$unBindKeyEvent);\n\t      $rootScope.$broadcast('setIframe', $scope.asIframe);\n\t    }\n\t\n\t    initializeLookAndFeel();\n\t    //open interpreter binding setting when there're none selected\n\t    getInterpreterBindings();\n\t    getPermissions();\n\t    var isPersonalized = $scope.note.config.personalizedMode;\n\t    isPersonalized = isPersonalized === undefined ? 'false' : isPersonalized;\n\t    $scope.note.config.personalizedMode = isPersonalized;\n\t  });\n\t\n\t  $scope.$on('$destroy', function () {\n\t    angular.element(window).off('beforeunload');\n\t    $scope.killSaveTimer();\n\t    $scope.saveNote();\n\t\n\t    document.removeEventListener('click', $scope.focusParagraphOnClick);\n\t    document.removeEventListener('keydown', $scope.keyboardShortcut);\n\t  });\n\t\n\t  $scope.$on('$unBindKeyEvent', function () {\n\t    document.removeEventListener('click', $scope.focusParagraphOnClick);\n\t    document.removeEventListener('keydown', $scope.keyboardShortcut);\n\t  });\n\t\n\t  angular.element(window).bind('resize', function () {\n\t    var actionbarHeight = document.getElementById('actionbar').lastElementChild.clientHeight;\n\t    angular.element(document.getElementById('content')).css('padding-top', actionbarHeight - 20);\n\t  });\n\t}\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * Create table data object from paragraph table type result\n\t */\n\tvar TableData = function () {\n\t  function TableData(columns, rows, comment) {\n\t    _classCallCheck(this, TableData);\n\t\n\t    this.columns = columns || [];\n\t    this.rows = rows || [];\n\t    this.comment = comment || '';\n\t  }\n\t\n\t  _createClass(TableData, [{\n\t    key: 'loadParagraphResult',\n\t    value: function loadParagraphResult(paragraphResult) {\n\t      if (!paragraphResult || paragraphResult.type !== 'TABLE') {\n\t        console.log('Can not load paragraph result');\n\t        return;\n\t      }\n\t\n\t      var columnNames = [];\n\t      var rows = [];\n\t      var array = [];\n\t      var textRows = paragraphResult.msg.split('\\n');\n\t      var comment = '';\n\t      var commentRow = false;\n\t\n\t      for (var i = 0; i < textRows.length; i++) {\n\t        var textRow = textRows[i];\n\t\n\t        if (commentRow) {\n\t          comment += textRow;\n\t          continue;\n\t        }\n\t\n\t        if (textRow === '' || textRow === '<!--TABLE_COMMENT-->') {\n\t          if (rows.length > 0) {\n\t            commentRow = true;\n\t          }\n\t          continue;\n\t        }\n\t        var textCols = textRow.split('\\t');\n\t        var cols = [];\n\t        var cols2 = [];\n\t        for (var j = 0; j < textCols.length; j++) {\n\t          var col = textCols[j];\n\t          if (i === 0) {\n\t            columnNames.push({ name: col, index: j, aggr: 'sum' });\n\t          } else {\n\t            cols.push(col);\n\t            cols2.push({ key: columnNames[i] ? columnNames[i].name : undefined, value: col });\n\t          }\n\t        }\n\t        if (i !== 0) {\n\t          rows.push(cols);\n\t          array.push(cols2);\n\t        }\n\t      }\n\t      this.comment = comment;\n\t      this.columns = columnNames;\n\t      this.rows = rows;\n\t    }\n\t  }]);\n\t\n\t  return TableData;\n\t}();\n\t\n\texports.default = TableData;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * Base class for visualization\n\t */\n\tvar Transformation = function () {\n\t  function Transformation(config) {\n\t    _classCallCheck(this, Transformation);\n\t\n\t    this.config = config;\n\t    this._emitter;\n\t  }\n\t\n\t  _createClass(Transformation, [{\n\t    key: 'getSetting',\n\t\n\t\n\t    /**\n\t     * return {\n\t     *   template : angular template string or url (url should end with .html),\n\t     *   scope : an object to bind to template scope\n\t     * }\n\t     */\n\t    value: function getSetting() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'renderSetting',\n\t\n\t\n\t    /**\n\t     * render setting\n\t     */\n\t    value: function renderSetting(targetEl) {\n\t      var setting = this.getSetting();\n\t      if (!setting) {\n\t        return;\n\t      }\n\t\n\t      // already readered\n\t      if (this._scope) {\n\t        var self = this;\n\t        this._scope.$apply(function () {\n\t          for (var k in setting.scope) {\n\t            self._scope[k] = setting.scope[k];\n\t          }\n\t\n\t          for (var k in self._prevSettingScope) {\n\t            if (!setting.scope[k]) {\n\t              self._scope[k] = setting.scope[k];\n\t            }\n\t          }\n\t        });\n\t        return;\n\t      } else {\n\t        this._prevSettingScope = setting.scope;\n\t      }\n\t\n\t      var scope = this._createNewScope();\n\t      for (var k in setting.scope) {\n\t        scope[k] = setting.scope[k];\n\t      }\n\t      var template = setting.template;\n\t\n\t      if (template.split('\\n').length === 1 && template.endsWith('.html')) {\n\t        // template is url\n\t        var self = this;\n\t        this._templateRequest(template).then(function (t) {\n\t          self._render(targetEl, t, scope);\n\t        });\n\t      } else {\n\t        this._render(targetEl, template, scope);\n\t      }\n\t    }\n\t  }, {\n\t    key: '_render',\n\t    value: function _render(targetEl, template, scope) {\n\t      this._targetEl = targetEl;\n\t      targetEl.html(template);\n\t      this._compile(targetEl.contents())(scope);\n\t      this._scope = scope;\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t    value: function setConfig(config) {\n\t      this.config = config;\n\t    }\n\t  }, {\n\t    key: 'emitConfig',\n\t\n\t\n\t    /**\n\t     * Emit config. config will sent to server and saved.\n\t     */\n\t    value: function emitConfig(config) {\n\t      this._emitter(config);\n\t    }\n\t  }]);\n\t\n\t  return Transformation;\n\t}();\n\t\n\texports.default = Transformation;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _transformation = __webpack_require__(7);\n\t\n\tvar _transformation2 = _interopRequireDefault(_transformation);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * pivot table data and return d3 chart data\n\t */\n\tvar PivotTransformation = function (_Transformation) {\n\t  _inherits(PivotTransformation, _Transformation);\n\t\n\t  function PivotTransformation(config) {\n\t    _classCallCheck(this, PivotTransformation);\n\t\n\t    return _possibleConstructorReturn(this, (PivotTransformation.__proto__ || Object.getPrototypeOf(PivotTransformation)).call(this, config));\n\t  }\n\t\n\t  _createClass(PivotTransformation, [{\n\t    key: 'getSetting',\n\t    value: function getSetting() {\n\t      var self = this;\n\t\n\t      var configObj = self.config;\n\t      console.log('getSetting', configObj);\n\t      return {\n\t        template: 'app/tabledata/pivot_settings.html',\n\t        scope: {\n\t          config: configObj.common.pivot,\n\t          tableDataColumns: self.tableDataColumns,\n\t          save: function save() {\n\t            self.emitConfig(configObj);\n\t          },\n\t          removeKey: function removeKey(idx) {\n\t            configObj.common.pivot.keys.splice(idx, 1);\n\t            self.emitConfig(configObj);\n\t          },\n\t          removeGroup: function removeGroup(idx) {\n\t            configObj.common.pivot.groups.splice(idx, 1);\n\t            self.emitConfig(configObj);\n\t          },\n\t          removeValue: function removeValue(idx) {\n\t            configObj.common.pivot.values.splice(idx, 1);\n\t            self.emitConfig(configObj);\n\t          },\n\t          setValueAggr: function setValueAggr(idx, aggr) {\n\t            configObj.common.pivot.values[idx].aggr = aggr;\n\t            self.emitConfig(configObj);\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      this.tableDataColumns = tableData.columns;\n\t      this.config.common = this.config.common || {};\n\t      this.config.common.pivot = this.config.common.pivot || {};\n\t      var config = this.config.common.pivot;\n\t      var firstTime = !config.keys && !config.groups && !config.values;\n\t\n\t      config.keys = config.keys || [];\n\t      config.groups = config.groups || [];\n\t      config.values = config.values || [];\n\t\n\t      this.removeUnknown();\n\t      if (firstTime) {\n\t        this.selectDefault();\n\t      }\n\t      return this.pivot(tableData, config.keys, config.groups, config.values);\n\t    }\n\t  }, {\n\t    key: 'removeUnknown',\n\t    value: function removeUnknown() {\n\t      var config = this.config.common.pivot;\n\t      var tableDataColumns = this.tableDataColumns;\n\t      var unique = function unique(list) {\n\t        for (var i = 0; i < list.length; i++) {\n\t          for (var j = i + 1; j < list.length; j++) {\n\t            if (angular.equals(list[i], list[j])) {\n\t              list.splice(j, 1);\n\t            }\n\t          }\n\t        }\n\t      };\n\t\n\t      var removeUnknown = function removeUnknown(list) {\n\t        for (var i = 0; i < list.length; i++) {\n\t          // remove non existing column\n\t          var found = false;\n\t          for (var j = 0; j < tableDataColumns.length; j++) {\n\t            var a = list[i];\n\t            var b = tableDataColumns[j];\n\t            if (a.index === b.index && a.name === b.name) {\n\t              found = true;\n\t              break;\n\t            }\n\t          }\n\t          if (!found) {\n\t            list.splice(i, 1);\n\t          }\n\t        }\n\t      };\n\t\n\t      unique(config.keys);\n\t      removeUnknown(config.keys);\n\t      unique(config.groups);\n\t      removeUnknown(config.groups);\n\t      removeUnknown(config.values);\n\t    }\n\t  }, {\n\t    key: 'selectDefault',\n\t    value: function selectDefault() {\n\t      var config = this.config.common.pivot;\n\t      if (config.keys.length === 0 && config.groups.length === 0 && config.values.length === 0) {\n\t        if (config.keys.length === 0 && this.tableDataColumns.length > 0) {\n\t          config.keys.push(this.tableDataColumns[0]);\n\t        }\n\t\n\t        if (config.values.length === 0 && this.tableDataColumns.length > 1) {\n\t          config.values.push(this.tableDataColumns[1]);\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'pivot',\n\t    value: function pivot(data, keys, groups, values) {\n\t      var aggrFunc = {\n\t        sum: function sum(a, b) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return varA + varB;\n\t        },\n\t        count: function count(a, b) {\n\t          var varA = a !== undefined ? parseInt(a) : 0;\n\t          var varB = b !== undefined ? 1 : 0;\n\t          return varA + varB;\n\t        },\n\t        min: function min(a, b) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return Math.min(varA, varB);\n\t        },\n\t        max: function max(a, b) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return Math.max(varA, varB);\n\t        },\n\t        avg: function avg(a, b, c) {\n\t          var varA = a !== undefined ? isNaN(a) ? 1 : parseFloat(a) : 0;\n\t          var varB = b !== undefined ? isNaN(b) ? 1 : parseFloat(b) : 0;\n\t          return varA + varB;\n\t        }\n\t      };\n\t\n\t      var aggrFuncDiv = {\n\t        sum: false,\n\t        count: false,\n\t        min: false,\n\t        max: false,\n\t        avg: true\n\t      };\n\t\n\t      var schema = {};\n\t      var rows = {};\n\t\n\t      for (var i = 0; i < data.rows.length; i++) {\n\t        var row = data.rows[i];\n\t        var s = schema;\n\t        var p = rows;\n\t\n\t        for (var k = 0; k < keys.length; k++) {\n\t          var key = keys[k];\n\t\n\t          // add key to schema\n\t          if (!s[key.name]) {\n\t            s[key.name] = {\n\t              order: k,\n\t              index: key.index,\n\t              type: 'key',\n\t              children: {}\n\t            };\n\t          }\n\t          s = s[key.name].children;\n\t\n\t          // add key to row\n\t          var keyKey = row[key.index];\n\t          if (!p[keyKey]) {\n\t            p[keyKey] = {};\n\t          }\n\t          p = p[keyKey];\n\t        }\n\t\n\t        for (var g = 0; g < groups.length; g++) {\n\t          var group = groups[g];\n\t          var groupKey = row[group.index];\n\t\n\t          // add group to schema\n\t          if (!s[groupKey]) {\n\t            s[groupKey] = {\n\t              order: g,\n\t              index: group.index,\n\t              type: 'group',\n\t              children: {}\n\t            };\n\t          }\n\t          s = s[groupKey].children;\n\t\n\t          // add key to row\n\t          if (!p[groupKey]) {\n\t            p[groupKey] = {};\n\t          }\n\t          p = p[groupKey];\n\t        }\n\t\n\t        for (var v = 0; v < values.length; v++) {\n\t          var value = values[v];\n\t          var valueKey = value.name + '(' + value.aggr + ')';\n\t\n\t          // add value to schema\n\t          if (!s[valueKey]) {\n\t            s[valueKey] = {\n\t              type: 'value',\n\t              order: v,\n\t              index: value.index\n\t            };\n\t          }\n\t\n\t          // add value to row\n\t          if (!p[valueKey]) {\n\t            p[valueKey] = {\n\t              value: value.aggr !== 'count' ? row[value.index] : 1,\n\t              count: 1\n\t            };\n\t          } else {\n\t            p[valueKey] = {\n\t              value: aggrFunc[value.aggr](p[valueKey].value, row[value.index], p[valueKey].count + 1),\n\t              count: aggrFuncDiv[value.aggr] ? p[valueKey].count + 1 : p[valueKey].count\n\t            };\n\t          }\n\t        }\n\t      }\n\t\n\t      //console.log('schema=%o, rows=%o', schema, rows);\n\t      return {\n\t        keys: keys,\n\t        groups: groups,\n\t        values: values,\n\t        schema: schema,\n\t        rows: rows\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return PivotTransformation;\n\t}(_transformation2.default);\n\t\n\texports.default = PivotTransformation;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _transformation = __webpack_require__(7);\n\t\n\tvar _transformation2 = _interopRequireDefault(_transformation);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * passthough the data\n\t */\n\tvar PassthroughTransformation = function (_Transformation) {\n\t  _inherits(PassthroughTransformation, _Transformation);\n\t\n\t  function PassthroughTransformation(config) {\n\t    _classCallCheck(this, PassthroughTransformation);\n\t\n\t    return _possibleConstructorReturn(this, (PassthroughTransformation.__proto__ || Object.getPrototypeOf(PassthroughTransformation)).call(this, config));\n\t  }\n\t\n\t  _createClass(PassthroughTransformation, [{\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      return tableData;\n\t    }\n\t  }]);\n\t\n\t  return PassthroughTransformation;\n\t}(_transformation2.default);\n\t\n\texports.default = PassthroughTransformation;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _transformation = __webpack_require__(7);\n\t\n\tvar _transformation2 = _interopRequireDefault(_transformation);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * select columns\n\t * - columnSelectorProp\n\t *   [\n\t *     {\n\t *       \"name\":\n\t *       \"tooltip\":\n\t *     },\n\t *     ...\n\t *   ]\n\t */\n\tvar ColumnselectorTransformation = function (_Transformation) {\n\t  _inherits(ColumnselectorTransformation, _Transformation);\n\t\n\t  function ColumnselectorTransformation(config, columnSelectorProp) {\n\t    _classCallCheck(this, ColumnselectorTransformation);\n\t\n\t    var _this = _possibleConstructorReturn(this, (ColumnselectorTransformation.__proto__ || Object.getPrototypeOf(ColumnselectorTransformation)).call(this, config));\n\t\n\t    _this.props = columnSelectorProp;\n\t    return _this;\n\t  }\n\t\n\t  _createClass(ColumnselectorTransformation, [{\n\t    key: 'getSetting',\n\t    value: function getSetting() {\n\t      var self = this;\n\t      var configObj = self.config;\n\t      return {\n\t        template: 'app/tabledata/columnselector_settings.html',\n\t        scope: {\n\t          config: self.config,\n\t          props: self.props,\n\t          tableDataColumns: self.tableDataColumns,\n\t          save: function save() {\n\t            self.emitConfig(configObj);\n\t          },\n\t          remove: function remove(selectorName) {\n\t            configObj[selectorName] = null;\n\t            self.emitConfig(configObj);\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'transform',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when tableData or config changes\n\t     */\n\t    value: function transform(tableData) {\n\t      this.tableDataColumns = tableData.columns;\n\t      this.removeUnknown();\n\t      return tableData;\n\t    }\n\t  }, {\n\t    key: 'removeUnknown',\n\t    value: function removeUnknown() {\n\t      var fields = this.config;\n\t      for (var f in fields) {\n\t        if (fields[f]) {\n\t          var found = false;\n\t          for (var i = 0; i < this.tableDataColumns.length; i++) {\n\t            var a = fields[f];\n\t            var b = this.tableDataColumns[i];\n\t            if (a.index === b.index && a.name === b.name) {\n\t              found = true;\n\t              break;\n\t            }\n\t          }\n\t          if (!found && fields[f] instanceof Object && !(fields[f] instanceof Array)) {\n\t            fields[f] = null;\n\t          }\n\t        }\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return ColumnselectorTransformation;\n\t}(_transformation2.default);\n\t\n\texports.default = ColumnselectorTransformation;\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t/**\n\t * Base class for visualization\n\t */\n\tvar Visualization = function () {\n\t  function Visualization(targetEl, config) {\n\t    _classCallCheck(this, Visualization);\n\t\n\t    this.targetEl = targetEl;\n\t    this.config = config;\n\t    this._dirty = false;\n\t    this._active = false;\n\t    this._emitter;\n\t  }\n\t\n\t  _createClass(Visualization, [{\n\t    key: 'getTransformation',\n\t\n\t\n\t    /**\n\t     * get transformation\n\t     */\n\t    value: function getTransformation() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'render',\n\t\n\t\n\t    /**\n\t     * Method will be invoked when data or configuration changed\n\t     */\n\t    value: function render(tableData) {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'refresh',\n\t\n\t\n\t    /**\n\t     * Refresh visualization.\n\t     */\n\t    value: function refresh() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t\n\t\n\t    /**\n\t     * method will be invoked when visualization need to be destroyed.\n\t     * Don't need to destroy this.targetEl.\n\t     */\n\t    value: function destroy() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'getSetting',\n\t\n\t\n\t    /**\n\t     * return {\n\t     *   template : angular template string or url (url should end with .html),\n\t     *   scope : an object to bind to template scope\n\t     * }\n\t     */\n\t    value: function getSetting() {\n\t      // override this\n\t    }\n\t  }, {\n\t    key: 'activate',\n\t\n\t\n\t    /**\n\t     * Activate. invoked when visualization is selected\n\t     */\n\t    value: function activate() {\n\t      if (!this._active || this._dirty) {\n\t        this.refresh();\n\t        this._dirty = false;\n\t      }\n\t      this._active = true;\n\t    }\n\t  }, {\n\t    key: 'deactivate',\n\t\n\t\n\t    /**\n\t     * Activate. invoked when visualization is de selected\n\t     */\n\t    value: function deactivate() {\n\t      this._active = false;\n\t    }\n\t  }, {\n\t    key: 'isActive',\n\t\n\t\n\t    /**\n\t     * Is active\n\t     */\n\t    value: function isActive() {\n\t      return this._active;\n\t    }\n\t  }, {\n\t    key: 'resize',\n\t\n\t\n\t    /**\n\t     * When window or paragraph is resized\n\t     */\n\t    value: function resize() {\n\t      if (this.isActive()) {\n\t        this.refresh();\n\t      } else {\n\t        this._dirty = true;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      this.config = config;\n\t      if (this.isActive()) {\n\t        this.refresh();\n\t      } else {\n\t        this._dirty = true;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'emitConfig',\n\t\n\t\n\t    /**\n\t     * Emit config. config will sent to server and saved.\n\t     */\n\t    value: function emitConfig(config) {\n\t      this._emitter(config);\n\t    }\n\t  }, {\n\t    key: 'renderSetting',\n\t\n\t\n\t    /**\n\t     * render setting\n\t     */\n\t    value: function renderSetting(targetEl) {\n\t      var _this = this;\n\t\n\t      var setting = this.getSetting();\n\t      if (!setting) {\n\t        return;\n\t      }\n\t\n\t      // already readered\n\t      if (this._scope) {\n\t        var self = this;\n\t        this._scope.$apply(function () {\n\t          for (var k in setting.scope) {\n\t            self._scope[k] = setting.scope[k];\n\t          }\n\t\n\t          for (var k in self._prevSettingScope) {\n\t            if (!setting.scope[k]) {\n\t              self._scope[k] = setting.scope[k];\n\t            }\n\t          }\n\t        });\n\t        return;\n\t      } else {\n\t        this._prevSettingScope = setting.scope;\n\t      }\n\t\n\t      var scope = this._createNewScope();\n\t      for (var k in setting.scope) {\n\t        scope[k] = setting.scope[k];\n\t      }\n\t      var template = setting.template;\n\t\n\t      if (template.split('\\n').length === 1 && template.endsWith('.html')) {\n\t        // template is url\n\t        this._templateRequest(template).then(function (t) {\n\t          return _renderSetting(_this, targetEl, t, scope);\n\t        });\n\t      } else {\n\t        _renderSetting(this, targetEl, template, scope);\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Visualization;\n\t}();\n\t\n\texports.default = Visualization;\n\t\n\t\n\tfunction _renderSetting(instance, targetEl, template, scope) {\n\t  instance._targetEl = targetEl;\n\t  targetEl.html(template);\n\t  instance._compile(targetEl.contents())(scope);\n\t  instance._scope = scope;\n\t};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _visualization = __webpack_require__(11);\n\t\n\tvar _visualization2 = _interopRequireDefault(_visualization);\n\t\n\tvar _passthrough = __webpack_require__(9);\n\t\n\tvar _passthrough2 = _interopRequireDefault(_passthrough);\n\t\n\tvar _handsonHelper = __webpack_require__(4);\n\t\n\tvar _handsonHelper2 = _interopRequireDefault(_handsonHelper);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in table format\n\t */\n\tvar TableVisualization = function (_Visualization) {\n\t  _inherits(TableVisualization, _Visualization);\n\t\n\t  function TableVisualization(targetEl, config) {\n\t    _classCallCheck(this, TableVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (TableVisualization.__proto__ || Object.getPrototypeOf(TableVisualization)).call(this, targetEl, config));\n\t\n\t    console.log('Init table viz');\n\t    targetEl.addClass('table');\n\t    _this.passthrough = new _passthrough2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(TableVisualization, [{\n\t    key: 'refresh',\n\t    value: function refresh() {\n\t      this.hot.render();\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(tableData) {\n\t      var height = this.targetEl.height();\n\t      var container = this.targetEl.css('height', height).get(0);\n\t      var resultRows = tableData.rows;\n\t      var columnNames = _.pluck(tableData.columns, 'name');\n\t      var columns = Array.apply(null, Array(tableData.columns.length)).map(function () {\n\t        return { type: 'text' };\n\t      });\n\t\n\t      if (this.hot) {\n\t        this.hot.destroy();\n\t      }\n\t\n\t      var handsonHelper = new _handsonHelper2.default();\n\t      this.hot = new Handsontable(container, handsonHelper.getHandsonTableConfig(columns, columnNames, resultRows));\n\t      this.hot.validateCells(null);\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this.hot) {\n\t        this.hot.destroy();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.passthrough;\n\t    }\n\t  }]);\n\t\n\t  return TableVisualization;\n\t}(_visualization2.default);\n\t\n\texports.default = TableVisualization;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _visualization = __webpack_require__(11);\n\t\n\tvar _visualization2 = _interopRequireDefault(_visualization);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in table format\n\t */\n\tvar Nvd3ChartVisualization = function (_Visualization) {\n\t  _inherits(Nvd3ChartVisualization, _Visualization);\n\t\n\t  function Nvd3ChartVisualization(targetEl, config) {\n\t    _classCallCheck(this, Nvd3ChartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (Nvd3ChartVisualization.__proto__ || Object.getPrototypeOf(Nvd3ChartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.targetEl.append('<svg></svg>');\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Nvd3ChartVisualization, [{\n\t    key: 'refresh',\n\t    value: function refresh() {\n\t      if (this.chart) {\n\t        this.chart.update();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(data) {\n\t      var type = this.type();\n\t      var d3g = data.d3g;\n\t\n\t      if (!this.chart) {\n\t        this.chart = nv.models[type]();\n\t      }\n\t\n\t      this.configureChart(this.chart);\n\t\n\t      var animationDuration = 300;\n\t      var numberOfDataThreshold = 150;\n\t      var height = this.targetEl.height();\n\t\n\t      // turn off animation when dataset is too large. (for performance issue)\n\t      // still, since dataset is large, the chart content sequentially appears like animated.\n\t      try {\n\t        if (d3g[0].values.length > numberOfDataThreshold) {\n\t          animationDuration = 0;\n\t        }\n\t      } catch (ignoreErr) {}\n\t\n\t      d3.select('#' + this.targetEl[0].id + ' svg').attr('height', height).datum(d3g).transition().duration(animationDuration).call(this.chart);\n\t      d3.select('#' + this.targetEl[0].id + ' svg').style.height = height + 'px';\n\t    }\n\t  }, {\n\t    key: 'type',\n\t    value: function type() {\n\t      // override this and return chart type\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      // override this to configure chart\n\t    }\n\t  }, {\n\t    key: 'groupedThousandsWith3DigitsFormatter',\n\t    value: function groupedThousandsWith3DigitsFormatter(x) {\n\t      return d3.format(',')(d3.round(x, 3));\n\t    }\n\t  }, {\n\t    key: 'customAbbrevFormatter',\n\t    value: function customAbbrevFormatter(x) {\n\t      var s = d3.format('.3s')(x);\n\t      switch (s[s.length - 1]) {\n\t        case 'G':\n\t          return s.slice(0, -1) + 'B';\n\t      }\n\t      return s;\n\t    }\n\t  }, {\n\t    key: 'xAxisTickFormat',\n\t    value: function xAxisTickFormat(d, xLabels) {\n\t      if (xLabels[d] && (isNaN(parseFloat(xLabels[d])) || !isFinite(xLabels[d]))) {\n\t        // to handle string type xlabel\n\t        return xLabels[d];\n\t      } else {\n\t        return d;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'yAxisTickFormat',\n\t    value: function yAxisTickFormat(d) {\n\t      if (Math.abs(d) >= Math.pow(10, 6)) {\n\t        return this.customAbbrevFormatter(d);\n\t      }\n\t      return this.groupedThousandsWith3DigitsFormatter(d);\n\t    }\n\t  }, {\n\t    key: 'd3DataFromPivot',\n\t    value: function d3DataFromPivot(schema, rows, keys, groups, values, allowTextXAxis, fillMissingValues, multiBarChart) {\n\t      // construct table data\n\t      var d3g = [];\n\t\n\t      var concat = function concat(o, n) {\n\t        if (!o) {\n\t          return n;\n\t        } else {\n\t          return o + '.' + n;\n\t        }\n\t      };\n\t\n\t      var getSchemaUnderKey = function getSchemaUnderKey(key, s) {\n\t        for (var c in key.children) {\n\t          s[c] = {};\n\t          getSchemaUnderKey(key.children[c], s[c]);\n\t        }\n\t      };\n\t\n\t      var traverse = function traverse(sKey, s, rKey, r, func, rowName, rowValue, colName) {\n\t        //console.log(\"TRAVERSE sKey=%o, s=%o, rKey=%o, r=%o, rowName=%o, rowValue=%o, colName=%o\", sKey, s, rKey, r, rowName, rowValue, colName);\n\t\n\t        if (s.type === 'key') {\n\t          rowName = concat(rowName, sKey);\n\t          rowValue = concat(rowValue, rKey);\n\t        } else if (s.type === 'group') {\n\t          colName = concat(colName, rKey);\n\t        } else if (s.type === 'value' && sKey === rKey || valueOnly) {\n\t          colName = concat(colName, rKey);\n\t          func(rowName, rowValue, colName, r);\n\t        }\n\t\n\t        for (var c in s.children) {\n\t          if (fillMissingValues && s.children[c].type === 'group' && r[c] === undefined) {\n\t            var cs = {};\n\t            getSchemaUnderKey(s.children[c], cs);\n\t            traverse(c, s.children[c], c, cs, func, rowName, rowValue, colName);\n\t            continue;\n\t          }\n\t\n\t          for (var j in r) {\n\t            if (s.children[c].type === 'key' || c === j) {\n\t              traverse(c, s.children[c], j, r[j], func, rowName, rowValue, colName);\n\t            }\n\t          }\n\t        }\n\t      };\n\t\n\t      var valueOnly = keys.length === 0 && groups.length === 0 && values.length > 0;\n\t      var noKey = keys.length === 0;\n\t      var isMultiBarChart = multiBarChart;\n\t\n\t      var sKey = Object.keys(schema)[0];\n\t\n\t      var rowNameIndex = {};\n\t      var rowIdx = 0;\n\t      var colNameIndex = {};\n\t      var colIdx = 0;\n\t      var rowIndexValue = {};\n\t\n\t      for (var k in rows) {\n\t        traverse(sKey, schema[sKey], k, rows[k], function (rowName, rowValue, colName, value) {\n\t          //console.log(\"RowName=%o, row=%o, col=%o, value=%o\", rowName, rowValue, colName, value);\n\t          if (rowNameIndex[rowValue] === undefined) {\n\t            rowIndexValue[rowIdx] = rowValue;\n\t            rowNameIndex[rowValue] = rowIdx++;\n\t          }\n\t\n\t          if (colNameIndex[colName] === undefined) {\n\t            colNameIndex[colName] = colIdx++;\n\t          }\n\t          var i = colNameIndex[colName];\n\t          if (noKey && isMultiBarChart) {\n\t            i = 0;\n\t          }\n\t\n\t          if (!d3g[i]) {\n\t            d3g[i] = {\n\t              values: [],\n\t              key: noKey && isMultiBarChart ? 'values' : colName\n\t            };\n\t          }\n\t\n\t          var xVar = isNaN(rowValue) ? allowTextXAxis ? rowValue : rowNameIndex[rowValue] : parseFloat(rowValue);\n\t          var yVar = 0;\n\t          if (xVar === undefined) {\n\t            xVar = colName;\n\t          }\n\t          if (value !== undefined) {\n\t            yVar = isNaN(value.value) ? 0 : parseFloat(value.value) / parseFloat(value.count);\n\t          }\n\t          d3g[i].values.push({\n\t            x: xVar,\n\t            y: yVar\n\t          });\n\t        });\n\t      }\n\t\n\t      // clear aggregation name, if possible\n\t      var namesWithoutAggr = {};\n\t      var colName;\n\t      var withoutAggr;\n\t      // TODO - This part could use som refactoring - Weird if/else with similar actions and variable names\n\t      for (colName in colNameIndex) {\n\t        withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n\t        if (!namesWithoutAggr[withoutAggr]) {\n\t          namesWithoutAggr[withoutAggr] = 1;\n\t        } else {\n\t          namesWithoutAggr[withoutAggr]++;\n\t        }\n\t      }\n\t\n\t      if (valueOnly) {\n\t        for (var valueIndex = 0; valueIndex < d3g[0].values.length; valueIndex++) {\n\t          colName = d3g[0].values[valueIndex].x;\n\t          if (!colName) {\n\t            continue;\n\t          }\n\t\n\t          withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n\t          if (namesWithoutAggr[withoutAggr] <= 1) {\n\t            d3g[0].values[valueIndex].x = withoutAggr;\n\t          }\n\t        }\n\t      } else {\n\t        for (var d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n\t          colName = d3g[d3gIndex].key;\n\t          withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n\t          if (namesWithoutAggr[withoutAggr] <= 1) {\n\t            d3g[d3gIndex].key = withoutAggr;\n\t          }\n\t        }\n\t\n\t        // use group name instead of group.value as a column name, if there're only one group and one value selected.\n\t        if (groups.length === 1 && values.length === 1) {\n\t          for (d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n\t            colName = d3g[d3gIndex].key;\n\t            colName = colName.split('.').slice(0, -1).join('.');\n\t            d3g[d3gIndex].key = colName;\n\t          }\n\t        }\n\t      }\n\t\n\t      return {\n\t        xLabels: rowIndexValue,\n\t        d3g: d3g\n\t      };\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t\n\t\n\t    /**\n\t     * method will be invoked when visualization need to be destroyed.\n\t     * Don't need to destroy this.targetEl.\n\t     */\n\t    value: function destroy() {\n\t      if (this.chart) {\n\t        d3.selectAll('#' + this.targetEl[0].id + ' svg > *').remove();\n\t        this.chart = undefined;\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Nvd3ChartVisualization;\n\t}(_visualization2.default);\n\t\n\texports.default = Nvd3ChartVisualization;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in bar char\n\t */\n\tvar BarchartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(BarchartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function BarchartVisualization(targetEl, config) {\n\t    _classCallCheck(this, BarchartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (BarchartVisualization.__proto__ || Object.getPrototypeOf(BarchartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(BarchartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'multiBarChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, true, true, true);\n\t\n\t      _get(BarchartVisualization.prototype.__proto__ || Object.getPrototypeOf(BarchartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(BarchartVisualization.prototype.__proto__ || Object.getPrototypeOf(BarchartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t      chart.yAxis.axisLabelDistance(50);\n\t      chart.yAxis.tickFormat(function (d) {\n\t        return self.yAxisTickFormat(d);\n\t      });\n\t\n\t      this.chart.stacked(this.config.stacked);\n\t\n\t      var self = this;\n\t      this.chart.dispatch.on('stateChange', function (s) {\n\t        self.config.stacked = s.stacked;\n\t\n\t        // give some time to animation finish\n\t        setTimeout(function () {\n\t          self.emitConfig(self.config);\n\t        }, 500);\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return BarchartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = BarchartVisualization;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in pie chart\n\t */\n\tvar PiechartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(PiechartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function PiechartVisualization(targetEl, config) {\n\t    _classCallCheck(this, PiechartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (PiechartVisualization.__proto__ || Object.getPrototypeOf(PiechartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(PiechartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'pieChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      // [ZEPPELIN-2253] New chart function will be created each time inside super.render()\n\t      this.chart = null;\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, true, false, false);\n\t      var d = d3Data.d3g;\n\t\n\t      var generateLabel = void 0;\n\t      // data is grouped\n\t      if (pivot.groups && pivot.groups.length > 0) {\n\t        generateLabel = function generateLabel(suffix, prefix) {\n\t          return prefix + '.' + suffix;\n\t        };\n\t      } else {\n\t        // data isn't grouped\n\t        generateLabel = function generateLabel(suffix) {\n\t          return suffix;\n\t        };\n\t      }\n\t\n\t      var d3g = d.map(function (group) {\n\t        return group.values.map(function (row) {\n\t          return {\n\t            label: generateLabel(row.x, group.key),\n\t            value: row.y\n\t          };\n\t        });\n\t      });\n\t      // the map function returns d3g as a nested array\n\t      // [].concat flattens it, http://stackoverflow.com/a/10865042/5154397\n\t      d3g = [].concat.apply([], d3g);\n\t      _get(PiechartVisualization.prototype.__proto__ || Object.getPrototypeOf(PiechartVisualization.prototype), 'render', this).call(this, { d3g: d3g });\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(PiechartVisualization.prototype.__proto__ || Object.getPrototypeOf(PiechartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      chart.x(function (d) {\n\t        return d.label;\n\t      }).y(function (d) {\n\t        return d.value;\n\t      }).showLabels(false).showTooltipPercent(true);\n\t    }\n\t  }]);\n\t\n\t  return PiechartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = PiechartVisualization;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in area chart\n\t */\n\tvar AreachartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(AreachartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function AreachartVisualization(targetEl, config) {\n\t    _classCallCheck(this, AreachartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (AreachartVisualization.__proto__ || Object.getPrototypeOf(AreachartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(AreachartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'stackedAreaChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, false, true, false);\n\t\n\t      this.xLabels = d3Data.xLabels;\n\t      _get(AreachartVisualization.prototype.__proto__ || Object.getPrototypeOf(AreachartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(AreachartVisualization.prototype.__proto__ || Object.getPrototypeOf(AreachartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t      chart.xAxis.tickFormat(function (d) {\n\t        return self.xAxisTickFormat(d, self.xLabels);\n\t      });\n\t      chart.yAxis.tickFormat(function (d) {\n\t        return self.yAxisTickFormat(d);\n\t      });\n\t      chart.yAxis.axisLabelDistance(50);\n\t      chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n\t\n\t      this.chart.style(this.config.style || 'stack');\n\t\n\t      var self = this;\n\t      this.chart.dispatch.on('stateChange', function (s) {\n\t        self.config.style = s.style;\n\t\n\t        // give some time to animation finish\n\t        setTimeout(function () {\n\t          self.emitConfig(self.config);\n\t        }, 500);\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return AreachartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = AreachartVisualization;\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _pivot = __webpack_require__(8);\n\t\n\tvar _pivot2 = _interopRequireDefault(_pivot);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in line chart\n\t */\n\tvar LinechartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(LinechartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function LinechartVisualization(targetEl, config) {\n\t    _classCallCheck(this, LinechartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (LinechartVisualization.__proto__ || Object.getPrototypeOf(LinechartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.pivot = new _pivot2.default(config);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(LinechartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      if (this.config.lineWithFocus) {\n\t        return 'lineWithFocusChart';\n\t      } else {\n\t        return 'lineChart';\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.pivot;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(pivot) {\n\t      var d3Data = this.d3DataFromPivot(pivot.schema, pivot.rows, pivot.keys, pivot.groups, pivot.values, false, true, false);\n\t\n\t      this.xLabels = d3Data.xLabels;\n\t      _get(LinechartVisualization.prototype.__proto__ || Object.getPrototypeOf(LinechartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'setConfig',\n\t\n\t\n\t    /**\n\t     * Set new config\n\t     */\n\t    value: function setConfig(config) {\n\t      _get(LinechartVisualization.prototype.__proto__ || Object.getPrototypeOf(LinechartVisualization.prototype), 'setConfig', this).call(this, config);\n\t      this.pivot.setConfig(config);\n\t\n\t      // change mode\n\t      if (this.currentMode !== config.lineWithFocus) {\n\t        _get(LinechartVisualization.prototype.__proto__ || Object.getPrototypeOf(LinechartVisualization.prototype), 'destroy', this).call(this);\n\t        this.currentMode = config.lineWithFocus;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t      chart.xAxis.tickFormat(function (d) {\n\t        return self.xAxisTickFormat(d, self.xLabels);\n\t      });\n\t      chart.yAxis.tickFormat(function (d) {\n\t        return self.yAxisTickFormat(d, self.xLabels);\n\t      });\n\t      chart.yAxis.axisLabelDistance(50);\n\t      if (chart.useInteractiveGuideline) {\n\t        // lineWithFocusChart hasn't got useInteractiveGuideline\n\t        chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n\t      }\n\t      if (this.config.forceY) {\n\t        chart.forceY([0]); // force y-axis minimum to 0 for line chart.\n\t      } else {\n\t        chart.forceY([]);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getSetting',\n\t    value: function getSetting(chart) {\n\t      var self = this;\n\t      var configObj = self.config;\n\t\n\t      return {\n\t        template: '<div>\\n        <label>\\n          <input type=\"checkbox\"\\n               ng-model=\"config.forceY\"\\n               ng-click=\"save()\" />\\n          force Y to 0\\n        </label>\\n        <br/>\\n\\n        <label>\\n          <input type=\"checkbox\"\\n               ng-model=\"config.lineWithFocus\"\\n               ng-click=\"save()\" />\\n          show line chart with focus\\n        </label>\\n      </div>',\n\t        scope: {\n\t          config: configObj,\n\t          save: function save() {\n\t            self.emitConfig(configObj);\n\t          }\n\t        }\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return LinechartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = LinechartVisualization;\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _visualizationNvd3chart = __webpack_require__(13);\n\t\n\tvar _visualizationNvd3chart2 = _interopRequireDefault(_visualizationNvd3chart);\n\t\n\tvar _columnselector = __webpack_require__(10);\n\t\n\tvar _columnselector2 = _interopRequireDefault(_columnselector);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\n\t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\t\n\t/**\n\t * Visualize data in scatter char\n\t */\n\tvar ScatterchartVisualization = function (_Nvd3ChartVisualizati) {\n\t  _inherits(ScatterchartVisualization, _Nvd3ChartVisualizati);\n\t\n\t  function ScatterchartVisualization(targetEl, config) {\n\t    _classCallCheck(this, ScatterchartVisualization);\n\t\n\t    var _this = _possibleConstructorReturn(this, (ScatterchartVisualization.__proto__ || Object.getPrototypeOf(ScatterchartVisualization)).call(this, targetEl, config));\n\t\n\t    _this.columnselectorProps = [{\n\t      name: 'xAxis'\n\t    }, {\n\t      name: 'yAxis'\n\t    }, {\n\t      name: 'group'\n\t    }, {\n\t      name: 'size',\n\t      tooltip: '<li>Size option is valid only when you drop numeric field here.</li>\\n                  <li>When data in each axis are discrete,\\n                  \\'number of values in corresponding coordinate\\' will be used as size.</li>\\n                  <li>Zeppelin consider values as discrete when the values contain string value\\n                  or the number of distinct values are bigger than 5% of total number of values.</li>\\n                  <li>Size field button turns to grey when the option you chose is not valid.</li>'\n\t    }];\n\t    _this.columnselector = new _columnselector2.default(config, _this.columnselectorProps);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(ScatterchartVisualization, [{\n\t    key: 'type',\n\t    value: function type() {\n\t      return 'scatterChart';\n\t    }\n\t  }, {\n\t    key: 'getTransformation',\n\t    value: function getTransformation() {\n\t      return this.columnselector;\n\t    }\n\t  }, {\n\t    key: 'render',\n\t    value: function render(tableData) {\n\t      this.tableData = tableData;\n\t      this.selectDefault();\n\t      var d3Data = this.setScatterChart(tableData, true);\n\t      this.xLabels = d3Data.xLabels;\n\t      this.yLabels = d3Data.yLabels;\n\t\n\t      _get(ScatterchartVisualization.prototype.__proto__ || Object.getPrototypeOf(ScatterchartVisualization.prototype), 'render', this).call(this, d3Data);\n\t    }\n\t  }, {\n\t    key: 'configureChart',\n\t    value: function configureChart(chart) {\n\t      var self = this;\n\t\n\t      chart.xAxis.tickFormat(function (d) {\n\t        // TODO remove round after bump to nvd3 > 1.8.5\n\t        return self.xAxisTickFormat(Math.round(d * 1e3) / 1e3, self.xLabels);\n\t      });\n\t\n\t      chart.yAxis.tickFormat(function (d) {\n\t        // TODO remove round after bump to nvd3 > 1.8.5\n\t        return self.yAxisTickFormat(Math.round(d * 1e3) / 1e3, self.yLabels);\n\t      });\n\t\n\t      chart.showDistX(true).showDistY(true);\n\t      //handle the problem of tooltip not showing when muliple points have same value.\n\t    }\n\t  }, {\n\t    key: 'yAxisTickFormat',\n\t    value: function yAxisTickFormat(d, yLabels) {\n\t      if (yLabels[d] && (isNaN(parseFloat(yLabels[d])) || !isFinite(yLabels[d]))) {\n\t        // to handle string type xlabel\n\t        return yLabels[d];\n\t      } else {\n\t        return _get(ScatterchartVisualization.prototype.__proto__ || Object.getPrototypeOf(ScatterchartVisualization.prototype), 'yAxisTickFormat', this).call(this, d);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'selectDefault',\n\t    value: function selectDefault() {\n\t      if (!this.config.xAxis && !this.config.yAxis) {\n\t        if (this.tableData.columns.length > 1) {\n\t          this.config.xAxis = this.tableData.columns[0];\n\t          this.config.yAxis = this.tableData.columns[1];\n\t        } else if (this.tableData.columns.length === 1) {\n\t          this.config.xAxis = this.tableData.columns[0];\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setScatterChart',\n\t    value: function setScatterChart(data, refresh) {\n\t      var xAxis = this.config.xAxis;\n\t      var yAxis = this.config.yAxis;\n\t      var group = this.config.group;\n\t      var size = this.config.size;\n\t\n\t      var xValues = [];\n\t      var yValues = [];\n\t      var rows = {};\n\t      var d3g = [];\n\t\n\t      var rowNameIndex = {};\n\t      var colNameIndex = {};\n\t      var grpNameIndex = {};\n\t      var rowIndexValue = {};\n\t      var colIndexValue = {};\n\t      var grpIndexValue = {};\n\t      var rowIdx = 0;\n\t      var colIdx = 0;\n\t      var grpIdx = 0;\n\t      var grpName = '';\n\t\n\t      var xValue;\n\t      var yValue;\n\t      var row;\n\t\n\t      if (!xAxis && !yAxis) {\n\t        return {\n\t          d3g: []\n\t        };\n\t      }\n\t\n\t      for (var i = 0; i < data.rows.length; i++) {\n\t        row = data.rows[i];\n\t        if (xAxis) {\n\t          xValue = row[xAxis.index];\n\t          xValues[i] = xValue;\n\t        }\n\t        if (yAxis) {\n\t          yValue = row[yAxis.index];\n\t          yValues[i] = yValue;\n\t        }\n\t      }\n\t\n\t      var isAllDiscrete = xAxis && yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues) || !xAxis && this.isDiscrete(yValues) || !yAxis && this.isDiscrete(xValues);\n\t\n\t      if (isAllDiscrete) {\n\t        rows = this.setDiscreteScatterData(data);\n\t      } else {\n\t        rows = data.rows;\n\t      }\n\t\n\t      if (!group && isAllDiscrete) {\n\t        grpName = 'count';\n\t      } else if (!group && !size) {\n\t        if (xAxis && yAxis) {\n\t          grpName = '(' + xAxis.name + ', ' + yAxis.name + ')';\n\t        } else if (xAxis && !yAxis) {\n\t          grpName = xAxis.name;\n\t        } else if (!xAxis && yAxis) {\n\t          grpName = yAxis.name;\n\t        }\n\t      } else if (!group && size) {\n\t        grpName = size.name;\n\t      }\n\t\n\t      var epsilon = 1e-4; // TODO remove after bump to nvd3 > 1.8.5\n\t\n\t      for (i = 0; i < rows.length; i++) {\n\t        row = rows[i];\n\t        if (xAxis) {\n\t          xValue = row[xAxis.index];\n\t        }\n\t        if (yAxis) {\n\t          yValue = row[yAxis.index];\n\t        }\n\t        if (group) {\n\t          grpName = row[group.index];\n\t        }\n\t        var sz = isAllDiscrete ? row[row.length - 1] : size ? row[size.index] : 1;\n\t\n\t        if (grpNameIndex[grpName] === undefined) {\n\t          grpIndexValue[grpIdx] = grpName;\n\t          grpNameIndex[grpName] = grpIdx++;\n\t        }\n\t\n\t        if (xAxis && rowNameIndex[xValue] === undefined) {\n\t          rowIndexValue[rowIdx] = xValue;\n\t          rowNameIndex[xValue] = rowIdx++;\n\t        }\n\t\n\t        if (yAxis && colNameIndex[yValue] === undefined) {\n\t          colIndexValue[colIdx] = yValue;\n\t          colNameIndex[yValue] = colIdx++;\n\t        }\n\t\n\t        if (!d3g[grpNameIndex[grpName]]) {\n\t          d3g[grpNameIndex[grpName]] = {\n\t            key: grpName,\n\t            values: []\n\t          };\n\t        }\n\t\n\t        // TODO remove epsilon jitter after bump to nvd3 > 1.8.5\n\t        var xval,\n\t            yval = 0;\n\t        if (xAxis) {\n\t          xval = (isNaN(xValue) ? rowNameIndex[xValue] : parseFloat(xValue)) + Math.random() * epsilon;\n\t        }\n\t        if (yAxis) {\n\t          yval = (isNaN(yValue) ? colNameIndex[yValue] : parseFloat(yValue)) + Math.random() * epsilon;\n\t        }\n\t\n\t        d3g[grpNameIndex[grpName]].values.push({\n\t          x: xval,\n\t          y: yval,\n\t          size: isNaN(parseFloat(sz)) ? 1 : parseFloat(sz)\n\t        });\n\t      }\n\t\n\t      // TODO remove sort and dedup after bump to nvd3 > 1.8.5\n\t      var d3gvalues = d3g[grpNameIndex[grpName]].values;\n\t      d3gvalues.sort(function (a, b) {\n\t        return a['x'] - b['x'] || a['y'] - b['y'];\n\t      });\n\t\n\t      for (var i = 0; i < d3gvalues.length - 1;) {\n\t        if (Math.abs(d3gvalues[i]['x'] - d3gvalues[i + 1]['x']) < epsilon && Math.abs(d3gvalues[i]['y'] - d3gvalues[i + 1]['y']) < epsilon) {\n\t          d3gvalues.splice(i + 1, 1);\n\t        } else {\n\t          i++;\n\t        }\n\t      }\n\t\n\t      return {\n\t        xLabels: rowIndexValue,\n\t        yLabels: colIndexValue,\n\t        d3g: d3g\n\t      };\n\t    }\n\t  }, {\n\t    key: 'setDiscreteScatterData',\n\t    value: function setDiscreteScatterData(data) {\n\t      var xAxis = this.config.xAxis;\n\t      var yAxis = this.config.yAxis;\n\t      var group = this.config.group;\n\t\n\t      var xValue;\n\t      var yValue;\n\t      var grp;\n\t\n\t      var rows = {};\n\t\n\t      for (var i = 0; i < data.rows.length; i++) {\n\t        var row = data.rows[i];\n\t        if (xAxis) {\n\t          xValue = row[xAxis.index];\n\t        }\n\t        if (yAxis) {\n\t          yValue = row[yAxis.index];\n\t        }\n\t        if (group) {\n\t          grp = row[group.index];\n\t        }\n\t\n\t        var key = xValue + ',' + yValue + ',' + grp;\n\t\n\t        if (!rows[key]) {\n\t          rows[key] = {\n\t            x: xValue,\n\t            y: yValue,\n\t            group: grp,\n\t            size: 1\n\t          };\n\t        } else {\n\t          rows[key].size++;\n\t        }\n\t      }\n\t\n\t      // change object into array\n\t      var newRows = [];\n\t      for (var r in rows) {\n\t        var newRow = [];\n\t        if (xAxis) {\n\t          newRow[xAxis.index] = rows[r].x;\n\t        }\n\t        if (yAxis) {\n\t          newRow[yAxis.index] = rows[r].y;\n\t        }\n\t        if (group) {\n\t          newRow[group.index] = rows[r].group;\n\t        }\n\t        newRow[data.rows[0].length] = rows[r].size;\n\t        newRows.push(newRow);\n\t      }\n\t      return newRows;\n\t    }\n\t  }, {\n\t    key: 'isDiscrete',\n\t    value: function isDiscrete(field) {\n\t      var getUnique = function getUnique(f) {\n\t        var uniqObj = {};\n\t        var uniqArr = [];\n\t        var j = 0;\n\t        for (var i = 0; i < f.length; i++) {\n\t          var item = f[i];\n\t          if (uniqObj[item] !== 1) {\n\t            uniqObj[item] = 1;\n\t            uniqArr[j++] = item;\n\t          }\n\t        }\n\t        return uniqArr;\n\t      };\n\t\n\t      for (var i = 0; i < field.length; i++) {\n\t        if (isNaN(parseFloat(field[i])) && (typeof field[i] === 'string' || field[i] instanceof String)) {\n\t          return true;\n\t        }\n\t      }\n\t\n\t      var threshold = 0.05;\n\t      var unique = getUnique(field);\n\t      if (unique.length / field.length < threshold) {\n\t        return true;\n\t      } else {\n\t        return false;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'isValidSizeOption',\n\t    value: function isValidSizeOption(options) {\n\t      var xValues = [];\n\t      var yValues = [];\n\t      var rows = this.tableData.rows;\n\t\n\t      for (var i = 0; i < rows.length; i++) {\n\t        var row = rows[i];\n\t        var size = row[options.size.index];\n\t\n\t        //check if the field is numeric\n\t        if (isNaN(parseFloat(size)) || !isFinite(size)) {\n\t          return false;\n\t        }\n\t\n\t        if (options.xAxis) {\n\t          var x = row[options.xAxis.index];\n\t          xValues[i] = x;\n\t        }\n\t        if (options.yAxis) {\n\t          var y = row[options.yAxis.index];\n\t          yValues[i] = y;\n\t        }\n\t      }\n\t\n\t      //check if all existing fields are discrete\n\t      var isAllDiscrete = options.xAxis && options.yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues) || !options.xAxis && this.isDiscrete(yValues) || !options.yAxis && this.isDiscrete(xValues);\n\t\n\t      if (isAllDiscrete) {\n\t        return false;\n\t      }\n\t\n\t      return true;\n\t    }\n\t  }]);\n\t\n\t  return ScatterchartVisualization;\n\t}(_visualizationNvd3chart2.default);\n\t\n\texports.default = ScatterchartVisualization;\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('JobmanagerCtrl', JobmanagerCtrl);\n\t\n\tJobmanagerCtrl.$inject = ['$scope', 'websocketMsgSrv', '$interval', 'ngToast', '$q', '$timeout', 'jobManagerFilter'];\n\t\n\tfunction JobmanagerCtrl($scope, websocketMsgSrv, $interval, ngToast, $q, $timeout, jobManagerFilter) {\n\t  ngToast.dismiss();\n\t  var asyncNotebookJobFilter = function asyncNotebookJobFilter(jobInfomations, filterConfig) {\n\t    return $q(function (resolve, reject) {\n\t      $scope.JobInfomationsByFilter = $scope.jobTypeFilter(jobInfomations, filterConfig);\n\t      resolve($scope.JobInfomationsByFilter);\n\t    });\n\t  };\n\t\n\t  $scope.doFiltering = function (jobInfomations, filterConfig) {\n\t    asyncNotebookJobFilter(jobInfomations, filterConfig).then(function () {\n\t      // success\n\t      $scope.isLoadingFilter = false;\n\t    }, function () {\n\t      // failed\n\t    });\n\t  };\n\t\n\t  $scope.filterValueToName = function (filterValue, maxStringLength) {\n\t    if ($scope.activeInterpreters === undefined) {\n\t      return;\n\t    }\n\t    var index = _.findIndex($scope.activeInterpreters, { value: filterValue });\n\t    if ($scope.activeInterpreters[index].name !== undefined) {\n\t      if (maxStringLength !== undefined && maxStringLength > $scope.activeInterpreters[index].name) {\n\t        return $scope.activeInterpreters[index].name.substr(0, maxStringLength - 3) + '...';\n\t      }\n\t      return $scope.activeInterpreters[index].name;\n\t    } else {\n\t      return 'Interpreter is not set';\n\t    }\n\t  };\n\t\n\t  $scope.setFilterValue = function (filterValue) {\n\t    $scope.filterConfig.filterValueInterpreter = filterValue;\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  };\n\t\n\t  $scope.onChangeRunJobToAlwaysTopToggle = function () {\n\t    $scope.filterConfig.isRunningAlwaysTop = !$scope.filterConfig.isRunningAlwaysTop;\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  };\n\t\n\t  $scope.onChangeSortAsc = function () {\n\t    $scope.filterConfig.isSortByAsc = !$scope.filterConfig.isSortByAsc;\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  };\n\t\n\t  $scope.doFilterInputTyping = function (keyEvent, jobInfomations, filterConfig) {\n\t    var RETURN_KEY_CODE = 13;\n\t    $timeout.cancel($scope.dofilterTimeoutObject);\n\t    $scope.isActiveSearchTimer = true;\n\t    $scope.dofilterTimeoutObject = $timeout(function () {\n\t      $scope.doFiltering(jobInfomations, filterConfig);\n\t      $scope.isActiveSearchTimer = false;\n\t    }, 10000);\n\t    if (keyEvent.which === RETURN_KEY_CODE) {\n\t      $timeout.cancel($scope.dofilterTimeoutObject);\n\t      $scope.doFiltering(jobInfomations, filterConfig);\n\t      $scope.isActiveSearchTimer = false;\n\t    }\n\t  };\n\t\n\t  $scope.doForceFilterInputTyping = function (keyEvent, jobInfomations, filterConfig) {\n\t    $timeout.cancel($scope.dofilterTimeoutObject);\n\t    $scope.doFiltering(jobInfomations, filterConfig);\n\t    $scope.isActiveSearchTimer = false;\n\t  };\n\t\n\t  $scope.init = function () {\n\t    $scope.isLoadingFilter = true;\n\t    $scope.jobInfomations = [];\n\t    $scope.JobInfomationsByFilter = $scope.jobInfomations;\n\t    $scope.filterConfig = {\n\t      isRunningAlwaysTop: true,\n\t      filterValueNotebookName: '',\n\t      filterValueInterpreter: '*',\n\t      isSortByAsc: true\n\t    };\n\t    $scope.sortTooltipMsg = 'Switch to sort by desc';\n\t    $scope.jobTypeFilter = jobManagerFilter;\n\t\n\t    websocketMsgSrv.getNoteJobsList();\n\t\n\t    $scope.$watch('filterConfig.isSortByAsc', function (value) {\n\t      if (value) {\n\t        $scope.sortTooltipMsg = 'Switch to sort by desc';\n\t      } else {\n\t        $scope.sortTooltipMsg = 'Switch to sort by asc';\n\t      }\n\t    });\n\t\n\t    $scope.$on('$destroy', function () {\n\t      websocketMsgSrv.unsubscribeJobManager();\n\t    });\n\t  };\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteJobs', function (event, responseData) {\n\t    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n\t    $scope.jobInfomations = responseData.jobs;\n\t    $scope.jobInfomationsIndexs = $scope.jobInfomations ? _.indexBy($scope.jobInfomations, 'noteId') : {};\n\t    $scope.jobTypeFilter($scope.jobInfomations, $scope.filterConfig);\n\t    $scope.activeInterpreters = [{\n\t      name: 'ALL',\n\t      value: '*'\n\t    }];\n\t    var interpreterLists = _.uniq(_.pluck($scope.jobInfomations, 'interpreter'), false);\n\t    for (var index = 0, length = interpreterLists.length; index < length; index++) {\n\t      $scope.activeInterpreters.push({\n\t        name: interpreterLists[index],\n\t        value: interpreterLists[index]\n\t      });\n\t    }\n\t    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n\t  });\n\t\n\t  $scope.$on('setUpdateNoteJobs', function (event, responseData) {\n\t    var jobInfomations = $scope.jobInfomations;\n\t    var indexStore = $scope.jobInfomationsIndexs;\n\t    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n\t    var notes = responseData.jobs;\n\t    notes.map(function (changedItem) {\n\t      if (indexStore[changedItem.noteId] === undefined) {\n\t        var newItem = angular.copy(changedItem);\n\t        jobInfomations.push(newItem);\n\t        indexStore[changedItem.noteId] = newItem;\n\t      } else {\n\t        var changeOriginTarget = indexStore[changedItem.noteId];\n\t\n\t        if (changedItem.isRemoved !== undefined && changedItem.isRemoved === true) {\n\t\n\t          // remove Item.\n\t          var removeIndex = _.findIndex(indexStore, changedItem.noteId);\n\t          if (removeIndex > -1) {\n\t            indexStore.splice(removeIndex, 1);\n\t          }\n\t\n\t          removeIndex = _.findIndex(jobInfomations, { 'noteId': changedItem.noteId });\n\t          if (removeIndex) {\n\t            jobInfomations.splice(removeIndex, 1);\n\t          }\n\t        } else {\n\t          // change value for item.\n\t          changeOriginTarget.isRunningJob = changedItem.isRunningJob;\n\t          changeOriginTarget.noteName = changedItem.noteName;\n\t          changeOriginTarget.noteType = changedItem.noteType;\n\t          changeOriginTarget.interpreter = changedItem.interpreter;\n\t          changeOriginTarget.unixTimeLastRun = changedItem.unixTimeLastRun;\n\t          changeOriginTarget.paragraphs = changedItem.paragraphs;\n\t        }\n\t      }\n\t    });\n\t    $scope.doFiltering(jobInfomations, $scope.filterConfig);\n\t  });\n\t}\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('JobCtrl', JobCtrl);\n\t\n\tJobCtrl.$inject = ['$scope', '$http', 'baseUrlSrv'];\n\t\n\tfunction JobCtrl($scope, $http, baseUrlSrv) {\n\t  $scope.init = function (jobInformation) {\n\t    $scope.progressValue = 0;\n\t  };\n\t\n\t  $scope.getProgress = function () {\n\t    var statusList = _.pluck($scope.notebookJob.paragraphs, 'status');\n\t    var runningJob = _.countBy(statusList, function (status) {\n\t      if (status === 'FINISHED' || status === 'RUNNING') {\n\t        return 'matchCount';\n\t      } else {\n\t        return 'none';\n\t      }\n\t    });\n\t    var totalCount = statusList.length;\n\t    var runningJobCount = runningJob.matchCount;\n\t    var result = Math.ceil(runningJobCount / totalCount * 100);\n\t    return isNaN(result) ? 0 : result;\n\t  };\n\t\n\t  $scope.runNotebookJob = function (notebookId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Run all paragraphs?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http({\n\t            method: 'POST',\n\t            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n\t            headers: {\n\t              'Content-Type': 'application/x-www-form-urlencoded'\n\t            }\n\t          }).then(function successCallback(response) {\n\t            // success\n\t          }, function errorCallback(errorResponse) {\n\t            var errorText = 'SERVER ERROR';\n\t            if (!!errorResponse.data.message) {\n\t              errorText = errorResponse.data.message;\n\t            }\n\t            BootstrapDialog.alert({\n\t              closable: true,\n\t              title: 'Execution Failure',\n\t              message: errorText\n\t            });\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.stopNotebookJob = function (notebookId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Stop all paragraphs?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http({\n\t            method: 'DELETE',\n\t            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n\t            headers: {\n\t              'Content-Type': 'application/x-www-form-urlencoded'\n\t            }\n\t          }).then(function successCallback(response) {\n\t            // success\n\t          }, function errorCallback(errorResponse) {\n\t            var errorText = 'SERVER ERROR';\n\t            if (!!errorResponse.data.message) {\n\t\n\t              errorText = errorResponse.data.message;\n\t            }\n\t            BootstrapDialog.alert({\n\t              closable: true,\n\t              title: 'Stop Failure',\n\t              message: errorText\n\t            });\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.lastExecuteTime = function (unixtime) {\n\t    return moment.unix(unixtime / 1000).fromNow();\n\t  };\n\t}\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').filter('jobManager', jobManagerFilter);\n\t\n\tfunction jobManagerFilter() {\n\t  function filterContext(jobItems, filterConfig) {\n\t    var filterValueInterpreter = filterConfig.filterValueInterpreter;\n\t    var filterValueNotebookName = filterConfig.filterValueNotebookName;\n\t    var isSortByAsc = filterConfig.isSortByAsc;\n\t    var filterItems = jobItems;\n\t\n\t    if (filterValueInterpreter === undefined) {\n\t      filterItems = _.filter(filterItems, function (jobItem) {\n\t        return jobItem.interpreter === undefined ? true : false;\n\t      });\n\t    } else if (filterValueInterpreter !== '*') {\n\t      filterItems = _.where(filterItems, { interpreter: filterValueInterpreter });\n\t    }\n\t\n\t    if (filterValueNotebookName !== '') {\n\t      filterItems = _.filter(filterItems, function (jobItem) {\n\t        var lowerFilterValue = filterValueNotebookName.toLocaleLowerCase();\n\t        var lowerNotebookName = jobItem.noteName.toLocaleLowerCase();\n\t        return lowerNotebookName.match(new RegExp('.*' + lowerFilterValue + '.*'));\n\t      });\n\t    }\n\t\n\t    filterItems = _.sortBy(filterItems, function (sortItem) {\n\t      return sortItem.noteName.toLowerCase();\n\t    });\n\t\n\t    return isSortByAsc ? filterItems : filterItems.reverse();\n\t  }\n\t  return filterContext;\n\t}\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('InterpreterCtrl', InterpreterCtrl);\n\t\n\tInterpreterCtrl.$inject = ['$rootScope', '$scope', '$http', 'baseUrlSrv', 'ngToast', '$timeout', '$route'];\n\t\n\tfunction InterpreterCtrl($rootScope, $scope, $http, baseUrlSrv, ngToast, $timeout, $route) {\n\t  var interpreterSettingsTmp = [];\n\t  $scope.interpreterSettings = [];\n\t  $scope.availableInterpreters = {};\n\t  $scope.showAddNewSetting = false;\n\t  $scope.showRepositoryInfo = false;\n\t  $scope.searchInterpreter = '';\n\t  $scope._ = _;\n\t  ngToast.dismiss();\n\t\n\t  $scope.openPermissions = function () {\n\t    $scope.showInterpreterAuth = true;\n\t  };\n\t\n\t  $scope.closePermissions = function () {\n\t    $scope.showInterpreterAuth = false;\n\t  };\n\t\n\t  var getSelectJson = function getSelectJson() {\n\t    var selectJson = {\n\t      tags: false,\n\t      multiple: true,\n\t      tokenSeparators: [',', ' '],\n\t      minimumInputLength: 2,\n\t      ajax: {\n\t        url: function url(params) {\n\t          if (!params.term) {\n\t            return false;\n\t          }\n\t          return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n\t        },\n\t        delay: 250,\n\t        processResults: function processResults(data, params) {\n\t          var users = [];\n\t          if (data.body.users.length !== 0) {\n\t            for (var i = 0; i < data.body.users.length; i++) {\n\t              users.push({\n\t                'id': data.body.users[i],\n\t                'text': data.body.users[i]\n\t              });\n\t            }\n\t          }\n\t          return {\n\t            results: users,\n\t            pagination: {\n\t              more: false\n\t            }\n\t          };\n\t        },\n\t        cache: false\n\t      }\n\t    };\n\t    return selectJson;\n\t  };\n\t\n\t  $scope.togglePermissions = function (intpName) {\n\t    angular.element('#' + intpName + 'Users').select2(getSelectJson());\n\t    if ($scope.showInterpreterAuth) {\n\t      $scope.closePermissions();\n\t    } else {\n\t      $scope.openPermissions();\n\t    }\n\t  };\n\t\n\t  $scope.$on('ngRenderFinished', function (event, data) {\n\t    for (var setting = 0; setting < $scope.interpreterSettings.length; setting++) {\n\t      angular.element('#' + $scope.interpreterSettings[setting].name + 'Users').select2(getSelectJson());\n\t    }\n\t  });\n\t\n\t  var getInterpreterSettings = function getInterpreterSettings() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting').success(function (data, status, headers, config) {\n\t      $scope.interpreterSettings = data.body;\n\t      checkDownloadingDependencies();\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var checkDownloadingDependencies = function checkDownloadingDependencies() {\n\t    var isDownloading = false;\n\t    for (var index = 0; index < $scope.interpreterSettings.length; index++) {\n\t      var setting = $scope.interpreterSettings[index];\n\t      if (setting.status === 'DOWNLOADING_DEPENDENCIES') {\n\t        isDownloading = true;\n\t      }\n\t\n\t      if (setting.status === 'ERROR' || setting.errorReason) {\n\t        ngToast.danger({ content: 'Error setting properties for interpreter \\'' + setting.group + '.' + setting.name + '\\': ' + setting.errorReason,\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    }\n\t\n\t    if (isDownloading) {\n\t      $timeout(function () {\n\t        if ($route.current.$$route.originalPath === '/interpreter') {\n\t          getInterpreterSettings();\n\t        }\n\t      }, 2000);\n\t    }\n\t  };\n\t\n\t  var getAvailableInterpreters = function getAvailableInterpreters() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter').success(function (data, status, headers, config) {\n\t      $scope.availableInterpreters = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var emptyNewProperty = function emptyNewProperty(object) {\n\t    angular.extend(object, { propertyValue: '', propertyKey: '' });\n\t  };\n\t\n\t  var emptyNewDependency = function emptyNewDependency(object) {\n\t    angular.extend(object, { depArtifact: '', depExclude: '' });\n\t  };\n\t\n\t  var removeTMPSettings = function removeTMPSettings(index) {\n\t    interpreterSettingsTmp.splice(index, 1);\n\t  };\n\t\n\t  $scope.copyOriginInterpreterSettingProperties = function (settingId) {\n\t    var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t    interpreterSettingsTmp[index] = angular.copy($scope.interpreterSettings[index]);\n\t  };\n\t\n\t  $scope.setPerNoteOption = function (settingId, sessionOption) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (sessionOption === 'isolated') {\n\t      option.perNote = sessionOption;\n\t      option.session = false;\n\t      option.process = true;\n\t    } else if (sessionOption === 'scoped') {\n\t      option.perNote = sessionOption;\n\t      option.session = true;\n\t      option.process = false;\n\t    } else {\n\t      option.perNote = 'shared';\n\t      option.session = false;\n\t      option.process = false;\n\t    }\n\t  };\n\t\n\t  $scope.setPerUserOption = function (settingId, sessionOption) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (sessionOption === 'isolated') {\n\t      option.perUser = sessionOption;\n\t      option.session = false;\n\t      option.process = true;\n\t    } else if (sessionOption === 'scoped') {\n\t      option.perUser = sessionOption;\n\t      option.session = true;\n\t      option.process = false;\n\t    } else {\n\t      option.perUser = 'shared';\n\t      option.session = false;\n\t      option.process = false;\n\t    }\n\t  };\n\t\n\t  $scope.getPerNoteOption = function (settingId) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (option.perNote === 'scoped') {\n\t      return 'scoped';\n\t    } else if (option.perNote === 'isolated') {\n\t      return 'isolated';\n\t    } else {\n\t      return 'shared';\n\t    }\n\t  };\n\t\n\t  $scope.getPerUserOption = function (settingId) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    if (option.perUser === 'scoped') {\n\t      return 'scoped';\n\t    } else if (option.perUser === 'isolated') {\n\t      return 'isolated';\n\t    } else {\n\t      return 'shared';\n\t    }\n\t  };\n\t\n\t  $scope.getInterpreterRunningOption = function (settingId) {\n\t    var sharedModeName = 'shared';\n\t\n\t    var globallyModeName = 'Globally';\n\t    var perNoteModeName = 'Per Note';\n\t    var perUserModeName = 'Per User';\n\t\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t\n\t    var perNote = option.perNote;\n\t    var perUser = option.perUser;\n\t\n\t    // Globally == shared_perNote + shared_perUser\n\t    if (perNote === sharedModeName && perUser === sharedModeName) {\n\t      return globallyModeName;\n\t    }\n\t\n\t    if ($rootScope.ticket.ticket === 'anonymous' && $rootScope.ticket.roles === '[]') {\n\t      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n\t        return perNoteModeName;\n\t      }\n\t    } else if ($rootScope.ticket.ticket !== 'anonymous') {\n\t      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n\t        if (perUser !== undefined && typeof perUser === 'string' && perUser !== '') {\n\t          return perUserModeName;\n\t        }\n\t        return perNoteModeName;\n\t      }\n\t    }\n\t\n\t    option.perNote = sharedModeName;\n\t    option.perUser = sharedModeName;\n\t    return globallyModeName;\n\t  };\n\t\n\t  $scope.setInterpreterRunningOption = function (settingId, isPerNoteMode, isPerUserMode) {\n\t    var option;\n\t    if (settingId === undefined) {\n\t      option = $scope.newInterpreterSetting.option;\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      option = setting.option;\n\t    }\n\t    option.perNote = isPerNoteMode;\n\t    option.perUser = isPerUserMode;\n\t  };\n\t\n\t  $scope.updateInterpreterSetting = function (form, settingId) {\n\t    var thisConfirm = BootstrapDialog.confirm({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: '',\n\t      message: 'Do you want to update this interpreter and restart with new settings?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t          var setting = $scope.interpreterSettings[index];\n\t          if (setting.propertyKey !== '' || setting.propertyKey) {\n\t            $scope.addNewInterpreterProperty(settingId);\n\t          }\n\t          if (setting.depArtifact !== '' || setting.depArtifact) {\n\t            $scope.addNewInterpreterDependency(settingId);\n\t          }\n\t          // add missing field of option\n\t          if (!setting.option) {\n\t            setting.option = {};\n\t          }\n\t          if (setting.option.isExistingProcess === undefined) {\n\t            setting.option.isExistingProcess = false;\n\t          }\n\t          if (setting.option.setPermission === undefined) {\n\t            setting.option.setPermission = false;\n\t          }\n\t          if (setting.option.isUserImpersonate === undefined) {\n\t            setting.option.isUserImpersonate = false;\n\t          }\n\t          if (!($scope.getInterpreterRunningOption(settingId) === 'Per User' && $scope.getPerUserOption(settingId) === 'isolated')) {\n\t            setting.option.isUserImpersonate = false;\n\t          }\n\t          if (setting.option.remote === undefined) {\n\t            // remote always true for now\n\t            setting.option.remote = true;\n\t          }\n\t          setting.option.users = angular.element('#' + setting.name + 'Users').val();\n\t\n\t          var request = {\n\t            option: angular.copy(setting.option),\n\t            properties: angular.copy(setting.properties),\n\t            dependencies: angular.copy(setting.dependencies)\n\t          };\n\t\n\t          thisConfirm.$modalFooter.find('button').addClass('disabled');\n\t          thisConfirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\t\n\t          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId, request).success(function (data, status, headers, config) {\n\t            $scope.interpreterSettings[index] = data.body;\n\t            removeTMPSettings(index);\n\t            checkDownloadingDependencies();\n\t            thisConfirm.close();\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t            ngToast.danger({ content: data.message, verticalPosition: 'bottom' });\n\t            form.$show();\n\t            thisConfirm.close();\n\t          });\n\t          return false;\n\t        } else {\n\t          form.$show();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.resetInterpreterSetting = function (settingId) {\n\t    var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t\n\t    // Set the old settings back\n\t    $scope.interpreterSettings[index] = angular.copy(interpreterSettingsTmp[index]);\n\t    removeTMPSettings(index);\n\t  };\n\t\n\t  $scope.removeInterpreterSetting = function (settingId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to delete this interpreter setting?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId).success(function (data, status, headers, config) {\n\t\n\t            var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t            $scope.interpreterSettings.splice(index, 1);\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.newInterpreterGroupChange = function () {\n\t    var el = _.pluck(_.filter($scope.availableInterpreters, { 'name': $scope.newInterpreterSetting.group }), 'properties');\n\t    var properties = {};\n\t    for (var i = 0; i < el.length; i++) {\n\t      var intpInfo = el[i];\n\t      for (var key in intpInfo) {\n\t        properties[key] = {\n\t          value: intpInfo[key].defaultValue,\n\t          description: intpInfo[key].description\n\t        };\n\t      }\n\t    }\n\t    $scope.newInterpreterSetting.properties = properties;\n\t  };\n\t\n\t  $scope.restartInterpreterSetting = function (settingId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to restart this interpreter?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + settingId).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t            $scope.interpreterSettings[index] = data.body;\n\t            ngToast.info('Interpreter stopped. Will be lazily started on next run.');\n\t          }).error(function (data, status, headers, config) {\n\t            var errorMsg = data !== null ? data.message : 'Could not connect to server.';\n\t            console.log('Error %o %o', status, errorMsg);\n\t            ngToast.danger(errorMsg);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.addNewInterpreterSetting = function () {\n\t    //user input validation on interpreter creation\n\t    if (!$scope.newInterpreterSetting.name || !$scope.newInterpreterSetting.name.trim() || !$scope.newInterpreterSetting.group) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        title: 'Add interpreter',\n\t        message: 'Please fill in interpreter name and choose a group'\n\t      });\n\t      return;\n\t    }\n\t\n\t    if ($scope.newInterpreterSetting.name.indexOf('.') >= 0) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        title: 'Add interpreter',\n\t        message: '\\'.\\' is invalid for interpreter name'\n\t      });\n\t      return;\n\t    }\n\t\n\t    if (_.findIndex($scope.interpreterSettings, { 'name': $scope.newInterpreterSetting.name }) >= 0) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        title: 'Add interpreter',\n\t        message: 'Name ' + $scope.newInterpreterSetting.name + ' already exists'\n\t      });\n\t      return;\n\t    }\n\t\n\t    var newSetting = $scope.newInterpreterSetting;\n\t    if (newSetting.propertyKey !== '' || newSetting.propertyKey) {\n\t      $scope.addNewInterpreterProperty();\n\t    }\n\t    if (newSetting.depArtifact !== '' || newSetting.depArtifact) {\n\t      $scope.addNewInterpreterDependency();\n\t    }\n\t    if (newSetting.option.setPermission === undefined) {\n\t      newSetting.option.setPermission = false;\n\t    }\n\t    newSetting.option.users = angular.element('#newInterpreterUsers').val();\n\t\n\t    var request = angular.copy($scope.newInterpreterSetting);\n\t\n\t    // Change properties to proper request format\n\t    var newProperties = {};\n\t    for (var p in newSetting.properties) {\n\t      newProperties[p] = newSetting.properties[p].value;\n\t    }\n\t    request.properties = newProperties;\n\t\n\t    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/setting', request).success(function (data, status, headers, config) {\n\t      $scope.resetNewInterpreterSetting();\n\t      getInterpreterSettings();\n\t      $scope.showAddNewSetting = false;\n\t      checkDownloadingDependencies();\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t      ngToast.danger({ content: data.message, verticalPosition: 'bottom' });\n\t    });\n\t  };\n\t\n\t  $scope.cancelInterpreterSetting = function () {\n\t    $scope.showAddNewSetting = false;\n\t    $scope.resetNewInterpreterSetting();\n\t  };\n\t\n\t  $scope.resetNewInterpreterSetting = function () {\n\t    $scope.newInterpreterSetting = {\n\t      name: undefined,\n\t      group: undefined,\n\t      properties: {},\n\t      dependencies: [],\n\t      option: {\n\t        remote: true,\n\t        isExistingProcess: false,\n\t        setPermission: false,\n\t        session: false,\n\t        process: false\n\t\n\t      }\n\t    };\n\t    emptyNewProperty($scope.newInterpreterSetting);\n\t  };\n\t\n\t  $scope.removeInterpreterProperty = function (key, settingId) {\n\t    if (settingId === undefined) {\n\t      delete $scope.newInterpreterSetting.properties[key];\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      delete $scope.interpreterSettings[index].properties[key];\n\t    }\n\t  };\n\t\n\t  $scope.removeInterpreterDependency = function (artifact, settingId) {\n\t    if (settingId === undefined) {\n\t      $scope.newInterpreterSetting.dependencies = _.reject($scope.newInterpreterSetting.dependencies, function (el) {\n\t        return el.groupArtifactVersion === artifact;\n\t      });\n\t    } else {\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      $scope.interpreterSettings[index].dependencies = _.reject($scope.interpreterSettings[index].dependencies, function (el) {\n\t        return el.groupArtifactVersion === artifact;\n\t      });\n\t    }\n\t  };\n\t\n\t  $scope.addNewInterpreterProperty = function (settingId) {\n\t    if (settingId === undefined) {\n\t      // Add new property from create form\n\t      if (!$scope.newInterpreterSetting.propertyKey || $scope.newInterpreterSetting.propertyKey === '') {\n\t        return;\n\t      }\n\t\n\t      $scope.newInterpreterSetting.properties[$scope.newInterpreterSetting.propertyKey] = {\n\t        value: $scope.newInterpreterSetting.propertyValue\n\t      };\n\t      emptyNewProperty($scope.newInterpreterSetting);\n\t    } else {\n\t      // Add new property from edit form\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t\n\t      if (!setting.propertyKey || setting.propertyKey === '') {\n\t        return;\n\t      }\n\t      setting.properties[setting.propertyKey] = setting.propertyValue;\n\t      emptyNewProperty(setting);\n\t    }\n\t  };\n\t\n\t  $scope.addNewInterpreterDependency = function (settingId) {\n\t    if (settingId === undefined) {\n\t      // Add new dependency from create form\n\t      if (!$scope.newInterpreterSetting.depArtifact || $scope.newInterpreterSetting.depArtifact === '') {\n\t        return;\n\t      }\n\t\n\t      // overwrite if artifact already exists\n\t      var newSetting = $scope.newInterpreterSetting;\n\t      for (var d in newSetting.dependencies) {\n\t        if (newSetting.dependencies[d].groupArtifactVersion === newSetting.depArtifact) {\n\t          newSetting.dependencies[d] = {\n\t            'groupArtifactVersion': newSetting.depArtifact,\n\t            'exclusions': newSetting.depExclude\n\t          };\n\t          newSetting.dependencies.splice(d, 1);\n\t        }\n\t      }\n\t\n\t      newSetting.dependencies.push({\n\t        'groupArtifactVersion': newSetting.depArtifact,\n\t        'exclusions': newSetting.depExclude === '' ? [] : newSetting.depExclude\n\t      });\n\t      emptyNewDependency(newSetting);\n\t    } else {\n\t      // Add new dependency from edit form\n\t      var index = _.findIndex($scope.interpreterSettings, { 'id': settingId });\n\t      var setting = $scope.interpreterSettings[index];\n\t      if (!setting.depArtifact || setting.depArtifact === '') {\n\t        return;\n\t      }\n\t\n\t      // overwrite if artifact already exists\n\t      for (var dep in setting.dependencies) {\n\t        if (setting.dependencies[dep].groupArtifactVersion === setting.depArtifact) {\n\t          setting.dependencies[dep] = {\n\t            'groupArtifactVersion': setting.depArtifact,\n\t            'exclusions': setting.depExclude\n\t          };\n\t          setting.dependencies.splice(dep, 1);\n\t        }\n\t      }\n\t\n\t      setting.dependencies.push({\n\t        'groupArtifactVersion': setting.depArtifact,\n\t        'exclusions': setting.depExclude === '' ? [] : setting.depExclude\n\t      });\n\t      emptyNewDependency(setting);\n\t    }\n\t  };\n\t\n\t  $scope.resetNewRepositorySetting = function () {\n\t    $scope.newRepoSetting = {\n\t      id: '',\n\t      url: '',\n\t      snapshot: false,\n\t      username: '',\n\t      password: '',\n\t      proxyProtocol: 'HTTP',\n\t      proxyHost: '',\n\t      proxyPort: null,\n\t      proxyLogin: '',\n\t      proxyPassword: ''\n\t    };\n\t  };\n\t\n\t  var getRepositories = function getRepositories() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/repository').success(function (data, status, headers, config) {\n\t      $scope.repositories = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  $scope.addNewRepository = function () {\n\t    var request = angular.copy($scope.newRepoSetting);\n\t\n\t    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/repository', request).success(function (data, status, headers, config) {\n\t      getRepositories();\n\t      $scope.resetNewRepositorySetting();\n\t      angular.element('#repoModal').modal('hide');\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', headers, config);\n\t    });\n\t  };\n\t\n\t  $scope.removeRepository = function (repoId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to delete this repository?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/repository/' + repoId).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.repositories, { 'id': repoId });\n\t            $scope.repositories.splice(index, 1);\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  $scope.isDefaultRepository = function (repoId) {\n\t    if (repoId === 'central' || repoId === 'local') {\n\t      return true;\n\t    } else {\n\t      return false;\n\t    }\n\t  };\n\t\n\t  $scope.showErrorMessage = function (setting) {\n\t    BootstrapDialog.show({\n\t      title: 'Error downloading dependencies',\n\t      message: setting.errorReason\n\t    });\n\t  };\n\t\n\t  var init = function init() {\n\t    $scope.resetNewInterpreterSetting();\n\t    $scope.resetNewRepositorySetting();\n\t\n\t    getInterpreterSettings();\n\t    getAvailableInterpreters();\n\t    getRepositories();\n\t  };\n\t\n\t  $scope.showSparkUI = function (settingId) {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/getmetainfos/' + settingId + '?propName=url').success(function (data, status, headers, config) {\n\t      var url = data.body.url;\n\t      if (!url) {\n\t        BootstrapDialog.alert({\n\t          message: 'No spark application running'\n\t        });\n\t        return;\n\t      }\n\t      window.open(url, '_blank');\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  init();\n\t}\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').filter('sortByKey', sortByKey);\n\t\n\tfunction sortByKey() {\n\t  return function (properties) {\n\t    var sortedKeys = properties ? Object.keys(properties) : [];\n\t    return sortedKeys.sort();\n\t  };\n\t}\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('CredentialCtrl', CredentialCtrl);\n\t\n\tCredentialCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\t\n\tfunction CredentialCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n\t  $scope._ = _;\n\t  ngToast.dismiss();\n\t\n\t  $scope.credentialInfo = [];\n\t  $scope.showAddNewCredentialInfo = false;\n\t  $scope.availableInterpreters = [];\n\t\n\t  var getCredentialInfo = function getCredentialInfo() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/credential').success(function (data, status, headers, config) {\n\t      $scope.credentialInfo = _.map(data.body.userCredentials, function (value, prop) {\n\t        return { entity: prop, password: value.password, username: value.username };\n\t      });\n\t      console.log('Success %o %o', status, $scope.credentialInfo);\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  $scope.addNewCredentialInfo = function () {\n\t    if ($scope.entity && _.isEmpty($scope.entity.trim()) && $scope.username && _.isEmpty($scope.username.trim())) {\n\t      ngToast.danger({\n\t        content: 'Username \\\\ Entity can not be empty.',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      return;\n\t    }\n\t\n\t    var newCredential = {\n\t      'entity': $scope.entity,\n\t      'username': $scope.username,\n\t      'password': $scope.password\n\t    };\n\t\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/credential', newCredential).success(function (data, status, headers, config) {\n\t      ngToast.success({\n\t        content: 'Successfully saved credentials.',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      $scope.credentialInfo.push(newCredential);\n\t      resetCredentialInfo();\n\t      $scope.showAddNewCredentialInfo = false;\n\t      console.log('Success %o %o', status, data.message);\n\t    }).error(function (data, status, headers, config) {\n\t      ngToast.danger({\n\t        content: 'Error saving credentials',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var getAvailableInterpreters = function getAvailableInterpreters() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting').success(function (data, status, headers, config) {\n\t      for (var setting = 0; setting < data.body.length; setting++) {\n\t        $scope.availableInterpreters.push(data.body[setting].group + '.' + data.body[setting].name);\n\t      }\n\t      angular.element('#entityname').autocomplete({\n\t        source: $scope.availableInterpreters,\n\t        select: function select(event, selected) {\n\t          $scope.entity = selected.item.value;\n\t          return false;\n\t        }\n\t      });\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  $scope.toggleAddNewCredentialInfo = function () {\n\t    if ($scope.showAddNewCredentialInfo) {\n\t      $scope.showAddNewCredentialInfo = false;\n\t    } else {\n\t      $scope.showAddNewCredentialInfo = true;\n\t    }\n\t  };\n\t\n\t  $scope.cancelCredentialInfo = function () {\n\t    $scope.showAddNewCredentialInfo = false;\n\t    resetCredentialInfo();\n\t  };\n\t\n\t  var resetCredentialInfo = function resetCredentialInfo() {\n\t    $scope.entity = '';\n\t    $scope.username = '';\n\t    $scope.password = '';\n\t  };\n\t\n\t  $scope.copyOriginCredentialsInfo = function () {\n\t    ngToast.info({\n\t      content: 'Since entity is a unique key, you can edit only username & password',\n\t      verticalPosition: 'bottom',\n\t      timeout: '3000'\n\t    });\n\t  };\n\t\n\t  $scope.updateCredentialInfo = function (form, data, entity) {\n\t    var request = {\n\t      entity: entity,\n\t      username: data.username,\n\t      password: data.password\n\t    };\n\t\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/credential/', request).success(function (data, status, headers, config) {\n\t      var index = _.findIndex($scope.credentialInfo, { 'entity': entity });\n\t      $scope.credentialInfo[index] = request;\n\t      return true;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t      ngToast.danger({\n\t        content: 'We couldn\\'t save the credential',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      form.$show();\n\t    });\n\t    return false;\n\t  };\n\t\n\t  $scope.removeCredentialInfo = function (entity) {\n\t    BootstrapDialog.confirm({\n\t      closable: false,\n\t      closeByBackdrop: false,\n\t      closeByKeyboard: false,\n\t      title: '',\n\t      message: 'Do you want to delete this credential information?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          $http.delete(baseUrlSrv.getRestApiBase() + '/credential/' + entity).success(function (data, status, headers, config) {\n\t            var index = _.findIndex($scope.credentialInfo, { 'entity': entity });\n\t            $scope.credentialInfo.splice(index, 1);\n\t            console.log('Success %o %o', status, data.message);\n\t          }).error(function (data, status, headers, config) {\n\t            console.log('Error %o %o', status, data.message);\n\t          });\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  var init = function init() {\n\t    getAvailableInterpreters();\n\t    getCredentialInfo();\n\t  };\n\t\n\t  init();\n\t}\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('ConfigurationCtrl', ConfigurationCtrl);\n\t\n\tConfigurationCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\t\n\tfunction ConfigurationCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n\t  $scope.configrations = [];\n\t  $scope._ = _;\n\t  ngToast.dismiss();\n\t\n\t  var getConfigurations = function getConfigurations() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/configurations/all').success(function (data, status, headers, config) {\n\t      $scope.configurations = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  };\n\t\n\t  var init = function init() {\n\t    getConfigurations();\n\t  };\n\t\n\t  init();\n\t}\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('ParagraphCtrl', ParagraphCtrl);\n\t\n\tParagraphCtrl.$inject = ['$scope', '$rootScope', '$route', '$window', '$routeParams', '$location', '$timeout', '$compile', '$http', '$q', 'websocketMsgSrv', 'baseUrlSrv', 'ngToast', 'saveAsService', 'noteVarShareService'];\n\t\n\tfunction ParagraphCtrl($scope, $rootScope, $route, $window, $routeParams, $location, $timeout, $compile, $http, $q, websocketMsgSrv, baseUrlSrv, ngToast, saveAsService, noteVarShareService) {\n\t  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n\t  $rootScope.keys = Object.keys;\n\t  $scope.parentNote = null;\n\t  $scope.paragraph = null;\n\t  $scope.originalText = '';\n\t  $scope.editor = null;\n\t\n\t  var editorSetting = {};\n\t  // flag that is used to set editor setting on paste percent sign\n\t  var pastePercentSign = false;\n\t  // flag that is used to set editor setting on save interpreter bindings\n\t  var setInterpreterBindings = false;\n\t  var paragraphScope = $rootScope.$new(true, $rootScope);\n\t\n\t  // to keep backward compatibility\n\t  $scope.compiledScope = paragraphScope;\n\t\n\t  paragraphScope.z = {\n\t    // z.runParagraph('20150213-231621_168813393')\n\t    runParagraph: function runParagraph(paragraphId) {\n\t      if (paragraphId) {\n\t        var filtered = $scope.parentNote.paragraphs.filter(function (x) {\n\t          return x.id === paragraphId;\n\t        });\n\t        if (filtered.length === 1) {\n\t          var paragraph = filtered[0];\n\t          websocketMsgSrv.runParagraph(paragraph.id, paragraph.title, paragraph.text, paragraph.config, paragraph.settings.params);\n\t        } else {\n\t          ngToast.danger({ content: 'Cannot find a paragraph with id \\'' + paragraphId + '\\'',\n\t            verticalPosition: 'top', dismissOnTimeout: false });\n\t        }\n\t      } else {\n\t        ngToast.danger({\n\t          content: 'Please provide a \\'paragraphId\\' when calling z.runParagraph(paragraphId)',\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    },\n\t\n\t    // Example: z.angularBind('my_var', 'Test Value', '20150213-231621_168813393')\n\t    angularBind: function angularBind(varName, value, paragraphId) {\n\t      // Only push to server if there paragraphId is defined\n\t      if (paragraphId) {\n\t        websocketMsgSrv.clientBindAngularObject($routeParams.noteId, varName, value, paragraphId);\n\t      } else {\n\t        ngToast.danger({\n\t          content: 'Please provide a \\'paragraphId\\' when calling ' + 'z.angularBind(varName, value, \\'PUT_HERE_PARAGRAPH_ID\\')',\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    },\n\t\n\t    // Example: z.angularUnBind('my_var', '20150213-231621_168813393')\n\t    angularUnbind: function angularUnbind(varName, paragraphId) {\n\t      // Only push to server if paragraphId is defined\n\t      if (paragraphId) {\n\t        websocketMsgSrv.clientUnbindAngularObject($routeParams.noteId, varName, paragraphId);\n\t      } else {\n\t        ngToast.danger({\n\t          content: 'Please provide a \\'paragraphId\\' when calling ' + 'z.angularUnbind(varName, \\'PUT_HERE_PARAGRAPH_ID\\')',\n\t          verticalPosition: 'top', dismissOnTimeout: false });\n\t      }\n\t    }\n\t  };\n\t\n\t  var angularObjectRegistry = {};\n\t\n\t  // Controller init\n\t  $scope.init = function (newParagraph, note) {\n\t    $scope.paragraph = newParagraph;\n\t    $scope.parentNote = note;\n\t    $scope.originalText = angular.copy(newParagraph.text);\n\t    $scope.chart = {};\n\t    $scope.baseMapOption = ['Streets', 'Satellite', 'Hybrid', 'Topo', 'Gray', 'Oceans', 'Terrain'];\n\t    $scope.colWidthOption = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n\t    $scope.paragraphFocused = false;\n\t    if (newParagraph.focus) {\n\t      $scope.paragraphFocused = true;\n\t    }\n\t    if (!$scope.paragraph.config) {\n\t      $scope.paragraph.config = {};\n\t    }\n\t\n\t    noteVarShareService.put($scope.paragraph.id + '_paragraphScope', paragraphScope);\n\t\n\t    initializeDefault($scope.paragraph.config);\n\t  };\n\t\n\t  var initializeDefault = function initializeDefault(config) {\n\t    var forms = $scope.paragraph.settings.forms;\n\t\n\t    if (!config.colWidth) {\n\t      config.colWidth = 12;\n\t    }\n\t\n\t    if (config.enabled === undefined) {\n\t      config.enabled = true;\n\t    }\n\t\n\t    for (var idx in forms) {\n\t      if (forms[idx]) {\n\t        if (forms[idx].options) {\n\t          if (config.runOnSelectionChange === undefined) {\n\t            config.runOnSelectionChange = true;\n\t          }\n\t        }\n\t      }\n\t    }\n\t\n\t    if (!config.results) {\n\t      config.results = {};\n\t    }\n\t\n\t    if (!config.editorSetting) {\n\t      config.editorSetting = {};\n\t    } else if (config.editorSetting.editOnDblClick) {\n\t      editorSetting.isOutputHidden = config.editorSetting.editOnDblClick;\n\t    }\n\t  };\n\t\n\t  $scope.$on('updateParagraphOutput', function (event, data) {\n\t    if ($scope.paragraph.id === data.paragraphId) {\n\t      if (!$scope.paragraph.results) {\n\t        $scope.paragraph.results = {};\n\t      }\n\t      if (!$scope.paragraph.results.msg) {\n\t        $scope.paragraph.results.msg = [];\n\t      }\n\t\n\t      var update = $scope.paragraph.results.msg[data.index] ? true : false;\n\t\n\t      $scope.paragraph.results.msg[data.index] = {\n\t        data: data.data,\n\t        type: data.type\n\t      };\n\t\n\t      if (update) {\n\t        $rootScope.$broadcast('updateResult', $scope.paragraph.results.msg[data.index], $scope.paragraph.config.results[data.index], $scope.paragraph, data.index);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.getIframeDimensions = function () {\n\t    if ($scope.asIframe) {\n\t      var paragraphid = '#' + $routeParams.paragraphId + '_container';\n\t      var height = angular.element(paragraphid).height();\n\t      return height;\n\t    }\n\t    return 0;\n\t  };\n\t\n\t  $scope.$watch($scope.getIframeDimensions, function (newValue, oldValue) {\n\t    if ($scope.asIframe && newValue) {\n\t      var message = {};\n\t      message.height = newValue;\n\t      message.url = $location.$$absUrl;\n\t      $window.parent.postMessage(angular.toJson(message), '*');\n\t    }\n\t  });\n\t\n\t  $scope.getEditor = function () {\n\t    return $scope.editor;\n\t  };\n\t\n\t  $scope.$watch($scope.getEditor, function (newValue, oldValue) {\n\t    if (!$scope.editor) {\n\t      return;\n\t    }\n\t    if (newValue === null || newValue === undefined) {\n\t      console.log('editor isnt loaded yet, returning');\n\t      return;\n\t    }\n\t    if ($scope.revisionView === true) {\n\t      $scope.editor.setReadOnly(true);\n\t    } else {\n\t      $scope.editor.setReadOnly(false);\n\t    }\n\t  });\n\t\n\t  var isEmpty = function isEmpty(object) {\n\t    return !object;\n\t  };\n\t\n\t  $scope.isRunning = function (paragraph) {\n\t    return paragraph.status === 'RUNNING' || paragraph.status === 'PENDING';\n\t  };\n\t\n\t  $scope.cancelParagraph = function (paragraph) {\n\t    console.log('Cancel %o', paragraph.id);\n\t    websocketMsgSrv.cancelParagraphRun(paragraph.id);\n\t  };\n\t\n\t  $scope.runParagraph = function (data) {\n\t    websocketMsgSrv.runParagraph($scope.paragraph.id, $scope.paragraph.title, data, $scope.paragraph.config, $scope.paragraph.settings.params);\n\t    $scope.originalText = angular.copy(data);\n\t    $scope.dirtyText = undefined;\n\t\n\t    if ($scope.paragraph.config.editorSetting.editOnDblClick) {\n\t      closeEditorAndOpenTable($scope.paragraph);\n\t    } else if (editorSetting.isOutputHidden && !$scope.paragraph.config.editorSetting.editOnDblClick) {\n\t      // %md/%angular repl make output to be hidden by default after running\n\t      // so should open output if repl changed from %md/%angular to another\n\t      openEditorAndOpenTable($scope.paragraph);\n\t    }\n\t    editorSetting.isOutputHidden = $scope.paragraph.config.editorSetting.editOnDblClick;\n\t  };\n\t\n\t  $scope.saveParagraph = function (paragraph) {\n\t    var dirtyText = paragraph.text;\n\t    if (dirtyText === undefined || dirtyText === $scope.originalText) {\n\t      return;\n\t    }\n\t    commitParagraph(paragraph);\n\t    $scope.originalText = dirtyText;\n\t    $scope.dirtyText = undefined;\n\t  };\n\t\n\t  $scope.toggleEnableDisable = function (paragraph) {\n\t    paragraph.config.enabled = !paragraph.config.enabled;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.run = function (paragraph, editorValue) {\n\t    if (editorValue && !$scope.isRunning(paragraph)) {\n\t      $scope.runParagraph(editorValue);\n\t    }\n\t  };\n\t\n\t  $scope.turnOnAutoRun = function (paragraph) {\n\t    paragraph.config.runOnSelectionChange = !paragraph.config.runOnSelectionChange;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.moveUp = function (paragraph) {\n\t    $scope.$emit('moveParagraphUp', paragraph);\n\t  };\n\t\n\t  $scope.moveDown = function (paragraph) {\n\t    $scope.$emit('moveParagraphDown', paragraph);\n\t  };\n\t\n\t  $scope.insertNew = function (position) {\n\t    $scope.$emit('insertParagraph', $scope.paragraph.id, position);\n\t  };\n\t\n\t  $scope.copyPara = function (position) {\n\t    var editorValue = $scope.getEditorValue();\n\t    if (editorValue) {\n\t      $scope.copyParagraph(editorValue, position);\n\t    }\n\t  };\n\t\n\t  $scope.copyParagraph = function (data, position) {\n\t    var newIndex = -1;\n\t    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n\t      if ($scope.note.paragraphs[i].id === $scope.paragraph.id) {\n\t        //determine position of where to add new paragraph; default is below\n\t        if (position === 'above') {\n\t          newIndex = i;\n\t        } else {\n\t          newIndex = i + 1;\n\t        }\n\t        break;\n\t      }\n\t    }\n\t\n\t    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n\t      return;\n\t    }\n\t\n\t    var config = angular.copy($scope.paragraph.config);\n\t    config.editorHide = false;\n\t\n\t    websocketMsgSrv.copyParagraph(newIndex, $scope.paragraph.title, data, config, $scope.paragraph.settings.params);\n\t  };\n\t\n\t  $scope.removeParagraph = function (paragraph) {\n\t    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n\t    if (paragraphs[paragraphs.length - 1].id.indexOf(paragraph.id) === 0) {\n\t      BootstrapDialog.alert({\n\t        closable: true,\n\t        message: 'The last paragraph can\\'t be deleted.',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            $scope.editor.focus();\n\t          }\n\t        }\n\t      });\n\t    } else {\n\t      BootstrapDialog.confirm({\n\t        closable: true,\n\t        title: '',\n\t        message: 'Do you want to delete this paragraph?',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            console.log('Remove paragraph');\n\t            websocketMsgSrv.removeParagraph(paragraph.id);\n\t            $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n\t          }\n\t        }\n\t      });\n\t    }\n\t  };\n\t\n\t  $scope.clearParagraphOutput = function (paragraph) {\n\t    websocketMsgSrv.clearParagraphOutput(paragraph.id);\n\t  };\n\t\n\t  $scope.toggleEditor = function (paragraph) {\n\t    if (paragraph.config.editorHide) {\n\t      $scope.openEditor(paragraph);\n\t    } else {\n\t      $scope.closeEditor(paragraph);\n\t    }\n\t  };\n\t\n\t  $scope.closeEditor = function (paragraph) {\n\t    console.log('close the note');\n\t    paragraph.config.editorHide = true;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.openEditor = function (paragraph) {\n\t    console.log('open the note');\n\t    paragraph.config.editorHide = false;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.closeTable = function (paragraph) {\n\t    console.log('close the output');\n\t    paragraph.config.tableHide = true;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.openTable = function (paragraph) {\n\t    console.log('open the output');\n\t    paragraph.config.tableHide = false;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  var openEditorAndCloseTable = function openEditorAndCloseTable(paragraph) {\n\t    manageEditorAndTableState(paragraph, false, true);\n\t  };\n\t\n\t  var closeEditorAndOpenTable = function closeEditorAndOpenTable(paragraph) {\n\t    manageEditorAndTableState(paragraph, true, false);\n\t  };\n\t\n\t  var openEditorAndOpenTable = function openEditorAndOpenTable(paragraph) {\n\t    manageEditorAndTableState(paragraph, false, false);\n\t  };\n\t\n\t  var manageEditorAndTableState = function manageEditorAndTableState(paragraph, hideEditor, hideTable) {\n\t    paragraph.config.editorHide = hideEditor;\n\t    paragraph.config.tableHide = hideTable;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.showTitle = function (paragraph) {\n\t    paragraph.config.title = true;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.hideTitle = function (paragraph) {\n\t    paragraph.config.title = false;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.setTitle = function (paragraph) {\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.showLineNumbers = function (paragraph) {\n\t    if ($scope.editor) {\n\t      paragraph.config.lineNumbers = true;\n\t      $scope.editor.renderer.setShowGutter(true);\n\t      commitParagraph(paragraph);\n\t    }\n\t  };\n\t\n\t  $scope.hideLineNumbers = function (paragraph) {\n\t    if ($scope.editor) {\n\t      paragraph.config.lineNumbers = false;\n\t      $scope.editor.renderer.setShowGutter(false);\n\t      commitParagraph(paragraph);\n\t    }\n\t  };\n\t\n\t  $scope.columnWidthClass = function (n) {\n\t    if ($scope.asIframe) {\n\t      return 'col-md-12';\n\t    } else {\n\t      return 'paragraph-col col-md-' + n;\n\t    }\n\t  };\n\t\n\t  $scope.changeColWidth = function (paragraph, width) {\n\t    angular.element('.navbar-right.open').removeClass('open');\n\t    paragraph.config.colWidth = width;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.toggleOutput = function (paragraph) {\n\t    paragraph.config.tableHide = !paragraph.config.tableHide;\n\t    commitParagraph(paragraph);\n\t  };\n\t\n\t  $scope.loadForm = function (formulaire, params) {\n\t    var value = formulaire.defaultValue;\n\t    if (params[formulaire.name]) {\n\t      value = params[formulaire.name];\n\t    }\n\t\n\t    $scope.paragraph.settings.params[formulaire.name] = value;\n\t  };\n\t\n\t  $scope.toggleCheckbox = function (formulaire, option) {\n\t    var idx = $scope.paragraph.settings.params[formulaire.name].indexOf(option.value);\n\t    if (idx > -1) {\n\t      $scope.paragraph.settings.params[formulaire.name].splice(idx, 1);\n\t    } else {\n\t      $scope.paragraph.settings.params[formulaire.name].push(option.value);\n\t    }\n\t  };\n\t\n\t  $scope.aceChanged = function (_, editor) {\n\t    var session = editor.getSession();\n\t    var dirtyText = session.getValue();\n\t    $scope.dirtyText = dirtyText;\n\t    $scope.startSaveTimer();\n\t    setParagraphMode(session, dirtyText, editor.getCursorPosition());\n\t  };\n\t\n\t  $scope.aceLoaded = function (_editor) {\n\t    var langTools = ace.require('ace/ext/language_tools');\n\t    var Range = ace.require('ace/range').Range;\n\t\n\t    _editor.$blockScrolling = Infinity;\n\t    $scope.editor = _editor;\n\t    $scope.editor.on('input', $scope.aceChanged);\n\t    if (_editor.container.id !== '{{paragraph.id}}_editor') {\n\t      $scope.editor.renderer.setShowGutter($scope.paragraph.config.lineNumbers);\n\t      $scope.editor.setShowFoldWidgets(false);\n\t      $scope.editor.setHighlightActiveLine(false);\n\t      $scope.editor.setHighlightGutterLine(false);\n\t      $scope.editor.getSession().setUseWrapMode(true);\n\t      $scope.editor.setTheme('ace/theme/chrome');\n\t      $scope.editor.setReadOnly($scope.isRunning($scope.paragraph));\n\t      if ($scope.paragraphFocused) {\n\t        $scope.editor.focus();\n\t        $scope.goToEnd($scope.editor);\n\t      }\n\t\n\t      autoAdjustEditorHeight(_editor);\n\t      angular.element(window).resize(function () {\n\t        autoAdjustEditorHeight(_editor);\n\t      });\n\t\n\t      if (navigator.appVersion.indexOf('Mac') !== -1) {\n\t        $scope.editor.setKeyboardHandler('ace/keyboard/emacs');\n\t        $rootScope.isMac = true;\n\t      } else if (navigator.appVersion.indexOf('Win') !== -1 || navigator.appVersion.indexOf('X11') !== -1 || navigator.appVersion.indexOf('Linux') !== -1) {\n\t        $rootScope.isMac = false;\n\t        // not applying emacs key binding while the binding override Ctrl-v. default behavior of paste text on windows.\n\t      }\n\t\n\t      var remoteCompleter = {\n\t        getCompletions: function getCompletions(editor, session, pos, prefix, callback) {\n\t          if (!editor.isFocused()) {\n\t            return;\n\t          }\n\t\n\t          pos = session.getTextRange(new Range(0, 0, pos.row, pos.column)).length;\n\t          var buf = session.getValue();\n\t\n\t          websocketMsgSrv.completion($scope.paragraph.id, buf, pos);\n\t\n\t          $scope.$on('completionList', function (event, data) {\n\t            if (data.completions) {\n\t              var completions = [];\n\t              for (var c in data.completions) {\n\t                var v = data.completions[c];\n\t                completions.push({\n\t                  name: v.name,\n\t                  value: v.value,\n\t                  score: 300\n\t                });\n\t              }\n\t              callback(null, completions);\n\t            }\n\t          });\n\t        }\n\t      };\n\t\n\t      langTools.setCompleters([remoteCompleter, langTools.keyWordCompleter, langTools.snippetCompleter, langTools.textCompleter]);\n\t\n\t      $scope.editor.setOptions({\n\t        enableBasicAutocompletion: true,\n\t        enableSnippets: false,\n\t        enableLiveAutocompletion: false\n\t      });\n\t\n\t      $scope.editor.on('focus', function () {\n\t        handleFocus(true);\n\t      });\n\t\n\t      $scope.editor.on('blur', function () {\n\t        handleFocus(false);\n\t        $scope.saveParagraph($scope.paragraph);\n\t      });\n\t\n\t      $scope.editor.on('paste', function (e) {\n\t        if (e.text.indexOf('%') === 0) {\n\t          pastePercentSign = true;\n\t        }\n\t      });\n\t\n\t      $scope.editor.getSession().on('change', function (e, editSession) {\n\t        autoAdjustEditorHeight(_editor);\n\t      });\n\t\n\t      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n\t\n\t      // autocomplete on '.'\n\t      /*\n\t       $scope.editor.commands.on(\"afterExec\", function(e, t) {\n\t       if (e.command.name == \"insertstring\" && e.args == \".\" ) {\n\t       var all = e.editor.completers;\n\t       //e.editor.completers = [remoteCompleter];\n\t       e.editor.execCommand(\"startAutocomplete\");\n\t       //e.editor.completers = all;\n\t       }\n\t       });\n\t       */\n\t\n\t      // remove binding\n\t      $scope.editor.commands.bindKey('ctrl-alt-n.', null);\n\t      $scope.editor.commands.removeCommand('showSettingsMenu');\n\t\n\t      $scope.editor.commands.bindKey('ctrl-alt-l', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-w', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-a', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-k', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-e', null);\n\t      $scope.editor.commands.bindKey('ctrl-alt-t', null);\n\t\n\t      // autocomplete on 'ctrl+.'\n\t      $scope.editor.commands.bindKey('ctrl-.', 'startAutocomplete');\n\t      $scope.editor.commands.bindKey('ctrl-space', null);\n\t\n\t      var keyBindingEditorFocusAction = function keyBindingEditorFocusAction(scrollValue) {\n\t        var numRows = $scope.editor.getSession().getLength();\n\t        var currentRow = $scope.editor.getCursorPosition().row;\n\t        if (currentRow === 0 && scrollValue <= 0) {\n\t          // move focus to previous paragraph\n\t          $scope.$emit('moveFocusToPreviousParagraph', $scope.paragraph.id);\n\t        } else if (currentRow === numRows - 1 && scrollValue >= 0) {\n\t          $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n\t        } else {\n\t          $scope.scrollToCursor($scope.paragraph.id, scrollValue);\n\t        }\n\t      };\n\t\n\t      // handle cursor moves\n\t      $scope.editor.keyBinding.origOnCommandKey = $scope.editor.keyBinding.onCommandKey;\n\t      $scope.editor.keyBinding.onCommandKey = function (e, hashId, keyCode) {\n\t        if ($scope.editor.completer && $scope.editor.completer.activated) {// if autocompleter is active\n\t        } else {\n\t          // fix ace editor focus issue in chrome (textarea element goes to top: -1000px after focused by cursor move)\n\t          if (parseInt(angular.element('#' + $scope.paragraph.id + '_editor > textarea').css('top').replace('px', '')) < 0) {\n\t            var position = $scope.editor.getCursorPosition();\n\t            var cursorPos = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n\t            angular.element('#' + $scope.paragraph.id + '_editor > textarea').css('top', cursorPos.top);\n\t          }\n\t\n\t          var ROW_UP = -1;\n\t          var ROW_DOWN = 1;\n\t\n\t          switch (keyCode) {\n\t            case 38:\n\t              keyBindingEditorFocusAction(ROW_UP);\n\t              break;\n\t            case 80:\n\t              if (e.ctrlKey && !e.altKey) {\n\t                keyBindingEditorFocusAction(ROW_UP);\n\t              }\n\t              break;\n\t            case 40:\n\t              keyBindingEditorFocusAction(ROW_DOWN);\n\t              break;\n\t            case 78:\n\t              if (e.ctrlKey && !e.altKey) {\n\t                keyBindingEditorFocusAction(ROW_DOWN);\n\t              }\n\t              break;\n\t          }\n\t        }\n\t        this.origOnCommandKey(e, hashId, keyCode);\n\t      };\n\t    }\n\t  };\n\t\n\t  var handleFocus = function handleFocus(value, isDigestPass) {\n\t    $scope.paragraphFocused = value;\n\t    if (isDigestPass === false || isDigestPass === undefined) {\n\t      // Protect against error in case digest is already running\n\t      $timeout(function () {\n\t        // Apply changes since they come from 3rd party library\n\t        $scope.$digest();\n\t      });\n\t    }\n\t  };\n\t\n\t  var getEditorSetting = function getEditorSetting(paragraph, interpreterName) {\n\t    var deferred = $q.defer();\n\t    websocketMsgSrv.getEditorSetting(paragraph.id, interpreterName);\n\t    $timeout($scope.$on('editorSetting', function (event, data) {\n\t      if (paragraph.id === data.paragraphId) {\n\t        deferred.resolve(data);\n\t      }\n\t    }), 1000);\n\t    return deferred.promise;\n\t  };\n\t\n\t  var setEditorLanguage = function setEditorLanguage(session, language) {\n\t    var mode = 'ace/mode/';\n\t    mode += language;\n\t    $scope.paragraph.config.editorMode = mode;\n\t    session.setMode(mode);\n\t  };\n\t\n\t  var setParagraphMode = function setParagraphMode(session, paragraphText, pos) {\n\t    // Evaluate the mode only if the the position is undefined\n\t    // or the first 30 characters of the paragraph have been modified\n\t    // or cursor position is at beginning of second line.(in case user hit enter after typing %magic)\n\t    if (typeof pos === 'undefined' || pos.row === 0 && pos.column < 30 || pos.row === 1 && pos.column === 0 || pastePercentSign) {\n\t      // If paragraph loading, use config value if exists\n\t      if (typeof pos === 'undefined' && $scope.paragraph.config.editorMode && !setInterpreterBindings) {\n\t        session.setMode($scope.paragraph.config.editorMode);\n\t      } else {\n\t        var magic = getInterpreterName(paragraphText);\n\t        if (editorSetting.magic !== magic) {\n\t          editorSetting.magic = magic;\n\t          getEditorSetting($scope.paragraph, magic).then(function (setting) {\n\t            setEditorLanguage(session, setting.editor.language);\n\t            _.merge($scope.paragraph.config.editorSetting, setting.editor);\n\t          });\n\t        }\n\t      }\n\t    }\n\t    pastePercentSign = false;\n\t    setInterpreterBindings = false;\n\t  };\n\t\n\t  var getInterpreterName = function getInterpreterName(paragraphText) {\n\t    var intpNameRegexp = /^\\s*%(.+?)\\s/g;\n\t    var match = intpNameRegexp.exec(paragraphText);\n\t    if (match) {\n\t      return match[1].trim();\n\t      // get default interpreter name if paragraph text doesn't start with '%'\n\t      // TODO(mina): dig into the cause what makes interpreterBindings to have no element\n\t    } else if ($scope.$parent.interpreterBindings && $scope.$parent.interpreterBindings.length !== 0) {\n\t      return $scope.$parent.interpreterBindings[0].name;\n\t    }\n\t    return '';\n\t  };\n\t\n\t  var autoAdjustEditorHeight = function autoAdjustEditorHeight(editor) {\n\t    var height = editor.getSession().getScreenLength() * editor.renderer.lineHeight + editor.renderer.scrollBar.getWidth();\n\t\n\t    angular.element('#' + editor.container.id).height(height.toString() + 'px');\n\t    editor.resize();\n\t  };\n\t\n\t  $rootScope.$on('scrollToCursor', function (event) {\n\t    // scroll on 'scrollToCursor' event only when cursor is in the last paragraph\n\t    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n\t    if (paragraphs[paragraphs.length - 1].id.indexOf($scope.paragraph.id) === 0) {\n\t      $scope.scrollToCursor($scope.paragraph.id, 0);\n\t    }\n\t  });\n\t\n\t  /** scrollToCursor if it is necessary\n\t   * when cursor touches scrollTriggerEdgeMargin from the top (or bottom) of the screen, it autoscroll to place cursor around 1/3 of screen height from the top (or bottom)\n\t   * paragraphId : paragraph that has active cursor\n\t   * lastCursorMove : 1(down), 0, -1(up) last cursor move event\n\t   **/\n\t  $scope.scrollToCursor = function (paragraphId, lastCursorMove) {\n\t    if (!$scope.editor || !$scope.editor.isFocused()) {\n\t      // only make sense when editor is focused\n\t      return;\n\t    }\n\t    var lineHeight = $scope.editor.renderer.lineHeight;\n\t    var headerHeight = 103; // menubar, notebook titlebar\n\t    var scrollTriggerEdgeMargin = 50;\n\t\n\t    var documentHeight = angular.element(document).height();\n\t    var windowHeight = angular.element(window).height(); // actual viewport height\n\t\n\t    var scrollPosition = angular.element(document).scrollTop();\n\t    var editorPosition = angular.element('#' + paragraphId + '_editor').offset();\n\t    var position = $scope.editor.getCursorPosition();\n\t    var lastCursorPosition = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n\t\n\t    var calculatedCursorPosition = editorPosition.top + lastCursorPosition.top + lineHeight * lastCursorMove;\n\t\n\t    var scrollTargetPos;\n\t    if (calculatedCursorPosition < scrollPosition + headerHeight + scrollTriggerEdgeMargin) {\n\t      scrollTargetPos = calculatedCursorPosition - headerHeight - (windowHeight - headerHeight) / 3;\n\t      if (scrollTargetPos < 0) {\n\t        scrollTargetPos = 0;\n\t      }\n\t    } else if (calculatedCursorPosition > scrollPosition + scrollTriggerEdgeMargin + windowHeight - headerHeight) {\n\t      scrollTargetPos = calculatedCursorPosition - headerHeight - (windowHeight - headerHeight) * 2 / 3;\n\t\n\t      if (scrollTargetPos > documentHeight) {\n\t        scrollTargetPos = documentHeight;\n\t      }\n\t    }\n\t\n\t    // cancel previous scroll animation\n\t    var bodyEl = angular.element('body');\n\t    bodyEl.stop();\n\t    bodyEl.finish();\n\t\n\t    // scroll to scrollTargetPos\n\t    bodyEl.scrollTo(scrollTargetPos, { axis: 'y', interrupt: true, duration: 100 });\n\t  };\n\t\n\t  $scope.getEditorValue = function () {\n\t    return !$scope.editor ? $scope.paragraph.text : $scope.editor.getValue();\n\t  };\n\t\n\t  $scope.getProgress = function () {\n\t    return $scope.currentProgress || 0;\n\t  };\n\t\n\t  $scope.getExecutionTime = function (pdata) {\n\t    var timeMs = Date.parse(pdata.dateFinished) - Date.parse(pdata.dateStarted);\n\t    if (isNaN(timeMs) || timeMs < 0) {\n\t      if ($scope.isResultOutdated(pdata)) {\n\t        return 'outdated';\n\t      }\n\t      return '';\n\t    }\n\t    var user = pdata.user === undefined || pdata.user === null ? 'anonymous' : pdata.user;\n\t    var desc = 'Took ' + moment.duration(timeMs / 1000, 'seconds').format('h [hrs] m [min] s [sec]') + '. Last updated by ' + user + ' at ' + moment(pdata.dateFinished).format('MMMM DD YYYY, h:mm:ss A') + '.';\n\t    if ($scope.isResultOutdated(pdata)) {\n\t      desc += ' (outdated)';\n\t    }\n\t    return desc;\n\t  };\n\t\n\t  $scope.getElapsedTime = function (paragraph) {\n\t    return 'Started ' + moment(paragraph.dateStarted).fromNow() + '.';\n\t  };\n\t\n\t  $scope.isResultOutdated = function (pdata) {\n\t    if (pdata.dateUpdated !== undefined && Date.parse(pdata.dateUpdated) > Date.parse(pdata.dateStarted)) {\n\t      return true;\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.goToEnd = function (editor) {\n\t    editor.navigateFileEnd();\n\t  };\n\t\n\t  $scope.getResultType = function (paragraph) {\n\t    var pdata = paragraph ? paragraph : $scope.paragraph;\n\t    if (pdata.results && pdata.results.type) {\n\t      return pdata.results.type;\n\t    } else {\n\t      return 'TEXT';\n\t    }\n\t  };\n\t\n\t  $scope.parseTableCell = function (cell) {\n\t    if (!isNaN(cell)) {\n\t      if (cell.length === 0 || Number(cell) > Number.MAX_SAFE_INTEGER || Number(cell) < Number.MIN_SAFE_INTEGER) {\n\t        return cell;\n\t      } else {\n\t        return Number(cell);\n\t      }\n\t    }\n\t    var d = moment(cell);\n\t    if (d.isValid()) {\n\t      return d;\n\t    }\n\t    return cell;\n\t  };\n\t\n\t  var commitParagraph = function commitParagraph(paragraph) {\n\t    var id = paragraph.id,\n\t        title = paragraph.title,\n\t        text = paragraph.text,\n\t        config = paragraph.config,\n\t        params = paragraph.settings.params;\n\t\n\t\n\t    websocketMsgSrv.commitParagraph(id, title, text, config, params);\n\t  };\n\t\n\t  /** Utility function */\n\t  $scope.goToSingleParagraph = function () {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    var redirectToUrl = location.protocol + '//' + location.host + location.pathname + '#/notebook/' + noteId + '/paragraph/' + $scope.paragraph.id + '?asIframe';\n\t    $window.open(redirectToUrl);\n\t  };\n\t\n\t  $scope.showScrollDownIcon = function (id) {\n\t    var doc = angular.element('#p' + id + '_text');\n\t    if (doc[0]) {\n\t      return doc[0].scrollHeight > doc.innerHeight();\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.scrollParagraphDown = function (id) {\n\t    var doc = angular.element('#p' + id + '_text');\n\t    doc.animate({ scrollTop: doc[0].scrollHeight }, 500);\n\t    $scope.keepScrollDown = true;\n\t  };\n\t\n\t  $scope.showScrollUpIcon = function (id) {\n\t    if (angular.element('#p' + id + '_text')[0]) {\n\t      return angular.element('#p' + id + '_text')[0].scrollTop !== 0;\n\t    }\n\t    return false;\n\t  };\n\t\n\t  $scope.scrollParagraphUp = function (id) {\n\t    var doc = angular.element('#p' + id + '_text');\n\t    doc.animate({ scrollTop: 0 }, 500);\n\t    $scope.keepScrollDown = false;\n\t  };\n\t\n\t  $scope.$on('angularObjectUpdate', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n\t        scope = paragraphScope;\n\t        registry = angularObjectRegistry;\n\t      } else {\n\t        return;\n\t      }\n\t      var varName = data.angularObject.name;\n\t\n\t      if (angular.equals(data.angularObject.object, scope[varName])) {\n\t        // return when update has no change\n\t        return;\n\t      }\n\t\n\t      if (!registry[varName]) {\n\t        registry[varName] = {\n\t          interpreterGroupId: data.interpreterGroupId,\n\t          noteId: data.noteId,\n\t          paragraphId: data.paragraphId\n\t        };\n\t      } else {\n\t        registry[varName].noteId = registry[varName].noteId || data.noteId;\n\t        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n\t      }\n\t\n\t      registry[varName].skipEmit = true;\n\t\n\t      if (!registry[varName].clearWatcher) {\n\t        registry[varName].clearWatcher = scope.$watch(varName, function (newValue, oldValue) {\n\t          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n\t          if (registry[varName].skipEmit) {\n\t            registry[varName].skipEmit = false;\n\t            return;\n\t          }\n\t          websocketMsgSrv.updateAngularObject(registry[varName].noteId, registry[varName].paragraphId, varName, newValue, registry[varName].interpreterGroupId);\n\t        });\n\t      }\n\t      console.log('angular object (paragraph) created %o', varName);\n\t      scope[varName] = data.angularObject.object;\n\t\n\t      // create proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = function () {\n\t          scope[varName] = arguments;\n\t          console.log('angular function (paragraph) invoked %o', arguments);\n\t        };\n\t\n\t        console.log('angular function (paragraph) created %o', scope[funcName]);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('angularObjectRemove', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n\t        scope = paragraphScope;\n\t        registry = angularObjectRegistry;\n\t      } else {\n\t        return;\n\t      }\n\t\n\t      var varName = data.name;\n\t\n\t      // clear watcher\n\t      if (registry[varName]) {\n\t        registry[varName].clearWatcher();\n\t        registry[varName] = undefined;\n\t      }\n\t\n\t      // remove scope variable\n\t      scope[varName] = undefined;\n\t\n\t      // remove proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = undefined;\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateParagraph', function (event, data) {\n\t    if (data.paragraph.id === $scope.paragraph.id && (data.paragraph.dateCreated !== $scope.paragraph.dateCreated || data.paragraph.text !== $scope.paragraph.text || data.paragraph.dateFinished !== $scope.paragraph.dateFinished || data.paragraph.dateStarted !== $scope.paragraph.dateStarted || data.paragraph.dateUpdated !== $scope.paragraph.dateUpdated || data.paragraph.status !== $scope.paragraph.status || data.paragraph.jobName !== $scope.paragraph.jobName || data.paragraph.title !== $scope.paragraph.title || isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) || data.paragraph.errorMessage !== $scope.paragraph.errorMessage || !angular.equals(data.paragraph.settings, $scope.paragraph.settings) || !angular.equals(data.paragraph.config, $scope.paragraph.config))) {\n\t      var statusChanged = data.paragraph.status !== $scope.paragraph.status;\n\t      var resultRefreshed = data.paragraph.dateFinished !== $scope.paragraph.dateFinished || isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) || data.paragraph.status === 'ERROR' || data.paragraph.status === 'FINISHED' && statusChanged;\n\t\n\t      if ($scope.paragraph.text !== data.paragraph.text) {\n\t        if ($scope.dirtyText) {\n\t          // check if editor has local update\n\t          if ($scope.dirtyText === data.paragraph.text) {\n\t            // when local update is the same from remote, clear local update\n\t            $scope.paragraph.text = data.paragraph.text;\n\t            $scope.dirtyText = undefined;\n\t            $scope.originalText = angular.copy(data.paragraph.text);\n\t          } else {\n\t            // if there're local update, keep it.\n\t            $scope.paragraph.text = data.paragraph.text;\n\t          }\n\t        } else {\n\t          $scope.paragraph.text = data.paragraph.text;\n\t          $scope.originalText = angular.copy(data.paragraph.text);\n\t        }\n\t      }\n\t\n\t      /** broadcast update to result controller **/\n\t      if (data.paragraph.results && data.paragraph.results.msg) {\n\t        for (var i in data.paragraph.results.msg) {\n\t          var newResult = data.paragraph.results.msg ? data.paragraph.results.msg[i] : {};\n\t          var oldResult = $scope.paragraph.results && $scope.paragraph.results.msg ? $scope.paragraph.results.msg[i] : {};\n\t          var newConfig = data.paragraph.config.results ? data.paragraph.config.results[i] : {};\n\t          var oldConfig = $scope.paragraph.config.results ? $scope.paragraph.config.results[i] : {};\n\t          if (!angular.equals(newResult, oldResult) || !angular.equals(newConfig, oldConfig)) {\n\t            $rootScope.$broadcast('updateResult', newResult, newConfig, data.paragraph, parseInt(i));\n\t          }\n\t        }\n\t      }\n\t\n\t      // resize col width\n\t      if ($scope.paragraph.config.colWidth !== data.paragraph.colWidth) {\n\t        $rootScope.$broadcast('paragraphResized', $scope.paragraph.id);\n\t      }\n\t\n\t      /** push the rest */\n\t      $scope.paragraph.aborted = data.paragraph.aborted;\n\t      $scope.paragraph.user = data.paragraph.user;\n\t      $scope.paragraph.dateUpdated = data.paragraph.dateUpdated;\n\t      $scope.paragraph.dateCreated = data.paragraph.dateCreated;\n\t      $scope.paragraph.dateFinished = data.paragraph.dateFinished;\n\t      $scope.paragraph.dateStarted = data.paragraph.dateStarted;\n\t      $scope.paragraph.errorMessage = data.paragraph.errorMessage;\n\t      $scope.paragraph.jobName = data.paragraph.jobName;\n\t      $scope.paragraph.title = data.paragraph.title;\n\t      $scope.paragraph.lineNumbers = data.paragraph.lineNumbers;\n\t      $scope.paragraph.status = data.paragraph.status;\n\t      if (data.paragraph.status !== 'RUNNING') {\n\t        $scope.paragraph.results = data.paragraph.results;\n\t      }\n\t      $scope.paragraph.settings = data.paragraph.settings;\n\t      if ($scope.editor) {\n\t        $scope.editor.setReadOnly($scope.isRunning(data.paragraph));\n\t      }\n\t\n\t      if (!$scope.asIframe) {\n\t        $scope.paragraph.config = data.paragraph.config;\n\t        initializeDefault(data.paragraph.config);\n\t      } else {\n\t        data.paragraph.config.editorHide = true;\n\t        data.paragraph.config.tableHide = false;\n\t        $scope.paragraph.config = data.paragraph.config;\n\t      }\n\t\n\t      if (statusChanged || resultRefreshed) {\n\t        // when last paragraph runs, zeppelin automatically appends new paragraph.\n\t        // this broadcast will focus to the newly inserted paragraph\n\t        var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n\t        if (paragraphs.length >= 2 && paragraphs[paragraphs.length - 2].id.indexOf($scope.paragraph.id) === 0) {\n\t          // rendering output can took some time. So delay scrolling event firing for sometime.\n\t          setTimeout(function () {\n\t            $rootScope.$broadcast('scrollToCursor');\n\t          }, 500);\n\t        }\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateProgress', function (event, data) {\n\t    if (data.id === $scope.paragraph.id) {\n\t      $scope.currentProgress = data.progress;\n\t    }\n\t  });\n\t\n\t  $scope.$on('keyEvent', function (event, keyEvent) {\n\t    if ($scope.paragraphFocused) {\n\t\n\t      var paragraphId = $scope.paragraph.id;\n\t      var keyCode = keyEvent.keyCode;\n\t      var noShortcutDefined = false;\n\t      var editorHide = $scope.paragraph.config.editorHide;\n\t\n\t      if (editorHide && (keyCode === 38 || keyCode === 80 && keyEvent.ctrlKey && !keyEvent.altKey)) {\n\t        // up\n\t        // move focus to previous paragraph\n\t        $scope.$emit('moveFocusToPreviousParagraph', paragraphId);\n\t      } else if (editorHide && (keyCode === 40 || keyCode === 78 && keyEvent.ctrlKey && !keyEvent.altKey)) {\n\t        // down\n\t        // move focus to next paragraph\n\t        // $timeout stops chaining effect of focus propogation\n\t        $timeout(function () {\n\t          return $scope.$emit('moveFocusToNextParagraph', paragraphId);\n\t        });\n\t      } else if (keyEvent.shiftKey && keyCode === 13) {\n\t        // Shift + Enter\n\t        $scope.run($scope.paragraph, $scope.getEditorValue());\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 67) {\n\t        // Ctrl + Alt + c\n\t        $scope.cancelParagraph($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 68) {\n\t        // Ctrl + Alt + d\n\t        $scope.removeParagraph($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 75) {\n\t        // Ctrl + Alt + k\n\t        $scope.moveUp($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 74) {\n\t        // Ctrl + Alt + j\n\t        $scope.moveDown($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 65) {\n\t        // Ctrl + Alt + a\n\t        $scope.insertNew('above');\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 66) {\n\t        // Ctrl + Alt + b\n\t        $scope.insertNew('below');\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 79) {\n\t        // Ctrl + Alt + o\n\t        $scope.toggleOutput($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 82) {\n\t        // Ctrl + Alt + r\n\t        $scope.toggleEnableDisable($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 69) {\n\t        // Ctrl + Alt + e\n\t        $scope.toggleEditor($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 77) {\n\t        // Ctrl + Alt + m\n\t        if ($scope.paragraph.config.lineNumbers) {\n\t          $scope.hideLineNumbers($scope.paragraph);\n\t        } else {\n\t          $scope.showLineNumbers($scope.paragraph);\n\t        }\n\t      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 189) {\n\t        // Ctrl + Shift + -\n\t        $scope.changeColWidth($scope.paragraph, Math.max(1, $scope.paragraph.config.colWidth - 1));\n\t      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 187) {\n\t        // Ctrl + Shift + =\n\t        $scope.changeColWidth($scope.paragraph, Math.min(12, $scope.paragraph.config.colWidth + 1));\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 84) {\n\t        // Ctrl + Alt + t\n\t        if ($scope.paragraph.config.title) {\n\t          $scope.hideTitle($scope.paragraph);\n\t        } else {\n\t          $scope.showTitle($scope.paragraph);\n\t        }\n\t      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 67) {\n\t        // Ctrl + Alt + c\n\t        $scope.copyPara('below');\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 76) {\n\t        // Ctrl + Alt + l\n\t        $scope.clearParagraphOutput($scope.paragraph);\n\t      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 87) {\n\t        // Ctrl + Alt + w\n\t        $scope.goToSingleParagraph();\n\t      } else {\n\t        noShortcutDefined = true;\n\t      }\n\t\n\t      if (!noShortcutDefined) {\n\t        keyEvent.preventDefault();\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('focusParagraph', function (event, paragraphId, cursorPos, mouseEvent) {\n\t    if ($scope.paragraph.id === paragraphId) {\n\t      // focus editor\n\t      if (!$scope.paragraph.config.editorHide) {\n\t        if (!mouseEvent) {\n\t          $scope.editor.focus();\n\t          // move cursor to the first row (or the last row)\n\t          var row;\n\t          if (cursorPos >= 0) {\n\t            row = cursorPos;\n\t            $scope.editor.gotoLine(row, 0);\n\t          } else {\n\t            row = $scope.editor.session.getLength();\n\t            $scope.editor.gotoLine(row, 0);\n\t          }\n\t          $scope.scrollToCursor($scope.paragraph.id, 0);\n\t        }\n\t      }\n\t      handleFocus(true);\n\t    } else {\n\t      if ($scope.editor !== undefined && $scope.editor !== null) {\n\t        $scope.editor.blur();\n\t      }\n\t      var isDigestPass = true;\n\t      handleFocus(false, isDigestPass);\n\t    }\n\t  });\n\t\n\t  $scope.$on('saveInterpreterBindings', function (event, paragraphId) {\n\t    if ($scope.paragraph.id === paragraphId && $scope.editor) {\n\t      setInterpreterBindings = true;\n\t      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n\t    }\n\t  });\n\t\n\t  $scope.$on('doubleClickParagraph', function (event, paragraphId) {\n\t    if ($scope.paragraph.id === paragraphId && $scope.paragraph.config.editorHide && $scope.paragraph.config.editorSetting.editOnDblClick && $scope.revisionView !== true) {\n\t      var deferred = $q.defer();\n\t      openEditorAndCloseTable($scope.paragraph);\n\t      $timeout($scope.$on('updateParagraph', function (event, data) {\n\t        deferred.resolve(data);\n\t      }), 1000);\n\t\n\t      deferred.promise.then(function (data) {\n\t        if ($scope.editor) {\n\t          $scope.editor.focus();\n\t          $scope.goToEnd($scope.editor);\n\t        }\n\t      });\n\t    }\n\t  });\n\t\n\t  $scope.$on('openEditor', function (event) {\n\t    $scope.openEditor($scope.paragraph);\n\t  });\n\t\n\t  $scope.$on('closeEditor', function (event) {\n\t    $scope.closeEditor($scope.paragraph);\n\t  });\n\t\n\t  $scope.$on('openTable', function (event) {\n\t    $scope.openTable($scope.paragraph);\n\t  });\n\t\n\t  $scope.$on('closeTable', function (event) {\n\t    $scope.closeTable($scope.paragraph);\n\t  });\n\t}\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _tabledata = __webpack_require__(6);\n\t\n\tvar _tabledata2 = _interopRequireDefault(_tabledata);\n\t\n\tvar _visualizationTable = __webpack_require__(12);\n\t\n\tvar _visualizationTable2 = _interopRequireDefault(_visualizationTable);\n\t\n\tvar _visualizationBarchart = __webpack_require__(14);\n\t\n\tvar _visualizationBarchart2 = _interopRequireDefault(_visualizationBarchart);\n\t\n\tvar _visualizationPiechart = __webpack_require__(15);\n\t\n\tvar _visualizationPiechart2 = _interopRequireDefault(_visualizationPiechart);\n\t\n\tvar _visualizationAreachart = __webpack_require__(16);\n\t\n\tvar _visualizationAreachart2 = _interopRequireDefault(_visualizationAreachart);\n\t\n\tvar _visualizationLinechart = __webpack_require__(17);\n\t\n\tvar _visualizationLinechart2 = _interopRequireDefault(_visualizationLinechart);\n\t\n\tvar _visualizationScatterchart = __webpack_require__(18);\n\t\n\tvar _visualizationScatterchart2 = _interopRequireDefault(_visualizationScatterchart);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tangular.module('zeppelinWebApp').controller('ResultCtrl', ResultCtrl); /*\n\t                                                                        * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t                                                                        * you may not use this file except in compliance with the License.\n\t                                                                        * You may obtain a copy of the License at\n\t                                                                        *\n\t                                                                        *     http://www.apache.org/licenses/LICENSE-2.0\n\t                                                                        *\n\t                                                                        * Unless required by applicable law or agreed to in writing, software\n\t                                                                        * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t                                                                        * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t                                                                        * See the License for the specific language governing permissions and\n\t                                                                        * limitations under the License.\n\t                                                                        */\n\t\n\tResultCtrl.$inject = ['$scope', '$rootScope', '$route', '$window', '$routeParams', '$location', '$timeout', '$compile', '$http', '$q', '$templateRequest', '$sce', 'websocketMsgSrv', 'baseUrlSrv', 'ngToast', 'saveAsService', 'noteVarShareService', 'heliumService'];\n\t\n\tfunction ResultCtrl($scope, $rootScope, $route, $window, $routeParams, $location, $timeout, $compile, $http, $q, $templateRequest, $sce, websocketMsgSrv, baseUrlSrv, ngToast, saveAsService, noteVarShareService, heliumService) {\n\t\n\t  /**\n\t   * Built-in visualizations\n\t   */\n\t  $scope.builtInTableDataVisualizationList = [{\n\t    id: 'table', // paragraph.config.graph.mode\n\t    name: 'Table', // human readable name. tooltip\n\t    icon: '<i class=\"fa fa-table\"></i>'\n\t  }, {\n\t    id: 'multiBarChart',\n\t    name: 'Bar Chart',\n\t    icon: '<i class=\"fa fa-bar-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'pieChart',\n\t    name: 'Pie Chart',\n\t    icon: '<i class=\"fa fa-pie-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'stackedAreaChart',\n\t    name: 'Area Chart',\n\t    icon: '<i class=\"fa fa-area-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'lineChart',\n\t    name: 'Line Chart',\n\t    icon: '<i class=\"fa fa-line-chart\"></i>',\n\t    transformation: 'pivot'\n\t  }, {\n\t    id: 'scatterChart',\n\t    name: 'Scatter Chart',\n\t    icon: '<i class=\"cf cf-scatter-chart\"></i>'\n\t  }];\n\t\n\t  /**\n\t   * Holds class and actual runtime instance and related infos of built-in visualizations\n\t   */\n\t  var builtInVisualizations = {\n\t    'table': {\n\t      class: _visualizationTable2.default,\n\t      instance: undefined // created from setGraphMode()\n\t    },\n\t    'multiBarChart': {\n\t      class: _visualizationBarchart2.default,\n\t      instance: undefined\n\t    },\n\t    'pieChart': {\n\t      class: _visualizationPiechart2.default,\n\t      instance: undefined\n\t    },\n\t    'stackedAreaChart': {\n\t      class: _visualizationAreachart2.default,\n\t      instance: undefined\n\t    },\n\t    'lineChart': {\n\t      class: _visualizationLinechart2.default,\n\t      instance: undefined\n\t    },\n\t    'scatterChart': {\n\t      class: _visualizationScatterchart2.default,\n\t      instance: undefined\n\t    }\n\t  };\n\t\n\t  // type\n\t  $scope.type;\n\t\n\t  // Data of the result\n\t  var data;\n\t\n\t  // config\n\t  $scope.config;\n\t\n\t  // resultId = paragraph.id + index\n\t  $scope.id;\n\t\n\t  // referece to paragraph\n\t  var paragraph;\n\t\n\t  // index of the result\n\t  var resultIndex;\n\t\n\t  // TableData instance\n\t  var tableData;\n\t\n\t  // available columns in tabledata\n\t  $scope.tableDataColumns = [];\n\t\n\t  // enable helium\n\t  var enableHelium = false;\n\t\n\t  // graphMode\n\t  $scope.graphMode;\n\t\n\t  // image data\n\t  $scope.imageData;\n\t\n\t  $scope.init = function (result, config, paragraph, index) {\n\t    console.log('result controller init %o %o %o', result, config, index);\n\t\n\t    // register helium plugin vis\n\t    var heliumVis = heliumService.get();\n\t    console.log('Helium visualizations %o', heliumVis);\n\t    heliumVis.forEach(function (vis) {\n\t      $scope.builtInTableDataVisualizationList.push({\n\t        id: vis.id,\n\t        name: vis.name,\n\t        icon: $sce.trustAsHtml(vis.icon)\n\t      });\n\t      builtInVisualizations[vis.id] = {\n\t        class: vis.class\n\t      };\n\t    });\n\t\n\t    updateData(result, config, paragraph, index);\n\t    renderResult($scope.type);\n\t  };\n\t\n\t  $scope.$on('updateResult', function (event, result, newConfig, paragraphRef, index) {\n\t    if (paragraph.id !== paragraphRef.id || index !== resultIndex) {\n\t      return;\n\t    }\n\t    console.log('updateResult %o %o %o %o', result, newConfig, paragraphRef, index);\n\t    var refresh = !angular.equals(newConfig, $scope.config) || !angular.equals(result.type, $scope.type) || !angular.equals(result.data, data);\n\t\n\t    updateData(result, newConfig, paragraph, resultIndex);\n\t    renderResult($scope.type, refresh);\n\t  });\n\t\n\t  $scope.$on('appendParagraphOutput', function (event, data) {\n\t    /* It has been observed that append events\n\t     * can be errorneously called even if paragraph\n\t     * execution has ended, and in that case, no append\n\t     * should be made. Also, it was observed that between PENDING\n\t     * and RUNNING states, append-events can be called and we can't\n\t     * miss those, else during the length of paragraph run, few\n\t     * initial output line/s will be missing.\n\t     */\n\t    if (paragraph.id === data.paragraphId && resultIndex === data.index && (paragraph.status === 'RUNNING' || paragraph.status === 'PENDING')) {\n\t      appendTextOutput(data.data);\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateParagraphOutput', function (event, data) {\n\t    if (paragraph.id === data.paragraphId && resultIndex === data.index) {\n\t      clearTextOutput();\n\t      appendTextOutput(data.data);\n\t    }\n\t  });\n\t\n\t  var updateData = function updateData(result, config, paragraphRef, index) {\n\t    data = result.data;\n\t    paragraph = paragraphRef;\n\t    resultIndex = parseInt(index);\n\t\n\t    $scope.id = paragraph.id + '_' + index;\n\t    $scope.type = result.type;\n\t    config = config ? config : {};\n\t\n\t    // initialize default config values\n\t    if (!config.graph) {\n\t      config.graph = {};\n\t    }\n\t\n\t    if (!config.graph.mode) {\n\t      config.graph.mode = 'table';\n\t    }\n\t\n\t    if (!config.graph.height) {\n\t      config.graph.height = 300;\n\t    }\n\t\n\t    if (!config.graph.optionOpen) {\n\t      config.graph.optionOpen = false;\n\t    }\n\t\n\t    $scope.graphMode = config.graph.mode;\n\t    $scope.config = angular.copy(config);\n\t\n\t    // enable only when it is last result\n\t    enableHelium = index === paragraphRef.results.msg.length - 1;\n\t\n\t    if ($scope.type === 'TABLE') {\n\t      tableData = new _tabledata2.default();\n\t      tableData.loadParagraphResult({ type: $scope.type, msg: data });\n\t      $scope.tableDataColumns = tableData.columns;\n\t      $scope.tableDataComment = tableData.comment;\n\t    } else if ($scope.type === 'IMG') {\n\t      $scope.imageData = data;\n\t    }\n\t  };\n\t\n\t  var renderResult = function renderResult(type, refresh) {\n\t    var activeApp;\n\t    if (enableHelium) {\n\t      getSuggestions();\n\t      getApplicationStates();\n\t      activeApp = _.get($scope.config, 'helium.activeApp');\n\t    }\n\t\n\t    if (activeApp) {\n\t      var app = _.find($scope.apps, { id: activeApp });\n\t      renderApp(app);\n\t    } else {\n\t      if (type === 'TABLE') {\n\t        var retryRenderer = function retryRenderer() {\n\t          var elem = angular.element('#p' + $scope.id + '_graph');\n\t          if (elem.length) {\n\t            $scope.renderGraph($scope.graphMode, refresh);\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      } else if (type === 'HTML') {\n\t        renderHtml();\n\t      } else if (type === 'ANGULAR') {\n\t        renderAngular();\n\t      } else if (type === 'TEXT') {\n\t        renderText();\n\t      }\n\t    }\n\t  };\n\t\n\t  var renderHtml = function renderHtml() {\n\t    var retryRenderer = function retryRenderer() {\n\t      var htmlEl = angular.element('#p' + $scope.id + '_html');\n\t      if (htmlEl.length) {\n\t        try {\n\t          htmlEl.html(data);\n\t\n\t          htmlEl.find('pre code').each(function (i, e) {\n\t            hljs.highlightBlock(e);\n\t          });\n\t          /*eslint new-cap: [2, {\"capIsNewExceptions\": [\"MathJax.Hub.Queue\"]}]*/\n\t          MathJax.Hub.Queue(['Typeset', MathJax.Hub, htmlEl[0]]);\n\t        } catch (err) {\n\t          console.log('HTML rendering error %o', err);\n\t        }\n\t      } else {\n\t        $timeout(retryRenderer, 10);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  var renderAngular = function renderAngular() {\n\t    var retryRenderer = function retryRenderer() {\n\t      if (angular.element('#p' + $scope.id + '_angular').length) {\n\t        try {\n\t          angular.element('#p' + $scope.id + '_angular').html(data);\n\t\n\t          var paragraphScope = noteVarShareService.get(paragraph.id + '_paragraphScope');\n\t          $compile(angular.element('#p' + $scope.id + '_angular').contents())(paragraphScope);\n\t        } catch (err) {\n\t          console.log('ANGULAR rendering error %o', err);\n\t        }\n\t      } else {\n\t        $timeout(retryRenderer, 10);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  var getTextEl = function getTextEl(paragraphId) {\n\t    return angular.element('#p' + $scope.id + '_text');\n\t  };\n\t\n\t  var textRendererInitialized = false;\n\t  var renderText = function renderText() {\n\t    var retryRenderer = function retryRenderer() {\n\t      var textEl = getTextEl($scope.id);\n\t      if (textEl.length) {\n\t        // clear all lines before render\n\t        clearTextOutput();\n\t        textRendererInitialized = true;\n\t\n\t        if (data) {\n\t          appendTextOutput(data);\n\t        } else {\n\t          flushAppendQueue();\n\t        }\n\t\n\t        getTextEl($scope.id).bind('mousewheel', function (e) {\n\t          $scope.keepScrollDown = false;\n\t        });\n\t      } else {\n\t        $timeout(retryRenderer, 10);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  var clearTextOutput = function clearTextOutput() {\n\t    var textEl = getTextEl($scope.id);\n\t    if (textEl.length) {\n\t      textEl.children().remove();\n\t    }\n\t  };\n\t\n\t  var textAppendQueueBeforeInitialize = [];\n\t\n\t  var flushAppendQueue = function flushAppendQueue() {\n\t    while (textAppendQueueBeforeInitialize.length > 0) {\n\t      appendTextOutput(textAppendQueueBeforeInitialize.pop());\n\t    }\n\t  };\n\t\n\t  var appendTextOutput = function appendTextOutput(msg) {\n\t    if (!textRendererInitialized) {\n\t      textAppendQueueBeforeInitialize.push(msg);\n\t    } else {\n\t      flushAppendQueue();\n\t      var textEl = getTextEl($scope.id);\n\t      if (textEl.length) {\n\t        var lines = msg.split('\\n');\n\t        for (var i = 0; i < lines.length; i++) {\n\t          textEl.append(angular.element('<div></div>').text(lines[i]));\n\t        }\n\t      }\n\t      if ($scope.keepScrollDown) {\n\t        var doc = getTextEl($scope.id);\n\t        doc[0].scrollTop = doc[0].scrollHeight;\n\t      }\n\t    }\n\t  };\n\t\n\t  $scope.renderGraph = function (type, refresh) {\n\t    // set graph height\n\t    var height = $scope.config.graph.height;\n\t    var graphContainerEl = angular.element('#p' + $scope.id + '_graph');\n\t    graphContainerEl.height(height);\n\t\n\t    if (!type) {\n\t      type = 'table';\n\t    }\n\t\n\t    var builtInViz = builtInVisualizations[type];\n\t    if (builtInViz) {\n\t      // deactive previsouly active visualization\n\t      for (var t in builtInVisualizations) {\n\t        var v = builtInVisualizations[t].instance;\n\t\n\t        if (t !== type && v && v.isActive()) {\n\t          v.deactivate();\n\t          break;\n\t        }\n\t      }\n\t\n\t      if (!builtInViz.instance) {\n\t        // not instantiated yet\n\t        // render when targetEl is available\n\t        var retryRenderer = function retryRenderer() {\n\t          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n\t          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n\t          var visualizationSettingTargetEl = angular.element('#vizsetting' + $scope.id + '_' + type);\n\t          if (targetEl.length) {\n\t            try {\n\t              // set height\n\t              targetEl.height(height);\n\t\n\t              // instantiate visualization\n\t              var config = getVizConfig(type);\n\t              var Visualization = builtInViz.class;\n\t              builtInViz.instance = new Visualization(targetEl, config);\n\t\n\t              // inject emitter, $templateRequest\n\t              var emitter = function emitter(graphSetting) {\n\t                commitVizConfigChange(graphSetting, type);\n\t              };\n\t              builtInViz.instance._emitter = emitter;\n\t              builtInViz.instance._compile = $compile;\n\t              builtInViz.instance._createNewScope = createNewScope;\n\t              var transformation = builtInViz.instance.getTransformation();\n\t              transformation._emitter = emitter;\n\t              transformation._templateRequest = $templateRequest;\n\t              transformation._compile = $compile;\n\t              transformation._createNewScope = createNewScope;\n\t\n\t              // render\n\t              var transformed = transformation.transform(tableData);\n\t              transformation.renderSetting(transformationSettingTargetEl);\n\t              builtInViz.instance.render(transformed);\n\t              builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n\t              builtInViz.instance.activate();\n\t              angular.element(window).resize(function () {\n\t                builtInViz.instance.resize();\n\t              });\n\t            } catch (err) {\n\t              console.error('Graph drawing error %o', err);\n\t            }\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      } else if (refresh) {\n\t        console.log('Refresh data %o', tableData);\n\t        // when graph options or data are changed\n\t        var retryRenderer = function retryRenderer() {\n\t          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n\t          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n\t          var visualizationSettingTargetEl = angular.element('#vizsetting' + $scope.id + '_' + type);\n\t          if (targetEl.length) {\n\t            var config = getVizConfig(type);\n\t            targetEl.height(height);\n\t            var transformation = builtInViz.instance.getTransformation();\n\t            transformation.setConfig(config);\n\t            var transformed = transformation.transform(tableData);\n\t            transformation.renderSetting(transformationSettingTargetEl);\n\t            builtInViz.instance.setConfig(config);\n\t            builtInViz.instance.render(transformed);\n\t            builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      } else {\n\t        var retryRenderer = function retryRenderer() {\n\t          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n\t          if (targetEl.length) {\n\t            targetEl.height(height);\n\t            builtInViz.instance.activate();\n\t          } else {\n\t            $timeout(retryRenderer, 10);\n\t          }\n\t        };\n\t        $timeout(retryRenderer);\n\t      }\n\t    }\n\t  };\n\t  $scope.switchViz = function (newMode) {\n\t    var newConfig = angular.copy($scope.config);\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t\n\t    // graph options\n\t    newConfig.graph.mode = newMode;\n\t\n\t    // see switchApp()\n\t    _.set(newConfig, 'helium.activeApp', undefined);\n\t\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  var createNewScope = function createNewScope() {\n\t    return $rootScope.$new(true);\n\t  };\n\t\n\t  var commitParagraphResult = function commitParagraphResult(title, text, config, params) {\n\t    var newParagraphConfig = angular.copy(paragraph.config);\n\t    newParagraphConfig.results = newParagraphConfig.results || [];\n\t    newParagraphConfig.results[resultIndex] = config;\n\t    if ($scope.revisionView === true) {\n\t      // local update without commit\n\t      updateData({\n\t        type: $scope.type,\n\t        data: data\n\t      }, newParagraphConfig.results[resultIndex], paragraph, resultIndex);\n\t      renderResult($scope.type, true);\n\t    } else {\n\t      websocketMsgSrv.commitParagraph(paragraph.id, title, text, newParagraphConfig, params);\n\t    }\n\t  };\n\t\n\t  $scope.toggleGraphSetting = function () {\n\t    var newConfig = angular.copy($scope.config);\n\t    if (newConfig.graph.optionOpen) {\n\t      newConfig.graph.optionOpen = false;\n\t    } else {\n\t      newConfig.graph.optionOpen = true;\n\t    }\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  var getVizConfig = function getVizConfig(vizId) {\n\t    var config;\n\t    var graph = $scope.config.graph;\n\t    if (graph) {\n\t      // copy setting for vizId\n\t      if (graph.setting) {\n\t        config = angular.copy(graph.setting[vizId]);\n\t      }\n\t\n\t      if (!config) {\n\t        config = {};\n\t      }\n\t\n\t      // copy common setting\n\t      config.common = angular.copy(graph.commonSetting) || {};\n\t\n\t      // copy pivot setting\n\t      if (graph.keys) {\n\t        config.common.pivot = {\n\t          keys: angular.copy(graph.keys),\n\t          groups: angular.copy(graph.groups),\n\t          values: angular.copy(graph.values)\n\t        };\n\t      }\n\t    }\n\t    console.log('getVizConfig', config);\n\t    return config;\n\t  };\n\t\n\t  var commitVizConfigChange = function commitVizConfigChange(config, vizId) {\n\t    var newConfig = angular.copy($scope.config);\n\t    if (!newConfig.graph) {\n\t      newConfig.graph = {};\n\t    }\n\t\n\t    // copy setting for vizId\n\t    if (!newConfig.graph.setting) {\n\t      newConfig.graph.setting = {};\n\t    }\n\t    newConfig.graph.setting[vizId] = angular.copy(config);\n\t\n\t    // copy common setting\n\t    if (newConfig.graph.setting[vizId]) {\n\t      newConfig.graph.commonSetting = newConfig.graph.setting[vizId].common;\n\t      delete newConfig.graph.setting[vizId].common;\n\t    }\n\t\n\t    // copy pivot setting\n\t    if (newConfig.graph.commonSetting && newConfig.graph.commonSetting.pivot) {\n\t      newConfig.graph.keys = newConfig.graph.commonSetting.pivot.keys;\n\t      newConfig.graph.groups = newConfig.graph.commonSetting.pivot.groups;\n\t      newConfig.graph.values = newConfig.graph.commonSetting.pivot.values;\n\t      delete newConfig.graph.commonSetting.pivot;\n\t    }\n\t    console.log('committVizConfig', newConfig);\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  $scope.$on('paragraphResized', function (event, paragraphId) {\n\t    // paragraph col width changed\n\t    if (paragraphId === paragraph.id) {\n\t      var builtInViz = builtInVisualizations[$scope.graphMode];\n\t      if (builtInViz && builtInViz.instance) {\n\t        builtInViz.instance.resize();\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.resize = function (width, height) {\n\t    $timeout(function () {\n\t      changeHeight(width, height);\n\t    }, 200);\n\t  };\n\t\n\t  var changeHeight = function changeHeight(width, height) {\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t    var newConfig = angular.copy($scope.config);\n\t\n\t    newConfig.graph.height = height;\n\t    paragraph.config.colWidth = width;\n\t\n\t    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n\t  };\n\t\n\t  $scope.exportToDSV = function (delimiter) {\n\t    var dsv = '';\n\t    var dateFinished = moment(paragraph.dateFinished).format('YYYY-MM-DD hh:mm:ss A');\n\t    var exportedFileName = paragraph.title ? paragraph.title + '_' + dateFinished : 'data_' + dateFinished;\n\t\n\t    for (var titleIndex in tableData.columns) {\n\t      dsv += tableData.columns[titleIndex].name + delimiter;\n\t    }\n\t    dsv = dsv.substring(0, dsv.length - 1) + '\\n';\n\t    for (var r in tableData.rows) {\n\t      var row = tableData.rows[r];\n\t      var dsvRow = '';\n\t      for (var index in row) {\n\t        var stringValue = row[index].toString();\n\t        if (stringValue.indexOf(delimiter) > -1) {\n\t          dsvRow += '\"' + stringValue + '\"' + delimiter;\n\t        } else {\n\t          dsvRow += row[index] + delimiter;\n\t        }\n\t      }\n\t      dsv += dsvRow.substring(0, dsvRow.length - 1) + '\\n';\n\t    }\n\t    var extension = '';\n\t    if (delimiter === '\\t') {\n\t      extension = 'tsv';\n\t    } else if (delimiter === ',') {\n\t      extension = 'csv';\n\t    }\n\t    saveAsService.saveAs(dsv, exportedFileName, extension);\n\t  };\n\t\n\t  $scope.getBase64ImageSrc = function (base64Data) {\n\t    return 'data:image/png;base64,' + base64Data;\n\t  };\n\t\n\t  // Helium ----------------\n\t  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n\t\n\t  // app states\n\t  $scope.apps = [];\n\t\n\t  // suggested apps\n\t  $scope.suggestion = {};\n\t\n\t  $scope.switchApp = function (appId) {\n\t    var newConfig = angular.copy($scope.config);\n\t    var newParams = angular.copy(paragraph.settings.params);\n\t\n\t    // 'helium.activeApp' can be cleared by switchViz()\n\t    _.set(newConfig, 'helium.activeApp', appId);\n\t\n\t    commitConfig(newConfig, newParams);\n\t  };\n\t\n\t  $scope.loadApp = function (heliumPackage) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    $http.post(baseUrlSrv.getRestApiBase() + '/helium/load/' + noteId + '/' + paragraph.id, heliumPackage).success(function (data, status, headers, config) {\n\t      console.log('Load app %o', data);\n\t    }).error(function (err, status, headers, config) {\n\t      console.log('Error %o', err);\n\t    });\n\t  };\n\t\n\t  var commitConfig = function commitConfig(config, params) {\n\t    commitParagraphResult(paragraph.title, paragraph.text, config, params);\n\t  };\n\t\n\t  var getApplicationStates = function getApplicationStates() {\n\t    var appStates = [];\n\t\n\t    // Display ApplicationState\n\t    if (paragraph.apps) {\n\t      _.forEach(paragraph.apps, function (app) {\n\t        appStates.push({\n\t          id: app.id,\n\t          pkg: app.pkg,\n\t          status: app.status,\n\t          output: app.output\n\t        });\n\t      });\n\t    }\n\t\n\t    // update or remove app states no longer exists\n\t    _.forEach($scope.apps, function (currentAppState, idx) {\n\t      var newAppState = _.find(appStates, { id: currentAppState.id });\n\t      if (newAppState) {\n\t        angular.extend($scope.apps[idx], newAppState);\n\t      } else {\n\t        $scope.apps.splice(idx, 1);\n\t      }\n\t    });\n\t\n\t    // add new app states\n\t    _.forEach(appStates, function (app, idx) {\n\t      if ($scope.apps.length <= idx || $scope.apps[idx].id !== app.id) {\n\t        $scope.apps.splice(idx, 0, app);\n\t      }\n\t    });\n\t  };\n\t\n\t  var getSuggestions = function getSuggestions() {\n\t    // Get suggested apps\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!noteId) {\n\t      return;\n\t    }\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/helium/suggest/' + noteId + '/' + paragraph.id).success(function (data, status, headers, config) {\n\t      $scope.suggestion = data.body;\n\t    }).error(function (err, status, headers, config) {\n\t      console.log('Error %o', err);\n\t    });\n\t  };\n\t\n\t  var renderApp = function renderApp(appState) {\n\t    var retryRenderer = function retryRenderer() {\n\t      var targetEl = angular.element(document.getElementById('p' + appState.id));\n\t      console.log('retry renderApp %o', targetEl);\n\t      if (targetEl.length) {\n\t        try {\n\t          console.log('renderApp %o', appState);\n\t          targetEl.html(appState.output);\n\t          $compile(targetEl.contents())(getAppScope(appState));\n\t        } catch (err) {\n\t          console.log('App rendering error %o', err);\n\t        }\n\t      } else {\n\t        $timeout(retryRenderer, 1000);\n\t      }\n\t    };\n\t    $timeout(retryRenderer);\n\t  };\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t  $scope.$on('appendAppOutput', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (app) {\n\t        app.output += data.data;\n\t\n\t        var paragraphAppState = _.find(paragraph.apps, { id: data.appId });\n\t        paragraphAppState.output = app.output;\n\t\n\t        var targetEl = angular.element(document.getElementById('p' + app.id));\n\t        targetEl.html(app.output);\n\t        $compile(targetEl.contents())(getAppScope(app));\n\t        console.log('append app output %o', $scope.apps);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('updateAppOutput', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (app) {\n\t        app.output = data.data;\n\t\n\t        var paragraphAppState = _.find(paragraph.apps, { id: data.appId });\n\t        paragraphAppState.output = app.output;\n\t\n\t        var targetEl = angular.element(document.getElementById('p' + app.id));\n\t        targetEl.html(app.output);\n\t        $compile(targetEl.contents())(getAppScope(app));\n\t        console.log('append app output');\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('appLoad', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (!app) {\n\t        app = {\n\t          id: data.appId,\n\t          pkg: data.pkg,\n\t          status: 'UNLOADED',\n\t          output: ''\n\t        };\n\t\n\t        $scope.apps.push(app);\n\t        paragraph.apps.push(app);\n\t        $scope.switchApp(app.id);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('appStatusChange', function (event, data) {\n\t    if (paragraph.id === data.paragraphId) {\n\t      var app = _.find($scope.apps, { id: data.appId });\n\t      if (app) {\n\t        app.status = data.status;\n\t        var paragraphAppState = _.find(paragraph.apps, { id: data.appId });\n\t        paragraphAppState.status = app.status;\n\t      }\n\t    }\n\t  });\n\t\n\t  var getAppRegistry = function getAppRegistry(appState) {\n\t    if (!appState.registry) {\n\t      appState.registry = {};\n\t    }\n\t\n\t    return appState.registry;\n\t  };\n\t\n\t  var getAppScope = function getAppScope(appState) {\n\t    if (!appState.scope) {\n\t      appState.scope = $rootScope.$new(true, $rootScope);\n\t    }\n\t    return appState.scope;\n\t  };\n\t\n\t  $scope.$on('angularObjectUpdate', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      var app = _.find($scope.apps, { id: data.paragraphId });\n\t      if (app) {\n\t        scope = getAppScope(app);\n\t        registry = getAppRegistry(app);\n\t      } else {\n\t        // no matching app in this paragraph\n\t        return;\n\t      }\n\t\n\t      var varName = data.angularObject.name;\n\t\n\t      if (angular.equals(data.angularObject.object, scope[varName])) {\n\t        // return when update has no change\n\t        return;\n\t      }\n\t\n\t      if (!registry[varName]) {\n\t        registry[varName] = {\n\t          interpreterGroupId: data.interpreterGroupId,\n\t          noteId: data.noteId,\n\t          paragraphId: data.paragraphId\n\t        };\n\t      } else {\n\t        registry[varName].noteId = registry[varName].noteId || data.noteId;\n\t        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n\t      }\n\t\n\t      registry[varName].skipEmit = true;\n\t\n\t      if (!registry[varName].clearWatcher) {\n\t        registry[varName].clearWatcher = scope.$watch(varName, function (newValue, oldValue) {\n\t          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n\t          if (registry[varName].skipEmit) {\n\t            registry[varName].skipEmit = false;\n\t            return;\n\t          }\n\t          websocketMsgSrv.updateAngularObject(registry[varName].noteId, registry[varName].paragraphId, varName, newValue, registry[varName].interpreterGroupId);\n\t        });\n\t      }\n\t      console.log('angular object (paragraph) created %o', varName);\n\t      scope[varName] = data.angularObject.object;\n\t\n\t      // create proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = function () {\n\t          scope[varName] = arguments;\n\t          console.log('angular function (paragraph) invoked %o', arguments);\n\t        };\n\t\n\t        console.log('angular function (paragraph) created %o', scope[funcName]);\n\t      }\n\t    }\n\t  });\n\t\n\t  $scope.$on('angularObjectRemove', function (event, data) {\n\t    var noteId = $route.current.pathParams.noteId;\n\t    if (!data.noteId || data.noteId === noteId) {\n\t      var scope;\n\t      var registry;\n\t\n\t      var app = _.find($scope.apps, { id: data.paragraphId });\n\t      if (app) {\n\t        scope = getAppScope(app);\n\t        registry = getAppRegistry(app);\n\t      } else {\n\t        // no matching app in this paragraph\n\t        return;\n\t      }\n\t\n\t      var varName = data.name;\n\t\n\t      // clear watcher\n\t      if (registry[varName]) {\n\t        registry[varName].clearWatcher();\n\t        registry[varName] = undefined;\n\t      }\n\t\n\t      // remove scope variable\n\t      scope[varName] = undefined;\n\t\n\t      // remove proxy for AngularFunction\n\t      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n\t        var funcName = varName.substring(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX.length);\n\t        scope[funcName] = undefined;\n\t      }\n\t    }\n\t  });\n\t};\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the 'License');\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an 'AS IS' BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('SearchResultCtrl', SearchResultCtrl);\n\t\n\tSearchResultCtrl.$inject = ['$scope', '$routeParams', 'searchService'];\n\t\n\tfunction SearchResultCtrl($scope, $routeParams, searchService) {\n\t  $scope.isResult = true;\n\t  $scope.searchTerm = $routeParams.searchTerm;\n\t  var results = searchService.search({ 'q': $routeParams.searchTerm }).query();\n\t\n\t  results.$promise.then(function (result) {\n\t    $scope.notes = result.body.map(function (note) {\n\t      // redirect to notebook when search result is a notebook itself,\n\t      // not a paragraph\n\t      if (!/\\/paragraph\\//.test(note.id)) {\n\t        return note;\n\t      }\n\t\n\t      note.id = note.id.replace('paragraph/', '?paragraph=') + '&term=' + $routeParams.searchTerm;\n\t\n\t      return note;\n\t    });\n\t    if ($scope.notes.length === 0) {\n\t      $scope.isResult = false;\n\t    } else {\n\t      $scope.isResult = true;\n\t    }\n\t\n\t    $scope.$on('$routeChangeStart', function (event, next, current) {\n\t      if (next.originalPath !== '/search/:searchTerm') {\n\t        searchService.searchTerm = '';\n\t      }\n\t    });\n\t  });\n\t\n\t  $scope.page = 0;\n\t  $scope.allResults = false;\n\t\n\t  $scope.highlightSearchResults = function (note) {\n\t    return function (_editor) {\n\t      function getEditorMode(text) {\n\t        var editorModes = {\n\t          'ace/mode/scala': /^%(\\w*\\.)?spark/,\n\t          'ace/mode/python': /^%(\\w*\\.)?(pyspark|python)/,\n\t          'ace/mode/r': /^%(\\w*\\.)?(r|sparkr|knitr)/,\n\t          'ace/mode/sql': /^%(\\w*\\.)?\\wql/,\n\t          'ace/mode/markdown': /^%md/,\n\t          'ace/mode/sh': /^%sh/\n\t        };\n\t\n\t        return Object.keys(editorModes).reduce(function (res, mode) {\n\t          return editorModes[mode].test(text) ? mode : res;\n\t        }, 'ace/mode/scala');\n\t      }\n\t\n\t      var Range = ace.require('ace/range').Range;\n\t\n\t      _editor.setOption('highlightActiveLine', false);\n\t      _editor.$blockScrolling = Infinity;\n\t      _editor.setReadOnly(true);\n\t      _editor.renderer.setShowGutter(false);\n\t      _editor.setTheme('ace/theme/chrome');\n\t      _editor.getSession().setMode(getEditorMode(note.text));\n\t\n\t      function getIndeces(term) {\n\t        return function (str) {\n\t          var indeces = [];\n\t          var i = -1;\n\t          while ((i = str.indexOf(term, i + 1)) >= 0) {\n\t            indeces.push(i);\n\t          }\n\t          return indeces;\n\t        };\n\t      }\n\t\n\t      var result = '';\n\t      if (note.header !== '') {\n\t        result = note.header + '\\n\\n' + note.snippet;\n\t      } else {\n\t        result = note.snippet;\n\t      }\n\t\n\t      var lines = result.split('\\n').map(function (line, row) {\n\t\n\t        var match = line.match(/<B>(.+?)<\\/B>/);\n\t\n\t        // return early if nothing to highlight\n\t        if (!match) {\n\t          return line;\n\t        }\n\t\n\t        var term = match[1];\n\t        var __line = line.replace(/<B>/g, '').replace(/<\\/B>/g, '');\n\t\n\t        var indeces = getIndeces(term)(__line);\n\t\n\t        indeces.forEach(function (start) {\n\t          var end = start + term.length;\n\t          if (note.header !== '' && row === 0) {\n\t            _editor.getSession().addMarker(new Range(row, 0, row, line.length), 'search-results-highlight-header', 'background');\n\t            _editor.getSession().addMarker(new Range(row, start, row, end), 'search-results-highlight', 'line');\n\t          } else {\n\t            _editor.getSession().addMarker(new Range(row, start, row, end), 'search-results-highlight', 'line');\n\t          }\n\t        });\n\t        return __line;\n\t      });\n\t\n\t      // resize editor based on content length\n\t      _editor.setOption('maxLines', lines.reduce(function (len, line) {\n\t        return len + line.length;\n\t      }, 0));\n\t\n\t      _editor.getSession().setValue(lines.join('\\n'));\n\t    };\n\t  };\n\t}\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NotebookReposCtrl', NotebookReposCtrl);\n\t\n\tNotebookReposCtrl.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\t\n\tfunction NotebookReposCtrl($http, baseUrlSrv, ngToast) {\n\t  var vm = this;\n\t  vm.notebookRepos = [];\n\t  vm.showDropdownSelected = showDropdownSelected;\n\t  vm.saveNotebookRepo = saveNotebookRepo;\n\t\n\t  _init();\n\t\n\t  // Public functions\n\t\n\t  function saveNotebookRepo(valueform, repo, data) {\n\t    console.log('data %o', data);\n\t    $http.put(baseUrlSrv.getRestApiBase() + '/notebook-repositories', {\n\t      'name': repo.className,\n\t      'settings': data\n\t    }).success(function (data) {\n\t      var index = _.findIndex(vm.notebookRepos, { 'className': repo.className });\n\t      if (index >= 0) {\n\t        vm.notebookRepos[index] = data.body;\n\t        console.log('repos %o, data %o', vm.notebookRepos, data.body);\n\t      }\n\t      valueform.$show();\n\t    }).error(function () {\n\t      ngToast.danger({\n\t        content: 'We couldn\\'t save that NotebookRepo\\'s settings',\n\t        verticalPosition: 'bottom',\n\t        timeout: '3000'\n\t      });\n\t      valueform.$show();\n\t    });\n\t\n\t    return 'manual';\n\t  }\n\t\n\t  function showDropdownSelected(setting) {\n\t    var index = _.findIndex(setting.value, { 'value': setting.selected });\n\t    if (index < 0) {\n\t      return 'No value';\n\t    } else {\n\t      return setting.value[index].name;\n\t    }\n\t  }\n\t\n\t  // Private functions\n\t\n\t  function _getInterpreterSettings() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/notebook-repositories').success(function (data, status, headers, config) {\n\t      vm.notebookRepos = data.body;\n\t      console.log('ya notebookRepos %o', vm.notebookRepos);\n\t    }).error(function (data, status, headers, config) {\n\t      if (status === 401) {\n\t        ngToast.danger({\n\t          content: 'You don\\'t have permission on this page',\n\t          verticalPosition: 'bottom',\n\t          timeout: '3000'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 3000);\n\t      }\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  }\n\t\n\t  function _init() {\n\t    _getInterpreterSettings();\n\t  };\n\t}\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t(function () {\n\t\n\t  angular.module('zeppelinWebApp').controller('HeliumCtrl', HeliumCtrl);\n\t\n\t  HeliumCtrl.$inject = ['$scope', '$rootScope', '$sce', 'baseUrlSrv', 'ngToast', 'heliumService'];\n\t\n\t  function HeliumCtrl($scope, $rootScope, $sce, baseUrlSrv, ngToast, heliumService) {\n\t    $scope.packageInfos = {};\n\t    $scope.defaultVersions = {};\n\t    $scope.showVersions = {};\n\t    $scope.visualizationOrder = [];\n\t    $scope.visualizationOrderChanged = false;\n\t\n\t    var buildDefaultVersionListToDisplay = function buildDefaultVersionListToDisplay(packageInfos) {\n\t      var defaultVersions = {};\n\t      // show enabled version if any version of package is enabled\n\t      for (var name in packageInfos) {\n\t        var pkgs = packageInfos[name];\n\t        for (var pkgIdx in pkgs) {\n\t          var pkg = pkgs[pkgIdx];\n\t          pkg.pkg.icon = $sce.trustAsHtml(pkg.pkg.icon);\n\t          if (pkg.enabled) {\n\t            defaultVersions[name] = pkg;\n\t            pkgs.splice(pkgIdx, 1);\n\t            break;\n\t          }\n\t        }\n\t\n\t        // show first available version if package is not enabled\n\t        if (!defaultVersions[name]) {\n\t          defaultVersions[name] = pkgs[0];\n\t          pkgs.splice(0, 1);\n\t        }\n\t      }\n\t      $scope.defaultVersions = defaultVersions;\n\t    };\n\t\n\t    var getAllPackageInfo = function getAllPackageInfo() {\n\t      heliumService.getAllPackageInfo().success(function (data, status) {\n\t        $scope.packageInfos = data.body;\n\t        buildDefaultVersionListToDisplay($scope.packageInfos);\n\t      }).error(function (data, status) {\n\t        console.log('Can not load package info %o %o', status, data);\n\t      });\n\t    };\n\t\n\t    var getVisualizationOrder = function getVisualizationOrder() {\n\t      heliumService.getVisualizationOrder().success(function (data, status) {\n\t        $scope.visualizationOrder = data.body;\n\t      }).error(function (data, status) {\n\t        console.log('Can not get visualization order %o %o', status, data);\n\t      });\n\t    };\n\t\n\t    $scope.visualizationOrderListeners = {\n\t      accept: function accept(sourceItemHandleScope, destSortableScope) {\n\t        return true;\n\t      },\n\t      itemMoved: function itemMoved(event) {},\n\t      orderChanged: function orderChanged(event) {\n\t        $scope.visualizationOrderChanged = true;\n\t      }\n\t    };\n\t\n\t    var init = function init() {\n\t      getAllPackageInfo();\n\t      getVisualizationOrder();\n\t      $scope.visualizationOrderChanged = false;\n\t    };\n\t\n\t    init();\n\t\n\t    $scope.saveVisualizationOrder = function () {\n\t      var confirm = BootstrapDialog.confirm({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: '',\n\t        message: 'Save changes?',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            confirm.$modalFooter.find('button').addClass('disabled');\n\t            confirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n\t            heliumService.setVisualizationOrder($scope.visualizationOrder).success(function (data, status) {\n\t              init();\n\t              confirm.close();\n\t            }).error(function (data, status) {\n\t              confirm.close();\n\t              console.log('Failed to save order');\n\t              BootstrapDialog.show({\n\t                title: 'Error on saving order ',\n\t                message: data.message\n\t              });\n\t            });\n\t            return false;\n\t          }\n\t        }\n\t      });\n\t    };\n\t\n\t    var getLicense = function getLicense(name, artifact) {\n\t      var pkg = _.filter($scope.defaultVersions[name], function (p) {\n\t        return p.artifact === artifact;\n\t      });\n\t\n\t      var license;\n\t      if (pkg.length === 0) {\n\t        pkg = _.filter($scope.packageInfos[name], function (p) {\n\t          return p.pkg.artifact === artifact;\n\t        });\n\t\n\t        if (pkg.length > 0) {\n\t          license = pkg[0].pkg.license;\n\t        }\n\t      } else {\n\t        license = pkg[0].license;\n\t      }\n\t\n\t      if (!license) {\n\t        license = 'Unknown';\n\t      }\n\t      return license;\n\t    };\n\t\n\t    $scope.enable = function (name, artifact) {\n\t      var license = getLicense(name, artifact);\n\t\n\t      var confirm = BootstrapDialog.confirm({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: '',\n\t        message: 'Do you want to enable ' + name + '?' + '<div style=\"color:gray\">' + artifact + '</div>' + '<div style=\"border-top: 1px solid #efefef; margin-top: 10px; padding-top: 5px;\">License</div>' + '<div style=\"color:gray\">' + license + '</div>',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            confirm.$modalFooter.find('button').addClass('disabled');\n\t            confirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n\t            heliumService.enable(name, artifact).success(function (data, status) {\n\t              init();\n\t              confirm.close();\n\t            }).error(function (data, status) {\n\t              confirm.close();\n\t              console.log('Failed to enable package %o %o. %o', name, artifact, data);\n\t              BootstrapDialog.show({\n\t                title: 'Error on enabling ' + name,\n\t                message: data.message\n\t              });\n\t            });\n\t            return false;\n\t          }\n\t        }\n\t      });\n\t    };\n\t\n\t    $scope.disable = function (name) {\n\t      var confirm = BootstrapDialog.confirm({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: '',\n\t        message: 'Do you want to disable ' + name + '?',\n\t        callback: function callback(result) {\n\t          if (result) {\n\t            confirm.$modalFooter.find('button').addClass('disabled');\n\t            confirm.$modalFooter.find('button:contains(\"OK\")').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Disabling');\n\t            heliumService.disable(name).success(function (data, status) {\n\t              init();\n\t              confirm.close();\n\t            }).error(function (data, status) {\n\t              confirm.close();\n\t              console.log('Failed to disable package %o. %o', name, data);\n\t              BootstrapDialog.show({\n\t                title: 'Error on disabling ' + name,\n\t                message: data.message\n\t              });\n\t            });\n\t            return false;\n\t          }\n\t        }\n\t      });\n\t    };\n\t\n\t    $scope.toggleVersions = function (pkgName) {\n\t      if ($scope.showVersions[pkgName]) {\n\t        $scope.showVersions[pkgName] = false;\n\t      } else {\n\t        $scope.showVersions[pkgName] = true;\n\t      }\n\t    };\n\t\n\t    $scope.getPackageSize = function (pkgSearchResult) {\n\t      return _.size(pkgSearchResult);\n\t    };\n\t  }\n\t})();\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('arrayOrderingSrv', arrayOrderingSrv);\n\t\n\tarrayOrderingSrv.$inject = ['TRASH_FOLDER_ID'];\n\t\n\tfunction arrayOrderingSrv(TRASH_FOLDER_ID) {\n\t  var arrayOrderingSrv = this;\n\t\n\t  this.noteListOrdering = function (note) {\n\t    if (note.id === TRASH_FOLDER_ID) {\n\t      return '\\uFFFF';\n\t    }\n\t    return arrayOrderingSrv.getNoteName(note);\n\t  };\n\t\n\t  this.getNoteName = function (note) {\n\t    if (note.name === undefined || note.name.trim() === '') {\n\t      return 'Note ' + note.id;\n\t    } else {\n\t      return note.name;\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\tangular.module('zeppelinWebApp').controller('clipboardCtrl', clipboardCtrl);\n\tclipboardCtrl.$inject = ['$scope'];\n\t\n\tfunction clipboardCtrl($scope) {\n\t  $scope.complete = function (e) {\n\t    $scope.copied = true;\n\t    $scope.tooltip = 'Copied!';\n\t    setTimeout(function () {\n\t      $scope.tooltip = 'Copy to clipboard';\n\t    }, 400);\n\t  };\n\t  $scope.$watch('input', function () {\n\t    $scope.copied = false;\n\t    $scope.tooltip = 'Copy to clipboard';\n\t  });\n\t  $scope.clipError = function (e) {\n\t    console.log('Error: ' + e.name + ' - ' + e.message);\n\t    $scope.tooltip = 'Not supported browser';\n\t  };\n\t}\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NavCtrl', NavCtrl);\n\t\n\tNavCtrl.$inject = ['$scope', '$rootScope', '$http', '$routeParams', '$location', 'noteListDataFactory', 'baseUrlSrv', 'websocketMsgSrv', 'arrayOrderingSrv', 'searchService', 'TRASH_FOLDER_ID'];\n\t\n\tfunction NavCtrl($scope, $rootScope, $http, $routeParams, $location, noteListDataFactory, baseUrlSrv, websocketMsgSrv, arrayOrderingSrv, searchService, TRASH_FOLDER_ID) {\n\t  var vm = this;\n\t  vm.arrayOrderingSrv = arrayOrderingSrv;\n\t  vm.connected = websocketMsgSrv.isConnected();\n\t  vm.isActive = isActive;\n\t  vm.logout = logout;\n\t  vm.notes = noteListDataFactory;\n\t  vm.search = search;\n\t  vm.searchForm = searchService;\n\t  vm.showLoginWindow = showLoginWindow;\n\t  vm.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n\t  vm.isFilterNote = isFilterNote;\n\t\n\t  $scope.query = { q: '' };\n\t\n\t  initController();\n\t\n\t  function getZeppelinVersion() {\n\t    $http.get(baseUrlSrv.getRestApiBase() + '/version').success(function (data, status, headers, config) {\n\t      $rootScope.zeppelinVersion = data.body;\n\t    }).error(function (data, status, headers, config) {\n\t      console.log('Error %o %o', status, data.message);\n\t    });\n\t  }\n\t\n\t  function initController() {\n\t    $scope.isDrawNavbarNoteList = false;\n\t    angular.element('#notebook-list').perfectScrollbar({ suppressScrollX: true });\n\t\n\t    angular.element(document).click(function () {\n\t      $scope.query.q = '';\n\t    });\n\t\n\t    getZeppelinVersion();\n\t    loadNotes();\n\t  }\n\t\n\t  function isFilterNote(note) {\n\t    if (!$scope.query.q) {\n\t      return true;\n\t    }\n\t\n\t    var noteName = note.name;\n\t    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n\t      return true;\n\t    }\n\t    return false;\n\t  }\n\t\n\t  function isActive(noteId) {\n\t    return $routeParams.noteId === noteId;\n\t  }\n\t\n\t  function listConfigurations() {\n\t    websocketMsgSrv.listConfigurations();\n\t  }\n\t\n\t  function loadNotes() {\n\t    websocketMsgSrv.getNoteList();\n\t  }\n\t\n\t  function getHomeNote() {\n\t    websocketMsgSrv.getHomeNote();\n\t  }\n\t\n\t  function logout() {\n\t    var logoutURL = baseUrlSrv.getRestApiBase() + '/login/logout';\n\t\n\t    //for firefox and safari\n\t    logoutURL = logoutURL.replace('//', '//false:false@');\n\t    $http.post(logoutURL).error(function () {\n\t      //force authcBasic (if configured) to logout\n\t      $http.post(logoutURL).error(function () {\n\t        $rootScope.userName = '';\n\t        $rootScope.ticket.principal = '';\n\t        $rootScope.ticket.ticket = '';\n\t        $rootScope.ticket.roles = '';\n\t        BootstrapDialog.show({\n\t          message: 'Logout Success'\n\t        });\n\t        setTimeout(function () {\n\t          window.location.replace('/');\n\t        }, 1000);\n\t      });\n\t    });\n\t  }\n\t\n\t  function search(searchTerm) {\n\t    $location.path('/search/' + searchTerm);\n\t  }\n\t\n\t  function showLoginWindow() {\n\t    setTimeout(function () {\n\t      angular.element('#userName').focus();\n\t    }, 500);\n\t  }\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteMenu', function (event, notes) {\n\t    noteListDataFactory.setNotes(notes);\n\t    initNotebookListEventListener();\n\t  });\n\t\n\t  $scope.$on('setConnectedStatus', function (event, param) {\n\t    vm.connected = param;\n\t  });\n\t\n\t  $scope.$on('loginSuccess', function (event, param) {\n\t    listConfigurations();\n\t    loadNotes();\n\t    getHomeNote();\n\t  });\n\t\n\t  /*\n\t   ** Performance optimization for Browser Render.\n\t   */\n\t  function initNotebookListEventListener() {\n\t    angular.element(document).ready(function () {\n\t      angular.element('.notebook-list-dropdown').on('show.bs.dropdown', function () {\n\t        $scope.isDrawNavbarNoteList = true;\n\t      });\n\t\n\t      angular.element('.notebook-list-dropdown').on('hide.bs.dropdown', function () {\n\t        $scope.isDrawNavbarNoteList = false;\n\t      });\n\t    });\n\t  }\n\t}\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('ngEscape', ngEscape);\n\t\n\tfunction ngEscape() {\n\t  return function (scope, element, attrs) {\n\t    element.bind('keydown keyup', function (event) {\n\t      if (event.which === 27) {\n\t        scope.$apply(function () {\n\t          scope.$eval(attrs.ngEscape);\n\t        });\n\t        event.preventDefault();\n\t      }\n\t    });\n\t  };\n\t}\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('interpreterDirective', interpreterDirective);\n\t\n\tinterpreterDirective.$inject = ['$timeout'];\n\t\n\tfunction interpreterDirective($timeout) {\n\t  return {\n\t    restrict: 'A',\n\t    link: function link(scope, element, attr) {\n\t      if (scope.$last === true) {\n\t        $timeout(function () {\n\t          var id = 'ngRenderFinished';\n\t          scope.$emit(id);\n\t        });\n\t      }\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('expandCollapse', expandCollapse);\n\t\n\tfunction expandCollapse() {\n\t  return {\n\t    restrict: 'EA',\n\t    link: function link(scope, element, attrs) {\n\t      angular.element(element).click(function (event) {\n\t        if (angular.element(element).find('.expandable:visible').length > 1) {\n\t          angular.element(element).find('.expandable:visible').slideUp('slow');\n\t          angular.element(element).find('i.icon-folder-alt').toggleClass('icon-folder icon-folder-alt');\n\t        } else {\n\t          angular.element(element).find('.expandable').first().slideToggle('200', function () {\n\t            // do not toggle trash folder\n\t            if (angular.element(element).find('.fa-trash-o').length === 0) {\n\t              angular.element(element).find('i').first().toggleClass('icon-folder icon-folder-alt');\n\t            }\n\t          });\n\t        }\n\t        event.stopPropagation();\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NotenameCtrl', NotenameCtrl);\n\t\n\tNotenameCtrl.$inject = ['$scope', 'noteListDataFactory', '$routeParams', 'websocketMsgSrv'];\n\t\n\tfunction NotenameCtrl($scope, noteListDataFactory, $routeParams, websocketMsgSrv) {\n\t  var vm = this;\n\t  vm.clone = false;\n\t  vm.notes = noteListDataFactory;\n\t  vm.websocketMsgSrv = websocketMsgSrv;\n\t  $scope.note = {};\n\t  $scope.interpreterSettings = {};\n\t  $scope.note.defaultInterpreter = null;\n\t\n\t  vm.createNote = function () {\n\t    if (!vm.clone) {\n\t      var defaultInterpreterId = '';\n\t      if ($scope.note.defaultInterpreter !== null) {\n\t        defaultInterpreterId = $scope.note.defaultInterpreter.id;\n\t      }\n\t      vm.websocketMsgSrv.createNotebook($scope.note.notename, defaultInterpreterId);\n\t      $scope.note.defaultInterpreter = $scope.interpreterSettings[0];\n\t    } else {\n\t      var noteId = $routeParams.noteId;\n\t      vm.websocketMsgSrv.cloneNote(noteId, $scope.note.notename);\n\t    }\n\t  };\n\t\n\t  vm.handleNameEnter = function () {\n\t    angular.element('#noteNameModal').modal('toggle');\n\t    vm.createNote();\n\t  };\n\t\n\t  vm.preVisible = function (clone, sourceNoteName) {\n\t    vm.clone = clone;\n\t    vm.sourceNoteName = sourceNoteName;\n\t    $scope.note.notename = vm.clone ? vm.cloneNoteName() : vm.newNoteName();\n\t    $scope.$apply();\n\t  };\n\t\n\t  vm.newNoteName = function () {\n\t    var newCount = 1;\n\t    angular.forEach(vm.notes.flatList, function (noteName) {\n\t      noteName = noteName.name;\n\t      if (noteName.match(/^Untitled Note [0-9]*$/)) {\n\t        var lastCount = noteName.substr(14) * 1;\n\t        if (newCount <= lastCount) {\n\t          newCount = lastCount + 1;\n\t        }\n\t      }\n\t    });\n\t    return 'Untitled Note ' + newCount;\n\t  };\n\t\n\t  vm.cloneNoteName = function () {\n\t    var copyCount = 1;\n\t    var newCloneName = '';\n\t    var lastIndex = vm.sourceNoteName.lastIndexOf(' ');\n\t    var endsWithNumber = !!vm.sourceNoteName.match('^.+?\\\\s\\\\d$');\n\t    var noteNamePrefix = endsWithNumber ? vm.sourceNoteName.substr(0, lastIndex) : vm.sourceNoteName;\n\t    var regexp = new RegExp('^' + noteNamePrefix + ' .+');\n\t\n\t    angular.forEach(vm.notes.flatList, function (noteName) {\n\t      noteName = noteName.name;\n\t      if (noteName.match(regexp)) {\n\t        var lastCopyCount = noteName.substr(lastIndex).trim();\n\t        newCloneName = noteNamePrefix;\n\t        lastCopyCount = parseInt(lastCopyCount);\n\t        if (copyCount <= lastCopyCount) {\n\t          copyCount = lastCopyCount + 1;\n\t        }\n\t      }\n\t    });\n\t\n\t    if (!newCloneName) {\n\t      newCloneName = vm.sourceNoteName;\n\t    }\n\t    return newCloneName + ' ' + copyCount;\n\t  };\n\t\n\t  vm.getInterpreterSettings = function () {\n\t    vm.websocketMsgSrv.getInterpreterSettings();\n\t  };\n\t\n\t  $scope.$on('interpreterSettings', function (event, data) {\n\t    $scope.interpreterSettings = data.interpreterSettings;\n\t\n\t    //initialize default interpreter with Spark interpreter\n\t    $scope.note.defaultInterpreter = data.interpreterSettings[0];\n\t  });\n\t}\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('NoteImportCtrl', NoteImportCtrl);\n\t\n\tNoteImportCtrl.$inject = ['$scope', '$timeout', 'websocketMsgSrv'];\n\t\n\tfunction NoteImportCtrl($scope, $timeout, websocketMsgSrv) {\n\t  var vm = this;\n\t  $scope.note = {};\n\t  $scope.note.step1 = true;\n\t  $scope.note.step2 = false;\n\t  $scope.maxLimit = '';\n\t  var limit = 0;\n\t\n\t  websocketMsgSrv.listConfigurations();\n\t  $scope.$on('configurationsInfo', function (scope, event) {\n\t    limit = event.configurations['zeppelin.websocket.max.text.message.size'];\n\t    $scope.maxLimit = Math.round(limit / 1048576);\n\t  });\n\t\n\t  vm.resetFlags = function () {\n\t    $scope.note = {};\n\t    $scope.note.step1 = true;\n\t    $scope.note.step2 = false;\n\t    angular.element('#noteImportFile').val('');\n\t  };\n\t\n\t  $scope.uploadFile = function () {\n\t    angular.element('#noteImportFile').click();\n\t  };\n\t\n\t  $scope.importFile = function (element) {\n\t    $scope.note.errorText = '';\n\t    $scope.note.importFile = element.files[0];\n\t    var file = $scope.note.importFile;\n\t    var reader = new FileReader();\n\t\n\t    if (file.size > limit) {\n\t      $scope.note.errorText = 'File size limit Exceeded!';\n\t      $scope.$apply();\n\t      return;\n\t    }\n\t\n\t    reader.onloadend = function () {\n\t      vm.processImportJson(reader.result);\n\t    };\n\t\n\t    if (file) {\n\t      reader.readAsText(file);\n\t    }\n\t  };\n\t\n\t  $scope.uploadURL = function () {\n\t    $scope.note.errorText = '';\n\t    $scope.note.step1 = false;\n\t    $timeout(function () {\n\t      $scope.note.step2 = true;\n\t    }, 400);\n\t  };\n\t\n\t  vm.importBack = function () {\n\t    $scope.note.errorText = '';\n\t    $timeout(function () {\n\t      $scope.note.step1 = true;\n\t    }, 400);\n\t    $scope.note.step2 = false;\n\t  };\n\t\n\t  vm.importNote = function () {\n\t    $scope.note.errorText = '';\n\t    if ($scope.note.importUrl) {\n\t      jQuery.ajax({\n\t        url: $scope.note.importUrl,\n\t        type: 'GET',\n\t        dataType: 'json',\n\t        jsonp: false,\n\t        xhrFields: {\n\t          withCredentials: false\n\t        },\n\t        error: function error(xhr, ajaxOptions, thrownError) {\n\t          $scope.note.errorText = 'Unable to Fetch URL';\n\t          $scope.$apply();\n\t        } }).done(function (data) {\n\t        vm.processImportJson(data);\n\t      });\n\t    } else {\n\t      $scope.note.errorText = 'Enter URL';\n\t      $scope.$apply();\n\t    }\n\t  };\n\t\n\t  vm.processImportJson = function (result) {\n\t    if ((typeof result === 'undefined' ? 'undefined' : _typeof(result)) !== 'object') {\n\t      try {\n\t        result = JSON.parse(result);\n\t      } catch (e) {\n\t        $scope.note.errorText = 'JSON parse exception';\n\t        $scope.$apply();\n\t        return;\n\t      }\n\t    }\n\t    if (result.paragraphs && result.paragraphs.length > 0) {\n\t      if (!$scope.note.noteImportName) {\n\t        $scope.note.noteImportName = result.name;\n\t      } else {\n\t        result.name = $scope.note.noteImportName;\n\t      }\n\t      websocketMsgSrv.importNote(result);\n\t      //angular.element('#noteImportModal').modal('hide');\n\t    } else {\n\t      $scope.note.errorText = 'Invalid JSON';\n\t    }\n\t    $scope.$apply();\n\t  };\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t\n\t  $scope.$on('setNoteMenu', function (event, notes) {\n\t    vm.resetFlags();\n\t    angular.element('#noteImportModal').modal('hide');\n\t  });\n\t}\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('popoverHtmlUnsafe', popoverHtmlUnsafe);\n\t\n\tpopoverHtmlUnsafe.$inject = ['$uibTooltip'];\n\t\n\tfunction popoverHtmlUnsafe($uibTooltip) {\n\t  return $uibTooltip('popoverHtmlUnsafe', 'popover', 'click');\n\t}\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('popoverHtmlUnsafePopup', popoverHtmlUnsafePopup);\n\t\n\tfunction popoverHtmlUnsafePopup() {\n\t  return {\n\t    restrict: 'EA',\n\t    replace: true,\n\t    scope: { title: '@', content: '@', placement: '@', animation: '&', isOpen: '&' },\n\t    templateUrl: 'components/popover-html-unsafe/popover-html-unsafe-popup.html'\n\t  };\n\t}\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tcodeEditor.$inject = [\"$templateRequest\", \"$compile\"];\n\tangular.module('zeppelinWebApp').directive('codeEditor', codeEditor);\n\t\n\tfunction codeEditor($templateRequest, $compile) {\n\t  return {\n\t    restrict: 'AE',\n\t    scope: {\n\t      paragraphId: '=paragraphId',\n\t      paragraph: '=paragraphContext',\n\t      dirtyText: '=dirtyText',\n\t      originalText: '=originalText',\n\t      onLoad: '=onLoad',\n\t      revisionView: '=revisionView'\n\t    },\n\t    link: function link(scope, element, attrs, controller) {\n\t      $templateRequest('components/editor/ace.editor.directive.html').then(function (editorHtml) {\n\t        var editor = angular.element(editorHtml);\n\t        editor.attr('id', scope.paragraphId + '_editor');\n\t        element.append(editor);\n\t        $compile(editor)(scope);\n\t        console.log('codeEditor directive revision view is ' + scope.revisionView);\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('ngEnter', ngEnter);\n\t\n\tfunction ngEnter() {\n\t  return function (scope, element, attrs) {\n\t    element.bind('keydown keypress', function (event) {\n\t      if (event.which === 13) {\n\t        if (!event.shiftKey) {\n\t          scope.$apply(function () {\n\t            scope.$eval(attrs.ngEnter);\n\t          });\n\t        }\n\t        event.preventDefault();\n\t      }\n\t    });\n\t  };\n\t}\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('dropdownInput', dropdownInput);\n\t\n\tfunction dropdownInput() {\n\t  return {\n\t    restrict: 'A',\n\t    link: function link(scope, element) {\n\t      element.bind('click', function (event) {\n\t        event.stopPropagation();\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('resizable', resizable);\n\t\n\tfunction resizable() {\n\t  var resizableConfig = {\n\t    autoHide: true,\n\t    handles: 'se',\n\t    helper: 'resizable-helper',\n\t    stop: function stop() {\n\t      angular.element(this).css({ 'width': '100%', 'height': '100%' });\n\t    }\n\t  };\n\t\n\t  return {\n\t    restrict: 'A',\n\t    scope: {\n\t      callback: '&onResize'\n\t    },\n\t    link: function postLink(scope, elem, attrs) {\n\t      attrs.$observe('resize', function (resize) {\n\t        var resetResize = function resetResize(elem, resize) {\n\t          var colStep = window.innerWidth / 12;\n\t          elem.off('resizestop');\n\t          var conf = angular.copy(resizableConfig);\n\t          if (resize.graphType === 'TABLE' || resize.graphType === 'TEXT') {\n\t            conf.grid = [colStep, 10];\n\t            conf.minHeight = 100;\n\t          } else {\n\t            conf.grid = [colStep, 10000];\n\t            conf.minHeight = 0;\n\t          }\n\t          conf.maxWidth = window.innerWidth;\n\t\n\t          elem.resizable(conf);\n\t          elem.on('resizestop', function () {\n\t            if (scope.callback) {\n\t              var height = elem.height();\n\t              if (height < 50) {\n\t                height = 300;\n\t              }\n\t              scope.callback({ width: Math.ceil(elem.width() / colStep), height: height });\n\t            }\n\t          });\n\t        };\n\t\n\t        resize = JSON.parse(resize);\n\t        if (resize.allowresize === 'true') {\n\t          resetResize(elem, resize);\n\t          angular.element(window).resize(function () {\n\t            resetResize(elem, resize);\n\t          });\n\t        }\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').directive('modalvisible', modalvisible);\n\t\n\tfunction modalvisible() {\n\t  return {\n\t    restrict: 'A',\n\t    scope: {\n\t      preVisibleCallback: '&previsiblecallback',\n\t      postVisibleCallback: '&postvisiblecallback',\n\t      targetinput: '@targetinput'\n\t    },\n\t    link: function link(scope, element, attrs) {\n\t      // Add some listeners\n\t      var previsibleMethod = scope.preVisibleCallback;\n\t      var postVisibleMethod = scope.postVisibleCallback;\n\t      element.on('show.bs.modal', function (e) {\n\t        var relatedTarget = angular.element(e.relatedTarget);\n\t        var clone = relatedTarget.data('clone');\n\t        var sourceNoteName = relatedTarget.data('source-note-name');\n\t        var cloneNote = clone ? true : false;\n\t        previsibleMethod()(cloneNote, sourceNoteName);\n\t      });\n\t      element.on('shown.bs.modal', function (e) {\n\t        if (scope.targetinput) {\n\t          angular.element(e.target).find('input#' + scope.targetinput).select();\n\t        }\n\t        postVisibleMethod();\n\t      });\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('websocketMsgSrv', websocketMsgSrv);\n\t\n\twebsocketMsgSrv.$inject = ['$rootScope', 'websocketEvents'];\n\t\n\tfunction websocketMsgSrv($rootScope, websocketEvents) {\n\t  return {\n\t\n\t    getHomeNote: function getHomeNote() {\n\t      websocketEvents.sendNewEvent({ op: 'GET_HOME_NOTE' });\n\t    },\n\t\n\t    createNotebook: function createNotebook(noteName, defaultInterpreterId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'NEW_NOTE',\n\t        data: {\n\t          name: noteName,\n\t          defaultInterpreterId: defaultInterpreterId\n\t        }\n\t      });\n\t    },\n\t\n\t    moveNoteToTrash: function moveNoteToTrash(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'MOVE_NOTE_TO_TRASH', data: { id: noteId } });\n\t    },\n\t\n\t    moveFolderToTrash: function moveFolderToTrash(folderId) {\n\t      websocketEvents.sendNewEvent({ op: 'MOVE_FOLDER_TO_TRASH', data: { id: folderId } });\n\t    },\n\t\n\t    restoreNote: function restoreNote(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'RESTORE_NOTE', data: { id: noteId } });\n\t    },\n\t\n\t    restoreFolder: function restoreFolder(folderId) {\n\t      websocketEvents.sendNewEvent({ op: 'RESTORE_FOLDER', data: { id: folderId } });\n\t    },\n\t\n\t    restoreAll: function restoreAll() {\n\t      websocketEvents.sendNewEvent({ op: 'RESTORE_ALL' });\n\t    },\n\t\n\t    deleteNote: function deleteNote(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'DEL_NOTE', data: { id: noteId } });\n\t    },\n\t\n\t    removeFolder: function removeFolder(folderId) {\n\t      websocketEvents.sendNewEvent({ op: 'REMOVE_FOLDER', data: { id: folderId } });\n\t    },\n\t\n\t    emptyTrash: function emptyTrash() {\n\t      websocketEvents.sendNewEvent({ op: 'EMPTY_TRASH' });\n\t    },\n\t\n\t    cloneNote: function cloneNote(noteIdToClone, newNoteName) {\n\t      websocketEvents.sendNewEvent({ op: 'CLONE_NOTE', data: { id: noteIdToClone, name: newNoteName } });\n\t    },\n\t\n\t    getNoteList: function getNoteList() {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_NOTES' });\n\t    },\n\t\n\t    reloadAllNotesFromRepo: function reloadAllNotesFromRepo() {\n\t      websocketEvents.sendNewEvent({ op: 'RELOAD_NOTES_FROM_REPO' });\n\t    },\n\t\n\t    getNote: function getNote(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'GET_NOTE', data: { id: noteId } });\n\t    },\n\t\n\t    updateNote: function updateNote(noteId, noteName, noteConfig) {\n\t      websocketEvents.sendNewEvent({ op: 'NOTE_UPDATE', data: { id: noteId, name: noteName, config: noteConfig } });\n\t    },\n\t\n\t    updatePersonalizedMode: function updatePersonalizedMode(noteId, modeValue) {\n\t      websocketEvents.sendNewEvent({ op: 'UPDATE_PERSONALIZED_MODE', data: { id: noteId, personalized: modeValue } });\n\t    },\n\t\n\t    renameNote: function renameNote(noteId, noteName) {\n\t      websocketEvents.sendNewEvent({ op: 'NOTE_RENAME', data: { id: noteId, name: noteName } });\n\t    },\n\t\n\t    renameFolder: function renameFolder(folderId, folderName) {\n\t      websocketEvents.sendNewEvent({ op: 'FOLDER_RENAME', data: { id: folderId, name: folderName } });\n\t    },\n\t\n\t    moveParagraph: function moveParagraph(paragraphId, newIndex) {\n\t      websocketEvents.sendNewEvent({ op: 'MOVE_PARAGRAPH', data: { id: paragraphId, index: newIndex } });\n\t    },\n\t\n\t    insertParagraph: function insertParagraph(newIndex) {\n\t      websocketEvents.sendNewEvent({ op: 'INSERT_PARAGRAPH', data: { index: newIndex } });\n\t    },\n\t\n\t    copyParagraph: function copyParagraph(newIndex, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'COPY_PARAGRAPH',\n\t        data: {\n\t          index: newIndex,\n\t          title: paragraphTitle,\n\t          paragraph: paragraphData,\n\t          config: paragraphConfig,\n\t          params: paragraphParams\n\t        }\n\t      });\n\t    },\n\t\n\t    updateAngularObject: function updateAngularObject(noteId, paragraphId, name, value, interpreterGroupId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'ANGULAR_OBJECT_UPDATED',\n\t        data: {\n\t          noteId: noteId,\n\t          paragraphId: paragraphId,\n\t          name: name,\n\t          value: value,\n\t          interpreterGroupId: interpreterGroupId\n\t        }\n\t      });\n\t    },\n\t\n\t    clientBindAngularObject: function clientBindAngularObject(noteId, name, value, paragraphId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'ANGULAR_OBJECT_CLIENT_BIND',\n\t        data: {\n\t          noteId: noteId,\n\t          name: name,\n\t          value: value,\n\t          paragraphId: paragraphId\n\t        }\n\t      });\n\t    },\n\t\n\t    clientUnbindAngularObject: function clientUnbindAngularObject(noteId, name, paragraphId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'ANGULAR_OBJECT_CLIENT_UNBIND',\n\t        data: {\n\t          noteId: noteId,\n\t          name: name,\n\t          paragraphId: paragraphId\n\t        }\n\t      });\n\t    },\n\t\n\t    cancelParagraphRun: function cancelParagraphRun(paragraphId) {\n\t      websocketEvents.sendNewEvent({ op: 'CANCEL_PARAGRAPH', data: { id: paragraphId } });\n\t    },\n\t\n\t    runParagraph: function runParagraph(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'RUN_PARAGRAPH',\n\t        data: {\n\t          id: paragraphId,\n\t          title: paragraphTitle,\n\t          paragraph: paragraphData,\n\t          config: paragraphConfig,\n\t          params: paragraphParams\n\t        }\n\t      });\n\t    },\n\t\n\t    runAllParagraphs: function runAllParagraphs(noteId, paragraphs) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'RUN_ALL_PARAGRAPHS',\n\t        data: {\n\t          noteId: noteId,\n\t          paragraphs: JSON.stringify(paragraphs)\n\t        }\n\t      });\n\t    },\n\t\n\t    removeParagraph: function removeParagraph(paragraphId) {\n\t      websocketEvents.sendNewEvent({ op: 'PARAGRAPH_REMOVE', data: { id: paragraphId } });\n\t    },\n\t\n\t    clearParagraphOutput: function clearParagraphOutput(paragraphId) {\n\t      websocketEvents.sendNewEvent({ op: 'PARAGRAPH_CLEAR_OUTPUT', data: { id: paragraphId } });\n\t    },\n\t\n\t    clearAllParagraphOutput: function clearAllParagraphOutput(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'PARAGRAPH_CLEAR_ALL_OUTPUT', data: { id: noteId } });\n\t    },\n\t\n\t    completion: function completion(paragraphId, buf, cursor) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'COMPLETION',\n\t        data: {\n\t          id: paragraphId,\n\t          buf: buf,\n\t          cursor: cursor\n\t        }\n\t      });\n\t    },\n\t\n\t    commitParagraph: function commitParagraph(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'COMMIT_PARAGRAPH',\n\t        data: {\n\t          id: paragraphId,\n\t          title: paragraphTitle,\n\t          paragraph: paragraphData,\n\t          config: paragraphConfig,\n\t          params: paragraphParams\n\t        }\n\t      });\n\t    },\n\t\n\t    importNote: function importNote(note) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'IMPORT_NOTE',\n\t        data: {\n\t          note: note\n\t        }\n\t      });\n\t    },\n\t\n\t    checkpointNote: function checkpointNote(noteId, commitMessage) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'CHECKPOINT_NOTE',\n\t        data: {\n\t          noteId: noteId,\n\t          commitMessage: commitMessage\n\t        }\n\t      });\n\t    },\n\t\n\t    setNoteRevision: function setNoteRevision(noteId, revisionId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'SET_NOTE_REVISION',\n\t        data: {\n\t          noteId: noteId,\n\t          revisionId: revisionId\n\t        }\n\t      });\n\t    },\n\t\n\t    listRevisionHistory: function listRevisionHistory(noteId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'LIST_REVISION_HISTORY',\n\t        data: {\n\t          noteId: noteId\n\t        }\n\t      });\n\t    },\n\t\n\t    getNoteByRevision: function getNoteByRevision(noteId, revisionId) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'NOTE_REVISION',\n\t        data: {\n\t          noteId: noteId,\n\t          revisionId: revisionId\n\t        }\n\t      });\n\t    },\n\t\n\t    getEditorSetting: function getEditorSetting(paragraphId, replName) {\n\t      websocketEvents.sendNewEvent({\n\t        op: 'EDITOR_SETTING',\n\t        data: {\n\t          paragraphId: paragraphId,\n\t          magic: replName\n\t        }\n\t      });\n\t    },\n\t\n\t    isConnected: function isConnected() {\n\t      return websocketEvents.isConnected();\n\t    },\n\t\n\t    getNoteJobsList: function getNoteJobsList() {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_NOTE_JOBS' });\n\t    },\n\t\n\t    getUpdateNoteJobsList: function getUpdateNoteJobsList(lastUpdateServerUnixTime) {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_UPDATE_NOTE_JOBS', data: { lastUpdateUnixTime: lastUpdateServerUnixTime * 1 } });\n\t    },\n\t\n\t    unsubscribeJobManager: function unsubscribeJobManager() {\n\t      websocketEvents.sendNewEvent({ op: 'UNSUBSCRIBE_UPDATE_NOTE_JOBS' });\n\t    },\n\t\n\t    getInterpreterBindings: function getInterpreterBindings(noteId) {\n\t      websocketEvents.sendNewEvent({ op: 'GET_INTERPRETER_BINDINGS', data: { noteId: noteId } });\n\t    },\n\t\n\t    saveInterpreterBindings: function saveInterpreterBindings(noteId, selectedSettingIds) {\n\t      websocketEvents.sendNewEvent({ op: 'SAVE_INTERPRETER_BINDINGS',\n\t        data: { noteId: noteId, selectedSettingIds: selectedSettingIds } });\n\t    },\n\t\n\t    listConfigurations: function listConfigurations() {\n\t      websocketEvents.sendNewEvent({ op: 'LIST_CONFIGURATIONS' });\n\t    },\n\t\n\t    getInterpreterSettings: function getInterpreterSettings() {\n\t      websocketEvents.sendNewEvent({ op: 'GET_INTERPRETER_SETTINGS' });\n\t    }\n\t\n\t  };\n\t}\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').factory('websocketEvents', websocketEvents);\n\t\n\twebsocketEvents.$inject = ['$rootScope', '$websocket', '$location', 'baseUrlSrv'];\n\t\n\tfunction websocketEvents($rootScope, $websocket, $location, baseUrlSrv) {\n\t  var websocketCalls = {};\n\t  var pingIntervalId;\n\t\n\t  websocketCalls.ws = $websocket(baseUrlSrv.getWebsocketUrl());\n\t  websocketCalls.ws.reconnectIfNotNormalClose = true;\n\t\n\t  websocketCalls.ws.onOpen(function () {\n\t    console.log('Websocket created');\n\t    $rootScope.$broadcast('setConnectedStatus', true);\n\t    pingIntervalId = setInterval(function () {\n\t      websocketCalls.sendNewEvent({ op: 'PING' });\n\t    }, 10000);\n\t  });\n\t\n\t  websocketCalls.sendNewEvent = function (data) {\n\t    if ($rootScope.ticket !== undefined) {\n\t      data.principal = $rootScope.ticket.principal;\n\t      data.ticket = $rootScope.ticket.ticket;\n\t      data.roles = $rootScope.ticket.roles;\n\t    } else {\n\t      data.principal = '';\n\t      data.ticket = '';\n\t      data.roles = '';\n\t    }\n\t    console.log('Send >> %o, %o, %o, %o, %o', data.op, data.principal, data.ticket, data.roles, data);\n\t    websocketCalls.ws.send(JSON.stringify(data));\n\t  };\n\t\n\t  websocketCalls.isConnected = function () {\n\t    return websocketCalls.ws.socket.readyState === 1;\n\t  };\n\t\n\t  websocketCalls.ws.onMessage(function (event) {\n\t    var payload;\n\t    if (event.data) {\n\t      payload = angular.fromJson(event.data);\n\t    }\n\t    console.log('Receive << %o, %o', payload.op, payload);\n\t    var op = payload.op;\n\t    var data = payload.data;\n\t    if (op === 'NOTE') {\n\t      $rootScope.$broadcast('setNoteContent', data.note);\n\t    } else if (op === 'NEW_NOTE') {\n\t      $location.path('/notebook/' + data.note.id);\n\t    } else if (op === 'NOTES_INFO') {\n\t      $rootScope.$broadcast('setNoteMenu', data.notes);\n\t    } else if (op === 'LIST_NOTE_JOBS') {\n\t      $rootScope.$broadcast('setNoteJobs', data.noteJobs);\n\t    } else if (op === 'LIST_UPDATE_NOTE_JOBS') {\n\t      $rootScope.$broadcast('setUpdateNoteJobs', data.noteRunningJobs);\n\t    } else if (op === 'AUTH_INFO') {\n\t      var btn = [];\n\t      if ($rootScope.ticket.roles === '[]') {\n\t        btn = [{\n\t          label: 'Close',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t          }\n\t        }];\n\t      } else {\n\t        btn = [{\n\t          label: 'Login',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            angular.element('#loginModal').modal({\n\t              show: 'true'\n\t            });\n\t          }\n\t        }, {\n\t          label: 'Cancel',\n\t          action: function action(dialog) {\n\t            dialog.close();\n\t            // using $rootScope.apply to trigger angular digest cycle\n\t            // changing $location.path inside bootstrap modal wont trigger digest\n\t            $rootScope.$apply(function () {\n\t              $location.path('/');\n\t            });\n\t          }\n\t        }];\n\t      }\n\t\n\t      BootstrapDialog.show({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: 'Insufficient privileges',\n\t        message: data.info.toString(),\n\t        buttons: btn\n\t      });\n\t    } else if (op === 'PARAGRAPH') {\n\t      $rootScope.$broadcast('updateParagraph', data);\n\t    } else if (op === 'PARAGRAPH_APPEND_OUTPUT') {\n\t      $rootScope.$broadcast('appendParagraphOutput', data);\n\t    } else if (op === 'PARAGRAPH_UPDATE_OUTPUT') {\n\t      $rootScope.$broadcast('updateParagraphOutput', data);\n\t    } else if (op === 'PROGRESS') {\n\t      $rootScope.$broadcast('updateProgress', data);\n\t    } else if (op === 'COMPLETION_LIST') {\n\t      $rootScope.$broadcast('completionList', data);\n\t    } else if (op === 'EDITOR_SETTING') {\n\t      $rootScope.$broadcast('editorSetting', data);\n\t    } else if (op === 'ANGULAR_OBJECT_UPDATE') {\n\t      $rootScope.$broadcast('angularObjectUpdate', data);\n\t    } else if (op === 'ANGULAR_OBJECT_REMOVE') {\n\t      $rootScope.$broadcast('angularObjectRemove', data);\n\t    } else if (op === 'APP_APPEND_OUTPUT') {\n\t      $rootScope.$broadcast('appendAppOutput', data);\n\t    } else if (op === 'APP_UPDATE_OUTPUT') {\n\t      $rootScope.$broadcast('updateAppOutput', data);\n\t    } else if (op === 'APP_LOAD') {\n\t      $rootScope.$broadcast('appLoad', data);\n\t    } else if (op === 'APP_STATUS_CHANGE') {\n\t      $rootScope.$broadcast('appStatusChange', data);\n\t    } else if (op === 'LIST_REVISION_HISTORY') {\n\t      $rootScope.$broadcast('listRevisionHistory', data);\n\t    } else if (op === 'NOTE_REVISION') {\n\t      $rootScope.$broadcast('noteRevision', data);\n\t    } else if (op === 'INTERPRETER_BINDINGS') {\n\t      $rootScope.$broadcast('interpreterBindings', data);\n\t    } else if (op === 'ERROR_INFO') {\n\t      BootstrapDialog.show({\n\t        closable: false,\n\t        closeByBackdrop: false,\n\t        closeByKeyboard: false,\n\t        title: 'Details',\n\t        message: data.info.toString(),\n\t        buttons: [{\n\t          // close all the dialogs when there are error on running all paragraphs\n\t          label: 'Close',\n\t          action: function action() {\n\t            BootstrapDialog.closeAll();\n\t          }\n\t        }]\n\t      });\n\t    } else if (op === 'SESSION_LOGOUT') {\n\t      $rootScope.$broadcast('session_logout', data);\n\t    } else if (op === 'CONFIGURATIONS_INFO') {\n\t      $rootScope.$broadcast('configurationsInfo', data);\n\t    } else if (op === 'INTERPRETER_SETTINGS') {\n\t      $rootScope.$broadcast('interpreterSettings', data);\n\t    } else if (op === 'PARAGRAPH_ADDED') {\n\t      $rootScope.$broadcast('addParagraph', data.paragraph, data.index);\n\t    } else if (op === 'PARAGRAPH_REMOVED') {\n\t      $rootScope.$broadcast('removeParagraph', data.id);\n\t    } else if (op === 'PARAGRAPH_MOVED') {\n\t      $rootScope.$broadcast('moveParagraph', data.id, data.index);\n\t    } else if (op === 'NOTE_UPDATED') {\n\t      $rootScope.$broadcast('updateNote', data.name, data.config, data.info);\n\t    } else if (op === 'SET_NOTE_REVISION') {\n\t      $rootScope.$broadcast('setNoteRevisionResult', data);\n\t    }\n\t  });\n\t\n\t  websocketCalls.ws.onError(function (event) {\n\t    console.log('error message: ', event);\n\t    $rootScope.$broadcast('setConnectedStatus', false);\n\t  });\n\t\n\t  websocketCalls.ws.onClose(function (event) {\n\t    console.log('close message: ', event);\n\t    if (pingIntervalId !== undefined) {\n\t      clearInterval(pingIntervalId);\n\t      pingIntervalId = undefined;\n\t    }\n\t    $rootScope.$broadcast('setConnectedStatus', false);\n\t  });\n\t\n\t  return websocketCalls;\n\t}\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').factory('noteListDataFactory', noteListDataFactory);\n\t\n\tnoteListDataFactory.$inject = ['TRASH_FOLDER_ID'];\n\t\n\tfunction noteListDataFactory(TRASH_FOLDER_ID) {\n\t  var notes = {\n\t    root: { children: [] },\n\t    flatList: [],\n\t    flatFolderMap: {},\n\t\n\t    setNotes: function setNotes(notesList) {\n\t      // a flat list to boost searching\n\t      notes.flatList = _.map(notesList, function (note) {\n\t        note.isTrash = note.name ? note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n\t        return note;\n\t      });\n\t\n\t      // construct the folder-based tree\n\t      notes.root = { children: [] };\n\t      notes.flatFolderMap = {};\n\t      _.reduce(notesList, function (root, note) {\n\t        var noteName = note.name || note.id;\n\t        var nodes = noteName.match(/([^\\/][^\\/]*)/g);\n\t\n\t        // recursively add nodes\n\t        addNode(root, nodes, note.id);\n\t\n\t        return root;\n\t      }, notes.root);\n\t    }\n\t  };\n\t\n\t  var addNode = function addNode(curDir, nodes, noteId) {\n\t    if (nodes.length === 1) {\n\t      // the leaf\n\t      curDir.children.push({\n\t        name: nodes[0],\n\t        id: noteId,\n\t        path: curDir.id ? curDir.id + '/' + nodes[0] : nodes[0],\n\t        isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n\t      });\n\t    } else {\n\t      // a folder node\n\t      var node = nodes.shift();\n\t      var dir = _.find(curDir.children, function (c) {\n\t        return c.name === node && c.children !== undefined;\n\t      });\n\t      if (dir !== undefined) {\n\t        // found an existing dir\n\t        addNode(dir, nodes, noteId);\n\t      } else {\n\t        var newDir = {\n\t          id: curDir.id ? curDir.id + '/' + node : node,\n\t          name: node,\n\t          hidden: true,\n\t          children: [],\n\t          isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n\t        };\n\t\n\t        // add the folder to flat folder map\n\t        notes.flatFolderMap[newDir.id] = newDir;\n\t\n\t        curDir.children.push(newDir);\n\t        addNode(newDir, nodes, noteId);\n\t      }\n\t    }\n\t  };\n\t\n\t  return notes;\n\t}\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('baseUrlSrv', baseUrlSrv);\n\t\n\tfunction baseUrlSrv() {\n\t  this.getPort = function () {\n\t    var port = Number(location.port);\n\t    if (!port) {\n\t      port = 80;\n\t      if (location.protocol === 'https:') {\n\t        port = 443;\n\t      }\n\t    }\n\t    //Exception for when running locally via grunt\n\t    if (port === 9000) {\n\t      port = (8080);\n\t    }\n\t    return port;\n\t  };\n\t\n\t  this.getWebsocketUrl = function () {\n\t    var wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';\n\t    return wsProtocol + '//' + location.hostname + ':' + this.getPort() + skipTrailingSlash(location.pathname) + '/ws';\n\t  };\n\t\n\t  this.getRestApiBase = function () {\n\t    return location.protocol + '//' + location.hostname + ':' + this.getPort() + skipTrailingSlash(location.pathname) + '/api';\n\t  };\n\t\n\t  var skipTrailingSlash = function skipTrailingSlash(path) {\n\t    return path.replace(/\\/$/, '');\n\t  };\n\t}\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('browserDetectService', browserDetectService);\n\t\n\tfunction browserDetectService() {\n\t  this.detectIE = function () {\n\t    var ua = window.navigator.userAgent;\n\t    var msie = ua.indexOf('MSIE ');\n\t    if (msie > 0) {\n\t      // IE 10 or older => return version number\n\t      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n\t    }\n\t    var trident = ua.indexOf('Trident/');\n\t    if (trident > 0) {\n\t      // IE 11 => return version number\n\t      var rv = ua.indexOf('rv:');\n\t      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n\t    }\n\t    var edge = ua.indexOf('Edge/');\n\t    if (edge > 0) {\n\t      // IE 12 (aka Edge) => return version number\n\t      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n\t    }\n\t    // other browser\n\t    return false;\n\t  };\n\t}\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('saveAsService', saveAsService);\n\t\n\tsaveAsService.$inject = ['browserDetectService'];\n\t\n\tfunction saveAsService(browserDetectService) {\n\t  this.saveAs = function (content, filename, extension) {\n\t    var BOM = '\\uFEFF';\n\t    if (browserDetectService.detectIE()) {\n\t      angular.element('body').append('<iframe id=\"SaveAsId\" style=\"display: none\"></iframe>');\n\t      var frameSaveAs = angular.element('body > iframe#SaveAsId')[0].contentWindow;\n\t      content = BOM + content;\n\t      frameSaveAs.document.open('text/json', 'replace');\n\t      frameSaveAs.document.write(content);\n\t      frameSaveAs.document.close();\n\t      frameSaveAs.focus();\n\t      var t1 = Date.now();\n\t      frameSaveAs.document.execCommand('SaveAs', false, filename + '.' + extension);\n\t      var t2 = Date.now();\n\t\n\t      //This means, this version of IE dosen't support auto download of a file with extension provided in param\n\t      //falling back to \".txt\"\n\t      if (t1 === t2) {\n\t        frameSaveAs.document.execCommand('SaveAs', true, filename + '.txt');\n\t      }\n\t      angular.element('body > iframe#SaveAsId').remove();\n\t    } else {\n\t      content = 'data:image/svg;charset=utf-8,' + BOM + encodeURIComponent(content);\n\t      angular.element('body').append('<a id=\"SaveAsId\"></a>');\n\t      var saveAsElement = angular.element('body > a#SaveAsId');\n\t      saveAsElement.attr('href', content);\n\t      saveAsElement.attr('download', filename + '.' + extension);\n\t      saveAsElement.attr('target', '_blank');\n\t      saveAsElement[0].click();\n\t      saveAsElement.remove();\n\t    }\n\t  };\n\t}\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('searchService', searchService);\n\t\n\tsearchService.$inject = ['$resource', 'baseUrlSrv'];\n\t\n\tfunction searchService($resource, baseUrlSrv) {\n\t  this.search = function (term) {\n\t    this.searchTerm = term.q;\n\t    console.log('Searching for: %o', term.q);\n\t    if (!term.q) {\n\t      //TODO(bzz): empty string check\n\t      return;\n\t    }\n\t    var encQuery = window.encodeURIComponent(term.q);\n\t    return $resource(baseUrlSrv.getRestApiBase() + '/notebook/search?q=' + encQuery, {}, {\n\t      query: { method: 'GET' }\n\t    });\n\t  };\n\t\n\t  this.searchTerm = '';\n\t}\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('LoginCtrl', LoginCtrl);\n\t\n\tLoginCtrl.$inject = ['$scope', '$rootScope', '$http', '$httpParamSerializer', 'baseUrlSrv', '$location', '$timeout'];\n\tfunction LoginCtrl($scope, $rootScope, $http, $httpParamSerializer, baseUrlSrv, $location, $timeout) {\n\t\n\t  $scope.SigningIn = false;\n\t  $scope.loginParams = {};\n\t  $scope.login = function () {\n\t\n\t    $scope.SigningIn = true;\n\t    $http({\n\t      method: 'POST',\n\t      url: baseUrlSrv.getRestApiBase() + '/login',\n\t      headers: {\n\t        'Content-Type': 'application/x-www-form-urlencoded'\n\t      },\n\t      data: $httpParamSerializer({\n\t        'userName': $scope.loginParams.userName,\n\t        'password': $scope.loginParams.password\n\t      })\n\t    }).then(function successCallback(response) {\n\t      $rootScope.ticket = response.data.body;\n\t      angular.element('#loginModal').modal('toggle');\n\t      $rootScope.$broadcast('loginSuccess', true);\n\t      $rootScope.userName = $scope.loginParams.userName;\n\t      $scope.SigningIn = false;\n\t\n\t      //redirect to the page from where the user originally was\n\t      if ($location.search() && $location.search()['ref']) {\n\t        $timeout(function () {\n\t          var redirectLocation = $location.search()['ref'];\n\t          $location.$$search = {};\n\t          $location.path(redirectLocation);\n\t        }, 100);\n\t      }\n\t    }, function errorCallback(errorResponse) {\n\t      $scope.loginParams.errorText = 'The username and password that you entered don\\'t match.';\n\t      $scope.SigningIn = false;\n\t    });\n\t  };\n\t\n\t  var initValues = function initValues() {\n\t    $scope.loginParams = {\n\t      userName: '',\n\t      password: ''\n\t    };\n\t  };\n\t\n\t  //handle session logout message received from WebSocket\n\t  $rootScope.$on('session_logout', function (event, data) {\n\t    if ($rootScope.userName !== '') {\n\t      $rootScope.userName = '';\n\t      $rootScope.ticket = undefined;\n\t\n\t      setTimeout(function () {\n\t        $scope.loginParams = {};\n\t        $scope.loginParams.errorText = data.info;\n\t        angular.element('.nav-login-btn').click();\n\t      }, 1000);\n\t      var locationPath = $location.path();\n\t      $location.path('/').search('ref', locationPath);\n\t    }\n\t  });\n\t\n\t  /*\n\t   ** $scope.$on functions below\n\t   */\n\t  $scope.$on('initLoginValues', function () {\n\t    initValues();\n\t  });\n\t}\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('ElasticInputCtrl', ElasticInputCtrl);\n\t\n\tfunction ElasticInputCtrl() {\n\t  var vm = this;\n\t  vm.showEditor = false;\n\t  vm.value = '';\n\t}\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('noteActionSrv', noteActionSrv);\n\t\n\tnoteActionSrv.$inject = ['websocketMsgSrv', '$location', 'renameSrv', 'noteListDataFactory'];\n\t\n\tfunction noteActionSrv(websocketMsgSrv, $location, renameSrv, noteListDataFactory) {\n\t  this.moveNoteToTrash = function (noteId, redirectToHome) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: 'Move this note to trash?',\n\t      message: 'This note will be moved to <strong>trash</strong>.',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.moveNoteToTrash(noteId);\n\t          if (redirectToHome) {\n\t            $location.path('/');\n\t          }\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.moveFolderToTrash = function (folderId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: 'Move this folder to trash?',\n\t      message: 'This folder will be moved to <strong>trash</strong>.',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.moveFolderToTrash(folderId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.removeNote = function (noteId, redirectToHome) {\n\t    BootstrapDialog.confirm({\n\t      type: BootstrapDialog.TYPE_WARNING,\n\t      closable: true,\n\t      title: 'WARNING! This note will be removed permanently',\n\t      message: 'This cannot be undone. Are you sure?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.deleteNote(noteId);\n\t          if (redirectToHome) {\n\t            $location.path('/');\n\t          }\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.removeFolder = function (folderId) {\n\t    BootstrapDialog.confirm({\n\t      type: BootstrapDialog.TYPE_WARNING,\n\t      closable: true,\n\t      title: 'WARNING! This folder will be removed permanently',\n\t      message: 'This cannot be undone. Are you sure?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.removeFolder(folderId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.restoreAll = function () {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: 'Are you sure want to restore all notes in the trash?',\n\t      message: 'Folders and notes in the trash will be ' + '<strong>merged</strong> into their original position.',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.restoreAll();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.emptyTrash = function () {\n\t    BootstrapDialog.confirm({\n\t      type: BootstrapDialog.TYPE_WARNING,\n\t      closable: true,\n\t      title: 'WARNING! Notes under trash will be removed permanently',\n\t      message: 'This cannot be undone. Are you sure?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.emptyTrash();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.clearAllParagraphOutput = function (noteId) {\n\t    BootstrapDialog.confirm({\n\t      closable: true,\n\t      title: '',\n\t      message: 'Do you want to clear all output?',\n\t      callback: function callback(result) {\n\t        if (result) {\n\t          websocketMsgSrv.clearAllParagraphOutput(noteId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  this.renameNote = function (noteId, notePath) {\n\t    renameSrv.openRenameModal({\n\t      title: 'Rename note',\n\t      oldName: notePath,\n\t      callback: function callback(newName) {\n\t        websocketMsgSrv.renameNote(noteId, newName);\n\t      }\n\t    });\n\t  };\n\t\n\t  this.renameFolder = function (folderId) {\n\t    renameSrv.openRenameModal({\n\t      title: 'Rename folder',\n\t      oldName: folderId,\n\t      callback: function callback(newName) {\n\t        var newFolderId = normalizeFolderId(newName);\n\t        if (_.has(noteListDataFactory.flatFolderMap, newFolderId)) {\n\t          BootstrapDialog.confirm({\n\t            type: BootstrapDialog.TYPE_WARNING,\n\t            closable: true,\n\t            title: 'WARNING! The folder will be MERGED',\n\t            message: 'The folder will be merged into <strong>' + newFolderId + '</strong>. Are you sure?',\n\t            callback: function callback(result) {\n\t              if (result) {\n\t                websocketMsgSrv.renameFolder(folderId, newFolderId);\n\t              }\n\t            }\n\t          });\n\t        } else {\n\t          websocketMsgSrv.renameFolder(folderId, newFolderId);\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  function normalizeFolderId(folderId) {\n\t    folderId = folderId.trim();\n\t\n\t    while (folderId.indexOf('\\\\') > -1) {\n\t      folderId = folderId.replace('\\\\', '/');\n\t    }\n\t\n\t    while (folderId.indexOf('///') > -1) {\n\t      folderId = folderId.replace('///', '/');\n\t    }\n\t\n\t    folderId = folderId.replace('//', '/');\n\t\n\t    if (folderId === '/') {\n\t      return '/';\n\t    }\n\t\n\t    if (folderId[0] === '/') {\n\t      folderId = folderId.substring(1);\n\t    }\n\t\n\t    if (folderId.slice(-1) === '/') {\n\t      folderId = folderId.slice(0, -1);\n\t    }\n\t\n\t    return folderId;\n\t  }\n\t}\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('noteVarShareService', noteVarShareService);\n\t\n\tnoteVarShareService.$inject = [];\n\t\n\tfunction noteVarShareService() {\n\t  var store = {};\n\t\n\t  this.clear = function () {\n\t    store = {};\n\t  };\n\t\n\t  this.put = function (key, value) {\n\t    store[key] = value;\n\t  };\n\t\n\t  this.get = function (key) {\n\t    return store[key];\n\t  };\n\t\n\t  this.del = function (key) {\n\t    var v = store[key];\n\t    delete store[key];\n\t    return v;\n\t  };\n\t}\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').controller('RenameCtrl', RenameCtrl);\n\t\n\tRenameCtrl.$inject = ['$scope'];\n\t\n\tfunction RenameCtrl($scope) {\n\t  var self = this;\n\t\n\t  $scope.params = { newName: '' };\n\t  $scope.isValid = true;\n\t\n\t  $scope.rename = function () {\n\t    angular.element('#renameModal').modal('hide');\n\t    self.callback($scope.params.newName);\n\t  };\n\t\n\t  $scope.$on('openRenameModal', function (event, options) {\n\t    self.validator = options.validator || defaultValidator;\n\t    self.callback = options.callback || function () {};\n\t\n\t    $scope.title = options.title || 'Rename';\n\t    $scope.params.newName = options.oldName || '';\n\t    $scope.validate = function () {\n\t      $scope.isValid = self.validator($scope.params.newName);\n\t    };\n\t\n\t    angular.element('#renameModal').modal('show');\n\t  });\n\t\n\t  function defaultValidator(str) {\n\t    return !!str.trim();\n\t  }\n\t}\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\tangular.module('zeppelinWebApp').service('renameSrv', renameSrv);\n\t\n\trenameSrv.$inject = ['$rootScope'];\n\t\n\tfunction renameSrv($rootScope) {\n\t  var self = this;\n\t\n\t  /**\n\t   * <options schema>\n\t   * title: string - Modal title\n\t   * oldName: string - name to initialize input\n\t   * callback: (newName: string)=>void - callback onButtonClick\n\t   * validator: (str: string)=>boolean - input validator\n\t   */\n\t  self.openRenameModal = function (options) {\n\t    $rootScope.$broadcast('openRenameModal', options);\n\t  };\n\t}\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/*\n\t * Licensed under the Apache License, Version 2.0 (the \"License\");\n\t * you may not use this file except in compliance with the License.\n\t * You may obtain a copy of the License at\n\t *\n\t *     http://www.apache.org/licenses/LICENSE-2.0\n\t *\n\t * Unless required by applicable law or agreed to in writing, software\n\t * distributed under the License is distributed on an \"AS IS\" BASIS,\n\t * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t * See the License for the specific language governing permissions and\n\t * limitations under the License.\n\t */\n\t\n\t(function () {\n\t\n\t  angular.module('zeppelinWebApp').service('heliumService', heliumService);\n\t\n\t  heliumService.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\t\n\t  function heliumService($http, baseUrlSrv, ngToast) {\n\t\n\t    var url = baseUrlSrv.getRestApiBase() + '/helium/visualizations/load';\n\t    if ((undefined)) {\n\t      url = url + '?refresh=true';\n\t    }\n\t    var visualizations = [];\n\t\n\t    // load should be promise\n\t    this.load = $http.get(url).success(function (response) {\n\t      if (response.substring(0, 'ERROR:'.length) !== 'ERROR:') {\n\t        eval(response);\n\t      } else {\n\t        console.error(response);\n\t      }\n\t    });\n\t\n\t    this.get = function () {\n\t      return visualizations;\n\t    };\n\t\n\t    this.getVisualizationOrder = function () {\n\t      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder');\n\t    };\n\t\n\t    this.setVisualizationOrder = function (list) {\n\t      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder', list);\n\t    };\n\t\n\t    this.getAllPackageInfo = function () {\n\t      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/all');\n\t    };\n\t\n\t    this.enable = function (name, artifact) {\n\t      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/enable/' + name, artifact);\n\t    };\n\t\n\t    this.disable = function (name) {\n\t      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/disable/' + name);\n\t    };\n\t  };\n\t})();\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// app.a01a462d75c8f7e54e09.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a01a462d75c8f7e54e09","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport './app/app.js';\nimport './app/app.controller.js';\nimport './app/home/home.controller.js';\nimport './app/handsontable/handsonHelper.js';\nimport './app/notebook/notebook.controller.js';\n\n/** start: global variable `zeppelin` related files */\nimport './app/tabledata/tabledata.js';\nimport './app/tabledata/transformation.js';\nimport './app/tabledata/pivot.js';\nimport './app/tabledata/passthrough.js';\nimport './app/tabledata/columnselector.js';\nimport './app/visualization/visualization.js';\nimport './app/visualization/builtins/visualization-table.js';\nimport './app/visualization/builtins/visualization-nvd3chart.js';\nimport './app/visualization/builtins/visualization-barchart.js';\nimport './app/visualization/builtins/visualization-piechart.js';\nimport './app/visualization/builtins/visualization-areachart.js';\nimport './app/visualization/builtins/visualization-linechart.js';\nimport './app/visualization/builtins/visualization-scatterchart.js';\n/** end: global variable `zeppelin` related files */\n\nimport './app/jobmanager/jobmanager.controller.js';\nimport './app/jobmanager/jobs/job.controller.js';\nimport './app/jobmanager/jobmanager.filter.js';\nimport './app/interpreter/interpreter.controller.js';\nimport './app/interpreter/interpreter.filter.js';\nimport './app/credential/credential.controller.js';\nimport './app/configuration/configuration.controller.js';\nimport './app/notebook/paragraph/paragraph.controller.js';\nimport './app/notebook/paragraph/result/result.controller.js';\nimport './app/search/result-list.controller.js';\nimport './app/notebookRepos/notebookRepos.controller.js';\nimport './app/helium/helium.controller.js';\nimport './components/arrayOrderingSrv/arrayOrdering.service.js';\nimport './components/clipboard/clipboard.controller.js';\nimport './components/navbar/navbar.controller.js';\nimport './components/ngescape/ngescape.directive.js';\nimport './components/interpreter/interpreter.directive.js';\nimport './components/expandCollapse/expandCollapse.directive.js';\nimport './components/noteName-create/notename.controller.js';\nimport './components/noteName-import/notenameImport.controller.js';\nimport './components/popover-html-unsafe/popover-html-unsafe.directive.js';\nimport './components/popover-html-unsafe/popover-html-unsafe-popup.directive.js';\nimport './components/editor/codeEditor.directive.js';\nimport './components/ngenter/ngenter.directive.js';\nimport './components/dropdowninput/dropdowninput.directive.js';\nimport './components/resizable/resizable.directive.js';\nimport './components/noteName-create/visible.directive.js';\nimport './components/websocketEvents/websocketMsg.service.js';\nimport './components/websocketEvents/websocketEvents.factory.js';\nimport './components/noteListDataFactory/noteList.datafactory.js';\nimport './components/baseUrl/baseUrl.service.js';\nimport './components/browser-detect/browserDetect.service.js';\nimport './components/saveAs/saveAs.service.js';\nimport './components/searchService/search.service.js';\nimport './components/login/login.controller.js';\nimport './components/elasticInputCtrl/elasticInput.controller.js';\nimport './components/noteAction/noteAction.service.js';\nimport './components/notevarshareService/notevarshare.service.js';\nimport './components/rename/rename.controller.js';\nimport './components/rename/rename.service.js';\nimport './components/helium/helium.service.js';\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/*\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License.  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar zeppelinWebApp = angular.module('zeppelinWebApp', [\n  'ngCookies',\n  'ngAnimate',\n  'ngRoute',\n  'ngSanitize',\n  'angular-websocket',\n  'ui.ace',\n  'ui.bootstrap',\n  'as.sortable',\n  'ngTouch',\n  'ngDragDrop',\n  'angular.filter',\n  'monospaced.elastic',\n  'puElasticInput',\n  'xeditable',\n  'ngToast',\n  'focus-if',\n  'ngResource',\n  'ngclipboard'\n])\n  .filter('breakFilter', function() {\n    return function(text) {\n      if (!!text) {\n        return text.replace(/\\n/g, '<br />');\n      }\n    };\n  })\n  .config(function($httpProvider, $routeProvider, ngToastProvider) {\n    // withCredentials when running locally via grunt\n    $httpProvider.defaults.withCredentials = true;\n\n    var visBundleLoad = {\n      load: ['heliumService', function(heliumService) {\n        return heliumService.load;\n      }]\n    };\n\n    $routeProvider\n      .when('/', {\n        templateUrl: 'app/home/home.html'\n      })\n      .when('/notebook/:noteId', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/notebook/:noteId/paragraph?=:paragraphId', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/notebook/:noteId/paragraph/:paragraphId?', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/notebook/:noteId/revision/:revisionId', {\n        templateUrl: 'app/notebook/notebook.html',\n        controller: 'NotebookCtrl',\n        resolve: visBundleLoad\n      })\n      .when('/jobmanager', {\n        templateUrl: 'app/jobmanager/jobmanager.html',\n        controller: 'JobmanagerCtrl'\n      })\n      .when('/interpreter', {\n        templateUrl: 'app/interpreter/interpreter.html',\n        controller: 'InterpreterCtrl'\n      })\n      .when('/notebookRepos', {\n        templateUrl: 'app/notebookRepos/notebookRepos.html',\n        controller: 'NotebookReposCtrl',\n        controllerAs: 'noterepo'\n      })\n      .when('/credential', {\n        templateUrl: 'app/credential/credential.html',\n        controller: 'CredentialCtrl'\n      })\n      .when('/helium', {\n        templateUrl: 'app/helium/helium.html',\n        controller: 'HeliumCtrl'\n      })\n      .when('/configuration', {\n        templateUrl: 'app/configuration/configuration.html',\n        controller: 'ConfigurationCtrl'\n      })\n      .when('/search/:searchTerm', {\n        templateUrl: 'app/search/result-list.html',\n        controller: 'SearchResultCtrl'\n      })\n      .otherwise({\n        redirectTo: '/'\n      });\n\n    ngToastProvider.configure({\n      dismissButton: true,\n      dismissOnClick: false,\n      combineDuplications: true,\n      timeout: 6000\n    });\n  })\n\n  //handel logout on API failure\n  .config(function ($httpProvider, $provide) {\n    $provide.factory('httpInterceptor', function ($q, $rootScope) {\n      return {\n        'responseError': function (rejection) {\n          if (rejection.status === 405) {\n            var data = {};\n            data.info = '';\n            $rootScope.$broadcast('session_logout', data);\n          }\n          $rootScope.$broadcast('httpResponseError', rejection);\n          return $q.reject(rejection);\n        }\n      };\n    });\n    $httpProvider.interceptors.push('httpInterceptor');\n  })\n  .constant('TRASH_FOLDER_ID', '~Trash');\n\nfunction auth() {\n  var $http = angular.injector(['ng']).get('$http');\n  var baseUrlSrv = angular.injector(['zeppelinWebApp']).get('baseUrlSrv');\n  // withCredentials when running locally via grunt\n  $http.defaults.withCredentials = true;\n  jQuery.ajaxSetup({\n    dataType: 'json',\n    xhrFields: {\n      withCredentials: true\n    },\n    crossDomain: true\n  });\n  return $http.get(baseUrlSrv.getRestApiBase() + '/security/ticket').then(function(response) {\n    zeppelinWebApp.run(function($rootScope) {\n      $rootScope.ticket = angular.fromJson(response.data).body;\n    });\n  }, function(errorResponse) {\n    // Handle error case\n  });\n}\n\nfunction bootstrapApplication() {\n  zeppelinWebApp.run(function($rootScope, $location) {\n    $rootScope.$on('$routeChangeStart', function(event, next, current) {\n      if (!$rootScope.ticket && next.$$route && !next.$$route.publicAccess) {\n        $location.path('/');\n      }\n    });\n  });\n  angular.bootstrap(document, ['zeppelinWebApp']);\n}\n\nangular.element(document).ready(function () {\n  auth().then(bootstrapApplication)\n})\n\n// See ZEPPELIN-2577. No graphs visible on IE 11\n// Polyfill. https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\nif (!String.prototype.endsWith) {\n  // eslint-disable-next-line no-extend-native\n  String.prototype.endsWith = function(searchString, position) {\n    let subjectString = this.toString()\n    if (typeof position !== 'number' || !isFinite(position) ||\n        Math.floor(position) !== position || position > subjectString.length) {\n      position = subjectString.length\n    }\n    position -= searchString.length\n    let lastIndex = subjectString.indexOf(searchString, position)\n    return lastIndex !== -1 && lastIndex === position\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('MainCtrl', MainCtrl);\n\nMainCtrl.$inject = ['$scope', '$rootScope', '$window', 'arrayOrderingSrv'];\n\nfunction MainCtrl($scope, $rootScope, $window, arrayOrderingSrv) {\n  $scope.looknfeel = 'default';\n\n  var init = function() {\n    $scope.asIframe = (($window.location.href.indexOf('asIframe') > -1) ? true : false);\n  };\n\n  init();\n\n  $rootScope.$on('setIframe', function(event, data) {\n    if (!event.defaultPrevented) {\n      $scope.asIframe = data;\n      event.preventDefault();\n    }\n  });\n\n  $rootScope.$on('setLookAndFeel', function(event, data) {\n    if (!event.defaultPrevented && data && data !== '' && data !== $scope.looknfeel) {\n      $scope.looknfeel = data;\n      event.preventDefault();\n    }\n  });\n\n  // Set The lookAndFeel to default on every page\n  $rootScope.$on('$routeChangeStart', function(event, next, current) {\n    $rootScope.$broadcast('setLookAndFeel', 'default');\n  });\n\n  $rootScope.noteName = function(note) {\n    if (!_.isEmpty(note)) {\n      return arrayOrderingSrv.getNoteName(note);\n    }\n  };\n\n  BootstrapDialog.defaultOptions.onshown = function() {\n    angular.element('#' + this.id).find('.btn:last').focus();\n  };\n\n  // Remove BootstrapDialog animation\n  BootstrapDialog.configDefaultOptions({animate: false});\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('HomeCtrl', HomeCtrl);\n\nHomeCtrl.$inject = [\n  '$scope',\n  'noteListDataFactory',\n  'websocketMsgSrv',\n  '$rootScope',\n  'arrayOrderingSrv',\n  'ngToast',\n  'noteActionSrv',\n  'TRASH_FOLDER_ID'\n];\n\nfunction HomeCtrl($scope, noteListDataFactory, websocketMsgSrv, $rootScope, arrayOrderingSrv,\n                  ngToast, noteActionSrv, TRASH_FOLDER_ID) {\n  ngToast.dismiss();\n  var vm = this;\n  vm.notes = noteListDataFactory;\n  vm.websocketMsgSrv = websocketMsgSrv;\n  vm.arrayOrderingSrv = arrayOrderingSrv;\n\n  vm.notebookHome = false;\n  vm.noteCustomHome = true;\n  if ($rootScope.ticket !== undefined) {\n    vm.staticHome = false;\n  } else {\n    vm.staticHome = true;\n  }\n\n  $scope.isReloading = false;\n  $scope.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n  $scope.query = {q: ''};\n\n  $scope.initHome = function() {\n    websocketMsgSrv.getHomeNote();\n    vm.noteCustomHome = false;\n  };\n\n  $scope.reloadNoteList = function() {\n    websocketMsgSrv.reloadAllNotesFromRepo();\n    $scope.isReloadingNotes = true;\n  };\n\n  $scope.toggleFolderNode = function(node) {\n    node.hidden = !node.hidden;\n  };\n\n  angular.element('#loginModal').on('hidden.bs.modal', function(e) {\n    $rootScope.$broadcast('initLoginValues');\n  });\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteMenu', function(event, notes) {\n    $scope.isReloadingNotes = false;\n  });\n\n  $scope.$on('setNoteContent', function(event, note) {\n    if (vm.noteCustomHome) {\n      return;\n    }\n\n    if (note) {\n      vm.note = note;\n\n      // initialize look And Feel\n      $rootScope.$broadcast('setLookAndFeel', 'home');\n\n      // make it read only\n      vm.viewOnly = true;\n\n      vm.notebookHome = true;\n      vm.staticHome = false;\n    } else {\n      vm.staticHome = true;\n      vm.notebookHome = false;\n    }\n  });\n\n  $scope.renameNote = function(nodeId, nodePath) {\n    noteActionSrv.renameNote(nodeId, nodePath);\n  };\n\n  $scope.moveNoteToTrash = function(noteId) {\n    noteActionSrv.moveNoteToTrash(noteId, false);\n  };\n\n  $scope.moveFolderToTrash = function(folderId) {\n    noteActionSrv.moveFolderToTrash(folderId);\n  };\n\n  $scope.restoreNote = function(noteId) {\n    websocketMsgSrv.restoreNote(noteId);\n  };\n\n  $scope.restoreFolder = function(folderId) {\n    websocketMsgSrv.restoreFolder(folderId);\n  };\n\n  $scope.restoreAll = function() {\n    noteActionSrv.restoreAll();\n  };\n\n  $scope.renameFolder = function(node) {\n    noteActionSrv.renameFolder(node.id);\n  };\n\n  $scope.removeNote = function(noteId) {\n    noteActionSrv.removeNote(noteId, false);\n  };\n\n  $scope.removeFolder = function(folderId) {\n    noteActionSrv.removeFolder(folderId);\n  };\n\n  $scope.emptyTrash = function() {\n    noteActionSrv.emptyTrash();\n  };\n\n  $scope.clearAllParagraphOutput = function(noteId) {\n    noteActionSrv.clearAllParagraphOutput(noteId);\n  };\n\n  $scope.isFilterNote = function(note) {\n    if (!$scope.query.q) {\n      return true;\n    }\n\n    var noteName = note.name;\n    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n      return true;\n    }\n    return false;\n  };\n\n  $scope.getNoteName = function(note) {\n    return arrayOrderingSrv.getNoteName(note);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/home/home.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * HandsonHelper class\n */\nexport default class HandsonHelper {\n  constructor(columns, rows, comment) {\n    this.columns = columns || [];\n    this.rows = rows || [];\n    this.comment = comment || '';\n    this._numericValidator = this._numericValidator.bind(this);\n  };\n\n  getHandsonTableConfig(columns, columnNames, resultRows) {\n    var self = this;\n    return {\n      colHeaders: columnNames,\n      data: resultRows,\n      rowHeaders: false,\n      stretchH: 'all',\n      sortIndicator: true,\n      columns: columns,\n      columnSorting: true,\n      contextMenu: false,\n      manualColumnResize: true,\n      manualRowResize: true,\n      readOnly: true,\n      readOnlyCellClassName: '',\n      fillHandle: false,\n      fragmentSelection: true,\n      disableVisualSelection: true,\n      cells: function(ro, co, pro) {\n        var cellProperties = {};\n        var colType = columns[co].type;\n        cellProperties.renderer = function(instance, td, row, col, prop, value, cellProperties) {\n          self._cellRenderer(instance, td, row, col, prop, value, cellProperties, colType);\n        };\n        return cellProperties;\n      },\n      afterGetColHeader: function(col, TH) {\n        var instance = this;\n        var menu = self._buildDropDownMenu(columns[col].type);\n        var button = self._buildTypeSwitchButton();\n\n        self._addButtonMenuEvent(button, menu);\n\n        Handsontable.Dom.addEvent(menu, 'click', function(event) {\n          if (event.target.nodeName === 'LI') {\n            self._setColumnType(columns, event.target.data.colType, instance, col);\n          }\n        });\n        if (TH.firstChild.lastChild.nodeName === 'BUTTON') {\n          TH.firstChild.removeChild(TH.firstChild.lastChild);\n        }\n        TH.firstChild.appendChild(button);\n        TH.style['white-space'] = 'normal';\n      }\n    };\n  };\n\n  /*\n  ** Private Service Functions\n  */\n\n  _addButtonMenuEvent(button, menu) {\n    Handsontable.Dom.addEvent(button, 'click', function(event) {\n      var changeTypeMenu;\n      var position;\n      var removeMenu;\n\n      document.body.appendChild(menu);\n\n      event.preventDefault();\n      event.stopImmediatePropagation();\n\n      changeTypeMenu = document.querySelectorAll('.changeTypeMenu');\n\n      for (var i = 0, len = changeTypeMenu.length; i < len; i++) {\n        changeTypeMenu[i].style.display = 'none';\n      }\n      menu.style.display = 'block';\n      position = button.getBoundingClientRect();\n\n      menu.style.top = (position.top + (window.scrollY || window.pageYOffset)) + 2 + 'px';\n      menu.style.left = (position.left) + 'px';\n\n      removeMenu = function(event) {\n        if (menu.parentNode) {\n          menu.parentNode.removeChild(menu);\n        }\n      };\n      Handsontable.Dom.removeEvent(document, 'click', removeMenu);\n      Handsontable.Dom.addEvent(document, 'click', removeMenu);\n    });\n  }\n\n  _buildDropDownMenu(activeCellType) {\n    var menu = document.createElement('UL');\n    var types = ['text', 'numeric', 'date'];\n    var item;\n\n    menu.className = 'changeTypeMenu';\n\n    for (var i = 0, len = types.length; i < len; i++) {\n      item = document.createElement('LI');\n      if ('innerText' in item) {\n        item.innerText = types[i];\n      } else {\n        item.textContent = types[i];\n      }\n\n      item.data = {'colType': types[i]};\n\n      if (activeCellType === types[i]) {\n        item.className = 'active';\n      }\n      menu.appendChild(item);\n    }\n\n    return menu;\n  }\n\n  _buildTypeSwitchButton() {\n    var button = document.createElement('BUTTON');\n\n    button.innerHTML = '\\u25BC';\n    button.className = 'changeType';\n\n    return button;\n  }\n\n  _isNumeric(value) {\n    if (!isNaN(value)) {\n      if (value.length !== 0) {\n        if (Number(value) <= Number.MAX_SAFE_INTEGER && Number(value) >= Number.MIN_SAFE_INTEGER) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  _cellRenderer(instance, td, row, col, prop, value, cellProperties, colType) {\n    if (colType === 'numeric' && this._isNumeric(value)) {\n      cellProperties.format = '0,0.[00000]';\n      td.style.textAlign = 'left';\n      Handsontable.renderers.NumericRenderer.apply(this, arguments);\n    } else if (value.length > '%html'.length && '%html ' === value.substring(0, '%html '.length)) {\n      td.innerHTML = value.substring('%html'.length);\n    } else {\n      Handsontable.renderers.TextRenderer.apply(this, arguments);\n    }\n  }\n\n  _dateValidator(value, callback) {\n    var d = moment(value);\n    return callback(d.isValid());\n  }\n\n  _numericValidator(value, callback) {\n    return callback(this._isNumeric(value));\n  }\n\n  _setColumnType(columns, type, instance, col) {\n    columns[col].type = type;\n    this._setColumnValidator(columns, col);\n    instance.updateSettings({columns: columns});\n    instance.validateCells(null);\n    if (this._isColumnSorted(instance, col)) {\n      instance.sort(col, instance.sortOrder);\n    }\n  }\n\n  _isColumnSorted(instance, col) {\n    return instance.sortingEnabled && instance.sortColumn === col;\n  }\n\n  _setColumnValidator(columns, col) {\n    if (columns[col].type === 'numeric') {\n      columns[col].validator = this._numericValidator;\n    } else if (columns[col].type === 'date') {\n      columns[col].validator = this._dateValidator;\n    } else {\n      columns[col].validator = null;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/handsontable/handsonHelper.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NotebookCtrl', NotebookCtrl);\n\nNotebookCtrl.$inject = [\n  '$scope',\n  '$route',\n  '$routeParams',\n  '$location',\n  '$rootScope',\n  '$http',\n  'websocketMsgSrv',\n  'baseUrlSrv',\n  '$timeout',\n  'saveAsService',\n  'ngToast',\n  'noteActionSrv',\n  'noteVarShareService',\n  'TRASH_FOLDER_ID'\n];\n\nfunction NotebookCtrl($scope, $route, $routeParams, $location, $rootScope,\n                      $http, websocketMsgSrv, baseUrlSrv, $timeout, saveAsService,\n                      ngToast, noteActionSrv, noteVarShareService, TRASH_FOLDER_ID) {\n\n  ngToast.dismiss();\n\n  $scope.note = null;\n  $scope.moment = moment;\n  $scope.editorToggled = false;\n  $scope.tableToggled = false;\n  $scope.viewOnly = false;\n  $scope.showSetting = false;\n  $scope.looknfeelOption = ['default', 'simple', 'report'];\n  $scope.cronOption = [\n    {name: 'None', value: undefined},\n    {name: '1m', value: '0 0/1 * * * ?'},\n    {name: '5m', value: '0 0/5 * * * ?'},\n    {name: '1h', value: '0 0 0/1 * * ?'},\n    {name: '3h', value: '0 0 0/3 * * ?'},\n    {name: '6h', value: '0 0 0/6 * * ?'},\n    {name: '12h', value: '0 0 0/12 * * ?'},\n    {name: '1d', value: '0 0 0 * * ?'}\n  ];\n\n  $scope.interpreterSettings = [];\n  $scope.interpreterBindings = [];\n  $scope.isNoteDirty = null;\n  $scope.saveTimer = null;\n\n  var connectedOnce = false;\n  var isRevisionPath = function(path) {\n    var pattern = new RegExp('^.*\\/notebook\\/[a-zA-Z0-9_]*\\/revision\\/[a-zA-Z0-9_]*');\n    return pattern.test(path);\n  };\n\n  $scope.noteRevisions = [];\n  $scope.currentRevision = 'Head';\n  $scope.revisionView = isRevisionPath($location.path());\n\n  $scope.$on('setConnectedStatus', function(event, param) {\n    if (connectedOnce && param) {\n      initNotebook();\n    }\n    connectedOnce = true;\n  });\n\n  $scope.getCronOptionNameFromValue = function(value) {\n    if (!value) {\n      return '';\n    }\n\n    for (var o in $scope.cronOption) {\n      if ($scope.cronOption[o].value === value) {\n        return $scope.cronOption[o].name;\n      }\n    }\n    return value;\n  };\n\n  $scope.blockAnonUsers = function() {\n    var zeppelinVersion = $rootScope.zeppelinVersion;\n    var url = 'https://zeppelin.apache.org/docs/' + zeppelinVersion + '/security/notebook_authorization.html';\n    var content = 'Only authenticated user can set the permission.' +\n      '<a data-toggle=\"tooltip\" data-placement=\"top\" title=\"Learn more\" target=\"_blank\" href=' + url + '>' +\n      '<i class=\"icon-question\" />' +\n      '</a>';\n    BootstrapDialog.show({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: 'No permission',\n      message: content,\n      buttons: [{\n        label: 'Close',\n        action: function(dialog) {\n          dialog.close();\n        }\n      }]\n    });\n  };\n\n  /** Init the new controller */\n  var initNotebook = function() {\n    noteVarShareService.clear();\n    if ($routeParams.revisionId) {\n      websocketMsgSrv.getNoteByRevision($routeParams.noteId, $routeParams.revisionId);\n    } else {\n      websocketMsgSrv.getNote($routeParams.noteId);\n    }\n    websocketMsgSrv.listRevisionHistory($routeParams.noteId);\n    var currentRoute = $route.current;\n    if (currentRoute) {\n      setTimeout(\n        function() {\n          var routeParams = currentRoute.params;\n          var $id = angular.element('#' + routeParams.paragraph + '_container');\n\n          if ($id.length > 0) {\n            // adjust for navbar\n            var top = $id.offset().top - 103;\n            angular.element('html, body').scrollTo({top: top, left: 0});\n          }\n        },\n        1000\n      );\n    }\n  };\n\n  initNotebook();\n\n  $scope.focusParagraphOnClick = function(clickEvent) {\n    if (!$scope.note) {\n      return;\n    }\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      var paragraphId = $scope.note.paragraphs[i].id;\n      if (jQuery.contains(angular.element('#' + paragraphId + '_container')[0], clickEvent.target)) {\n        $scope.$broadcast('focusParagraph', paragraphId, 0, true);\n        break;\n      }\n    }\n  };\n\n  // register mouseevent handler for focus paragraph\n  document.addEventListener('click', $scope.focusParagraphOnClick);\n\n  $scope.keyboardShortcut = function(keyEvent) {\n    // handle keyevent\n    if (!$scope.viewOnly && !$scope.revisionView) {\n      $scope.$broadcast('keyEvent', keyEvent);\n    }\n  };\n\n  // register mouseevent handler for focus paragraph\n  document.addEventListener('keydown', $scope.keyboardShortcut);\n\n  $scope.paragraphOnDoubleClick = function(paragraphId) {\n    $scope.$broadcast('doubleClickParagraph', paragraphId);\n  };\n\n  // Move the note to trash and go back to the main page\n  $scope.moveNoteToTrash = function(noteId) {\n    noteActionSrv.moveNoteToTrash(noteId, true);\n  };\n\n  // Remove the note permanently if it's in the trash\n  $scope.removeNote = function(noteId) {\n    noteActionSrv.removeNote(noteId, true);\n  };\n\n  $scope.isTrash = function(note) {\n    return note ? note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n  };\n\n  //Export notebook\n  $scope.exportNote = function() {\n    var jsonContent = JSON.stringify($scope.note);\n    saveAsService.saveAs(jsonContent, $scope.note.name, 'json');\n  };\n\n  //Clone note\n  $scope.cloneNote = function(noteId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to clone this note?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.cloneNote(noteId);\n          $location.path('/');\n        }\n      }\n    });\n  };\n\n  // checkpoint/commit notebook\n  $scope.checkpointNote = function(commitMessage) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Commit note to current repository?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.checkpointNote($routeParams.noteId, commitMessage);\n        }\n      }\n    });\n    document.getElementById('note.checkpoint.message').value = '';\n  };\n\n  // set notebook head to given revision\n  $scope.setNoteRevision = function() {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Set notebook head to current revision?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.setNoteRevision($routeParams.noteId, $routeParams.revisionId);\n        }\n      }\n    });\n  };\n\n  $scope.$on('listRevisionHistory', function(event, data) {\n    console.log('received list of revisions %o', data);\n    $scope.noteRevisions = data.revisionList;\n    $scope.noteRevisions.splice(0, 0, {\n      id: 'Head',\n      message: 'Head'\n    });\n    if ($routeParams.revisionId) {\n      var index = _.findIndex($scope.noteRevisions, {'id': $routeParams.revisionId});\n      if (index > -1) {\n        $scope.currentRevision = $scope.noteRevisions[index].message;\n      }\n    }\n  });\n\n  $scope.$on('noteRevision', function(event, data) {\n    console.log('received note revision %o', data);\n    if (data.note) {\n      $scope.note = data.note;\n      initializeLookAndFeel();\n    } else {\n      $location.path('/');\n    }\n  });\n\n  $scope.$on('setNoteRevisionResult', function(event, data) {\n    console.log('received set note revision result %o', data);\n    if (data.status) {\n      $location.path('/notebook/' + $routeParams.noteId);\n    }\n  });\n\n  $scope.visitRevision = function(revision) {\n    if (revision.id) {\n      if (revision.id === 'Head') {\n        $location.path('/notebook/' + $routeParams.noteId);\n      } else {\n        $location.path('/notebook/' + $routeParams.noteId + '/revision/' + revision.id);\n      }\n    } else {\n      ngToast.danger({content: 'There is a problem with this Revision',\n        verticalPosition: 'top', dismissOnTimeout: false});\n    }\n  };\n\n  $scope.runAllParagraphs = function(noteId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Run all paragraphs?',\n      callback: function(result) {\n        if (result) {\n          const paragraphs = $scope.note.paragraphs.map(p => {\n            return {\n              id: p.id,\n              title: p.title,\n              paragraph: p.text,\n              config: p.config,\n              params: p.settings.params\n            };\n          });\n          websocketMsgSrv.runAllParagraphs(noteId, paragraphs);\n        }\n      }\n    });\n  };\n\n  $scope.saveNote = function() {\n    if ($scope.note && $scope.note.paragraphs) {\n      _.forEach($scope.note.paragraphs, function(par) {\n        angular\n          .element('#' + par.id + '_paragraphColumn_main')\n          .scope()\n          .saveParagraph(par);\n      });\n      $scope.isNoteDirty = null;\n    }\n  };\n\n  $scope.clearAllParagraphOutput = function(noteId) {\n    noteActionSrv.clearAllParagraphOutput(noteId);\n  };\n\n  $scope.toggleAllEditor = function() {\n    if ($scope.editorToggled) {\n      $scope.$broadcast('openEditor');\n    } else {\n      $scope.$broadcast('closeEditor');\n    }\n    $scope.editorToggled = !$scope.editorToggled;\n  };\n\n  $scope.showAllEditor = function() {\n    $scope.$broadcast('openEditor');\n  };\n\n  $scope.hideAllEditor = function() {\n    $scope.$broadcast('closeEditor');\n  };\n\n  $scope.toggleAllTable = function() {\n    if ($scope.tableToggled) {\n      $scope.$broadcast('openTable');\n    } else {\n      $scope.$broadcast('closeTable');\n    }\n    $scope.tableToggled = !$scope.tableToggled;\n  };\n\n  $scope.showAllTable = function() {\n    $scope.$broadcast('openTable');\n  };\n\n  $scope.hideAllTable = function() {\n    $scope.$broadcast('closeTable');\n  };\n\n  $scope.isNoteRunning = function() {\n    if (!$scope.note) { return false; }\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      const status = $scope.note.paragraphs[i].status;\n      if (status === 'PENDING' || status === 'RUNNING') {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  $scope.killSaveTimer = function() {\n    if ($scope.saveTimer) {\n      $timeout.cancel($scope.saveTimer);\n      $scope.saveTimer = null;\n    }\n  };\n\n  $scope.startSaveTimer = function() {\n    $scope.killSaveTimer();\n    $scope.isNoteDirty = true;\n    //console.log('startSaveTimer called ' + $scope.note.id);\n    $scope.saveTimer = $timeout(function() {\n      $scope.saveNote();\n    }, 10000);\n  };\n\n  angular.element(window).on('beforeunload', function(e) {\n    $scope.killSaveTimer();\n    $scope.saveNote();\n  });\n\n  $scope.setLookAndFeel = function(looknfeel) {\n    $scope.note.config.looknfeel = looknfeel;\n    if ($scope.revisionView === true) {\n      $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n    } else {\n      $scope.setConfig();\n    }\n  };\n\n  /** Set cron expression for this note **/\n  $scope.setCronScheduler = function(cronExpr) {\n    if (cronExpr) {\n      if (!$scope.note.config.cronExecutingUser) {\n        $scope.note.config.cronExecutingUser = $rootScope.ticket.principal;\n      }\n    } else {\n      $scope.note.config.cronExecutingUser = '';\n    }\n    $scope.note.config.cron = cronExpr;\n    $scope.setConfig();\n  };\n\n  /** Set the username of the user to be used to execute all notes in notebook **/\n  $scope.setCronExecutingUser = function(cronExecutingUser) {\n    $scope.note.config.cronExecutingUser = cronExecutingUser;\n    $scope.setConfig();\n  };\n\n  /** Set release resource for this note **/\n  $scope.setReleaseResource = function(value) {\n    $scope.note.config.releaseresource = value;\n    $scope.setConfig();\n  };\n\n  /** Update note config **/\n  $scope.setConfig = function(config) {\n    if (config) {\n      $scope.note.config = config;\n    }\n    websocketMsgSrv.updateNote($scope.note.id, $scope.note.name, $scope.note.config);\n  };\n\n  /** Update the note name */\n  $scope.updateNoteName = function(newName) {\n    const trimmedNewName = newName.trim();\n    if (trimmedNewName.length > 0 && $scope.note.name !== trimmedNewName) {\n      $scope.note.name = trimmedNewName;\n      websocketMsgSrv.renameNote($scope.note.id, $scope.note.name);\n    }\n  };\n\n  var initializeLookAndFeel = function() {\n    if (!$scope.note.config.looknfeel) {\n      $scope.note.config.looknfeel = 'default';\n    } else {\n      $scope.viewOnly = $scope.note.config.looknfeel === 'report' ? true : false;\n    }\n\n    if ($scope.note.paragraphs && $scope.note.paragraphs[0]) {\n      $scope.note.paragraphs[0].focus = true;\n    }\n    $rootScope.$broadcast('setLookAndFeel', $scope.note.config.looknfeel);\n  };\n\n  var cleanParagraphExcept = function(paragraphId, note) {\n    var noteCopy = {};\n    noteCopy.id = note.id;\n    noteCopy.name = note.name;\n    noteCopy.config = note.config;\n    noteCopy.info = note.info;\n    noteCopy.paragraphs = [];\n    for (var i = 0; i < note.paragraphs.length; i++) {\n      if (note.paragraphs[i].id === paragraphId) {\n        noteCopy.paragraphs[0] = note.paragraphs[i];\n        if (!noteCopy.paragraphs[0].config) {\n          noteCopy.paragraphs[0].config = {};\n        }\n        noteCopy.paragraphs[0].config.editorHide = true;\n        noteCopy.paragraphs[0].config.tableHide = false;\n        break;\n      }\n    }\n    return noteCopy;\n  };\n\n  var addPara = function(paragraph, index) {\n    $scope.note.paragraphs.splice(index, 0, paragraph);\n    _.each($scope.note.paragraphs, function(para) {\n      if (para.id === paragraph.id) {\n        para.focus = true;\n        $scope.$broadcast('focusParagraph', para.id, 0, false);\n      }\n    });\n  };\n\n  var removePara = function(paragraphId) {\n    var removeIdx;\n    _.each($scope.note.paragraphs, function(para, idx) {\n      if (para.id === paragraphId) {\n        removeIdx = idx;\n      }\n    });\n    return $scope.note.paragraphs.splice(removeIdx, 1);\n  };\n\n  $scope.$on('addParagraph', function(event, paragraph, index) {\n    if ($scope.paragraphUrl) {\n      return;\n    }\n    addPara(paragraph, index);\n  });\n\n  $scope.$on('removeParagraph', function(event, paragraphId) {\n    if ($scope.paragraphUrl) {\n      return;\n    }\n    removePara(paragraphId);\n  });\n\n  $scope.$on('moveParagraph', function(event, paragraphId, newIdx) {\n    var removedPara = removePara(paragraphId);\n    if (removedPara && removedPara.length === 1) {\n      addPara(removedPara[0], newIdx);\n    }\n  });\n\n  $scope.$on('updateNote', function(event, name, config, info) {\n    /** update Note name */\n    if (name !== $scope.note.name) {\n      console.log('change note name to : %o', $scope.note.name);\n      $scope.note.name = name;\n    }\n    $scope.note.config = config;\n    $scope.note.info = info;\n    initializeLookAndFeel();\n  });\n\n  var getInterpreterBindings = function() {\n    websocketMsgSrv.getInterpreterBindings($scope.note.id);\n  };\n\n  $scope.$on('interpreterBindings', function(event, data) {\n    $scope.interpreterBindings = data.interpreterBindings;\n    $scope.interpreterBindingsOrig = angular.copy($scope.interpreterBindings); // to check dirty\n\n    var selected = false;\n    var key;\n    var setting;\n\n    for (key in $scope.interpreterBindings) {\n      setting = $scope.interpreterBindings[key];\n      if (setting.selected) {\n        selected = true;\n        break;\n      }\n    }\n\n    if (!selected) {\n      // make default selection\n      var selectedIntp = {};\n      for (key in $scope.interpreterBindings) {\n        setting = $scope.interpreterBindings[key];\n        if (!selectedIntp[setting.name]) {\n          setting.selected = true;\n          selectedIntp[setting.name] = true;\n        }\n      }\n      $scope.showSetting = true;\n    }\n  });\n\n  $scope.interpreterSelectionListeners = {\n    accept: function(sourceItemHandleScope, destSortableScope) {return true;},\n    itemMoved: function(event) {},\n    orderChanged: function(event) {}\n  };\n\n  $scope.openSetting = function() {\n    $scope.showSetting = true;\n    getInterpreterBindings();\n  };\n\n  $scope.closeSetting = function() {\n    if (isSettingDirty()) {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: '',\n        message: 'Interpreter setting changes will be discarded.',\n        callback: function(result) {\n          if (result) {\n            $scope.$apply(function() {\n              $scope.showSetting = false;\n            });\n          }\n        }\n      });\n    } else {\n      $scope.showSetting = false;\n    }\n  };\n\n  $scope.saveSetting = function() {\n    var selectedSettingIds = [];\n    for (var no in $scope.interpreterBindings) {\n      var setting = $scope.interpreterBindings[no];\n      if (setting.selected) {\n        selectedSettingIds.push(setting.id);\n      }\n    }\n    websocketMsgSrv.saveInterpreterBindings($scope.note.id, selectedSettingIds);\n    console.log('Interpreter bindings %o saved', selectedSettingIds);\n\n    _.forEach($scope.note.paragraphs, function(n, key) {\n      var regExp = /^\\s*%/g;\n      if (n.text && !regExp.exec(n.text)) {\n        $scope.$broadcast('saveInterpreterBindings', n.id);\n      }\n    });\n\n    $scope.showSetting = false;\n  };\n\n  $scope.toggleSetting = function() {\n    if ($scope.showSetting) {\n      $scope.closeSetting();\n    } else {\n      $scope.openSetting();\n      $scope.closePermissions();\n    }\n  };\n\n  var getPermissions = function(callback) {\n    $http.get(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions').\n    success(function(data, status, headers, config) {\n      $scope.permissions = data.body;\n      $scope.permissionsOrig = angular.copy($scope.permissions); // to check dirty\n\n      var selectJson = {\n        tokenSeparators: [',', ' '],\n        ajax: {\n          url: function(params) {\n            if (!params.term) {\n              return false;\n            }\n            return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n          },\n          delay: 250,\n          processResults: function(data, params) {\n            var results = [];\n\n            if (data.body.users.length !== 0) {\n              var users = [];\n              for (var len = 0; len < data.body.users.length; len++) {\n                users.push({\n                  'id': data.body.users[len],\n                  'text': data.body.users[len]\n                });\n              }\n              results.push({\n                'text': 'Users :',\n                'children': users\n              });\n            }\n            if (data.body.roles.length !== 0) {\n              var roles = [];\n              for (var len = 0; len < data.body.roles.length; len++) {\n                roles.push({\n                  'id': data.body.roles[len],\n                  'text': data.body.roles[len]\n                });\n              }\n              results.push({\n                'text': 'Roles :',\n                'children': roles\n              });\n            }\n            return {\n              results: results,\n              pagination: {\n                more: false\n              }\n            };\n          },\n          cache: false\n        },\n        width: ' ',\n        tags: true,\n        minimumInputLength: 3\n      };\n\n      $scope.setIamOwner();\n      angular.element('#selectOwners').select2(selectJson);\n      angular.element('#selectReaders').select2(selectJson);\n      angular.element('#selectWriters').select2(selectJson);\n      if (callback) {\n        callback();\n      }\n    }).\n    error(function(data, status, headers, config) {\n      if (status !== 0) {\n        console.log('Error %o %o', status, data.message);\n      }\n    });\n  };\n\n  $scope.openPermissions = function() {\n    $scope.showPermissions = true;\n    getPermissions();\n  };\n\n  $scope.closePermissions = function() {\n    if (isPermissionsDirty()) {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: '',\n        message: 'Changes will be discarded.',\n        callback: function(result) {\n          if (result) {\n            $scope.$apply(function() {\n              $scope.showPermissions = false;\n            });\n          }\n        }\n      });\n    } else {\n      $scope.showPermissions = false;\n    }\n  };\n\n  function convertPermissionsToArray() {\n    $scope.permissions.owners = angular.element('#selectOwners').val();\n    $scope.permissions.readers = angular.element('#selectReaders').val();\n    $scope.permissions.writers = angular.element('#selectWriters').val();\n  }\n\n  $scope.restartInterpreter = function(interpreter) {\n    var thisConfirm = BootstrapDialog.confirm({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: '',\n      message: 'Do you want to restart ' + interpreter.name + ' interpreter?',\n      callback: function(result) {\n        if (result) {\n          var payload  = {\n            'noteId': $scope.note.id\n          };\n\n          thisConfirm.$modalFooter.find('button').addClass('disabled');\n          thisConfirm.$modalFooter.find('button:contains(\"OK\")')\n            .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\n          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + interpreter.id, payload)\n            .success(function(data, status, headers, config) {\n              var index = _.findIndex($scope.interpreterSettings, {'id': interpreter.id});\n              $scope.interpreterSettings[index] = data.body;\n              thisConfirm.close();\n            }).error(function(data, status, headers, config) {\n            thisConfirm.close();\n            console.log('Error %o %o', status, data.message);\n            BootstrapDialog.show({\n              title: 'Error restart interpreter.',\n              message: data.message\n            });\n          });\n          return false;\n        }\n      }\n    });\n  };\n\n  $scope.savePermissions = function() {\n    convertPermissionsToArray();\n    $http.put(baseUrlSrv.getRestApiBase() + '/notebook/' + $scope.note.id + '/permissions',\n      $scope.permissions, {withCredentials: true}).\n    success(function(data, status, headers, config) {\n      getPermissions(function() {\n        console.log('Note permissions %o saved', $scope.permissions);\n        BootstrapDialog.alert({\n          closable: true,\n          title: 'Permissions Saved Successfully!!!',\n          message: 'Owners : ' + $scope.permissions.owners + '\\n\\n' + 'Readers : ' +\n          $scope.permissions.readers + '\\n\\n' + 'Writers  : ' + $scope.permissions.writers\n        });\n        $scope.showPermissions = false;\n      });\n    }).\n    error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n      BootstrapDialog.show({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: 'Insufficient privileges',\n        message: data.message,\n        buttons: [\n          {\n            label: 'Login',\n            action: function(dialog) {\n              dialog.close();\n              angular.element('#loginModal').modal({\n                show: 'true'\n              });\n            }\n          },\n          {\n            label: 'Cancel',\n            action: function(dialog) {\n              dialog.close();\n              $location.path('/');\n            }\n          }\n        ]\n      });\n    });\n  };\n\n  $scope.togglePermissions = function() {\n    var principal = $rootScope.ticket.principal;\n    $scope.isAnonymous = principal === 'anonymous' ? true : false;\n    if (!!principal && $scope.isAnonymous) {\n      $scope.blockAnonUsers();\n    } else {\n      if ($scope.showPermissions) {\n        $scope.closePermissions();\n        angular.element('#selectOwners').select2({});\n        angular.element('#selectReaders').select2({});\n        angular.element('#selectWriters').select2({});\n      } else {\n        $scope.openPermissions();\n        $scope.closeSetting();\n      }\n    }\n  };\n\n  $scope.setIamOwner = function() {\n    if ($scope.permissions.owners.length > 0 &&\n      _.indexOf($scope.permissions.owners, $rootScope.ticket.principal) < 0) {\n      $scope.isOwner = false;\n      return false;\n    }\n    $scope.isOwner = true;\n    return true;\n  };\n\n  $scope.toggleNotePersonalizedMode = function() {\n    var personalizedMode = $scope.note.config.personalizedMode;\n    if ($scope.isOwner) {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: 'Setting the result display',\n        message: function(dialog) {\n          var modeText = $scope.note.config.personalizedMode === 'true' ? 'collaborate' : 'personalize';\n          return 'Do you want to <span class=\"text-info\">' + modeText + '</span> your analysis?';\n        },\n        callback: function(result) {\n          if (result) {\n            if ($scope.note.config.personalizedMode === undefined) {\n              $scope.note.config.personalizedMode = 'false';\n            }\n            $scope.note.config.personalizedMode = personalizedMode === 'true' ?  'false' : 'true';\n            websocketMsgSrv.updatePersonalizedMode($scope.note.id, $scope.note.config.personalizedMode);\n          }\n        }\n      });\n    }\n  };\n\n  var isSettingDirty = function() {\n    if (angular.equals($scope.interpreterBindings, $scope.interpreterBindingsOrig)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  var isPermissionsDirty = function() {\n    if (angular.equals($scope.permissions, $scope.permissionsOrig)) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  angular.element(document).click(function() {\n    angular.element('.ace_autocomplete').hide();\n  });\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setConnectedStatus', function(event, param) {\n    if (connectedOnce && param) {\n      initNotebook();\n    }\n    connectedOnce = true;\n  });\n\n  $scope.$on('moveParagraphUp', function(event, paragraph) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === paragraph.id) {\n        newIndex = i - 1;\n        break;\n      }\n    }\n    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n      return;\n    }\n    // save dirtyText of moving paragraphs.\n    var prevParagraph = $scope.note.paragraphs[newIndex];\n    angular\n      .element('#' + paragraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(paragraph);\n    angular\n      .element('#' + prevParagraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(prevParagraph);\n    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n  });\n\n  $scope.$on('moveParagraphDown', function(event, paragraph) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === paragraph.id) {\n        newIndex = i + 1;\n        break;\n      }\n    }\n\n    if (newIndex < 0 || newIndex >= $scope.note.paragraphs.length) {\n      return;\n    }\n    // save dirtyText of moving paragraphs.\n    var nextParagraph = $scope.note.paragraphs[newIndex];\n    angular\n      .element('#' + paragraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(paragraph);\n    angular\n      .element('#' + nextParagraph.id + '_paragraphColumn_main')\n      .scope()\n      .saveParagraph(nextParagraph);\n    websocketMsgSrv.moveParagraph(paragraph.id, newIndex);\n  });\n\n  $scope.$on('moveFocusToPreviousParagraph', function(event, currentParagraphId) {\n    var focus = false;\n    for (var i = $scope.note.paragraphs.length - 1; i >= 0; i--) {\n      if (focus === false) {\n        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n          focus = true;\n          continue;\n        }\n      } else {\n        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, -1);\n        break;\n      }\n    }\n  });\n\n  $scope.$on('moveFocusToNextParagraph', function(event, currentParagraphId) {\n    var focus = false;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if (focus === false) {\n        if ($scope.note.paragraphs[i].id === currentParagraphId) {\n          focus = true;\n          continue;\n        }\n      } else {\n        $scope.$broadcast('focusParagraph', $scope.note.paragraphs[i].id, 0);\n        break;\n      }\n    }\n  });\n\n  $scope.$on('insertParagraph', function(event, paragraphId, position) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === paragraphId) {\n        //determine position of where to add new paragraph; default is below\n        if (position === 'above') {\n          newIndex = i;\n        } else {\n          newIndex = i + 1;\n        }\n        break;\n      }\n    }\n\n    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n      return;\n    }\n    websocketMsgSrv.insertParagraph(newIndex);\n  });\n\n  $scope.$on('setNoteContent', function(event, note) {\n    if (note === undefined) {\n      $location.path('/');\n    }\n\n    $scope.note = note;\n\n    $scope.paragraphUrl = $routeParams.paragraphId;\n    $scope.asIframe = $routeParams.asIframe;\n    if ($scope.paragraphUrl) {\n      $scope.note = cleanParagraphExcept($scope.paragraphUrl, note);\n      $scope.$broadcast('$unBindKeyEvent', $scope.$unBindKeyEvent);\n      $rootScope.$broadcast('setIframe', $scope.asIframe);\n    }\n\n    initializeLookAndFeel();\n    //open interpreter binding setting when there're none selected\n    getInterpreterBindings();\n    getPermissions();\n    var isPersonalized = $scope.note.config.personalizedMode;\n    isPersonalized = isPersonalized === undefined ?  'false' : isPersonalized;\n    $scope.note.config.personalizedMode = isPersonalized;\n  });\n\n  $scope.$on('$destroy', function() {\n    angular.element(window).off('beforeunload');\n    $scope.killSaveTimer();\n    $scope.saveNote();\n\n    document.removeEventListener('click', $scope.focusParagraphOnClick);\n    document.removeEventListener('keydown', $scope.keyboardShortcut);\n  });\n\n  $scope.$on('$unBindKeyEvent', function() {\n    document.removeEventListener('click', $scope.focusParagraphOnClick);\n    document.removeEventListener('keydown', $scope.keyboardShortcut);\n  });\n\n  angular.element(window).bind('resize', function() {\n    const actionbarHeight = document.getElementById('actionbar').lastElementChild.clientHeight;\n    angular.element(document.getElementById('content')).css('padding-top', actionbarHeight - 20);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebook/notebook.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Create table data object from paragraph table type result\n */\nexport default class TableData {\n  constructor(columns, rows, comment) {\n    this.columns = columns || [];\n    this.rows = rows || [];\n    this.comment = comment || '';\n  };\n\n  loadParagraphResult(paragraphResult) {\n    if (!paragraphResult || paragraphResult.type !== 'TABLE') {\n      console.log('Can not load paragraph result');\n      return;\n    }\n\n    var columnNames = [];\n    var rows = [];\n    var array = [];\n    var textRows = paragraphResult.msg.split('\\n');\n    var comment = '';\n    var commentRow = false;\n\n    for (var i = 0; i < textRows.length; i++) {\n      var textRow = textRows[i];\n\n      if (commentRow) {\n        comment += textRow;\n        continue;\n      }\n\n      if (textRow === '' || textRow === '<!--TABLE_COMMENT-->') {\n        if (rows.length > 0) {\n          commentRow = true;\n        }\n        continue;\n      }\n      var textCols = textRow.split('\\t');\n      var cols = [];\n      var cols2 = [];\n      for (var j = 0; j < textCols.length; j++) {\n        var col = textCols[j];\n        if (i === 0) {\n          columnNames.push({name: col, index: j, aggr: 'sum'});\n        } else {\n          cols.push(col);\n          cols2.push({key: (columnNames[i]) ? columnNames[i].name : undefined, value: col});\n        }\n      }\n      if (i !== 0) {\n        rows.push(cols);\n        array.push(cols2);\n      }\n    }\n    this.comment = comment;\n    this.columns = columnNames;\n    this.rows = rows;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/tabledata.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Base class for visualization\n */\nexport default class Transformation {\n  constructor(config) {\n    this.config = config;\n    this._emitter;\n  };\n\n  /**\n   * return {\n   *   template : angular template string or url (url should end with .html),\n   *   scope : an object to bind to template scope\n   * }\n   */\n  getSetting() {\n    // override this\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    // override this\n  };\n\n  /**\n   * render setting\n   */\n  renderSetting(targetEl) {\n    var setting = this.getSetting();\n    if (!setting) {\n      return;\n    }\n\n    // already readered\n    if (this._scope) {\n      var self = this;\n      this._scope.$apply(function() {\n        for (var k in setting.scope) {\n          self._scope[k] = setting.scope[k];\n        }\n\n        for (var k in self._prevSettingScope) {\n          if (!setting.scope[k]) {\n            self._scope[k] = setting.scope[k];\n          }\n        }\n      });\n      return;\n    } else {\n      this._prevSettingScope = setting.scope;\n    }\n\n    var scope = this._createNewScope();\n    for (var k in setting.scope) {\n      scope[k] = setting.scope[k];\n    }\n    var template = setting.template;\n\n    if (template.split('\\n').length === 1 &&\n        template.endsWith('.html')) { // template is url\n      var self = this;\n      this._templateRequest(template).then(function(t) {\n        self._render(targetEl, t, scope);\n      });\n    } else {\n      this._render(targetEl, template, scope);\n    }\n  };\n\n  _render(targetEl, template, scope) {\n    this._targetEl = targetEl;\n    targetEl.html(template);\n    this._compile(targetEl.contents())(scope);\n    this._scope = scope;\n  };\n\n  setConfig(config) {\n    this.config = config;\n  };\n\n  /**\n   * Emit config. config will sent to server and saved.\n   */\n  emitConfig(config) {\n    this._emitter(config);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/transformation.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Transformation from './transformation';\n\n/**\n * pivot table data and return d3 chart data\n */\nexport default class PivotTransformation extends Transformation {\n  constructor(config) {\n    super(config);\n  };\n\n  getSetting() {\n    var self = this;\n\n    var configObj = self.config;\n    console.log('getSetting', configObj);\n    return {\n      template: 'app/tabledata/pivot_settings.html',\n      scope: {\n        config: configObj.common.pivot,\n        tableDataColumns: self.tableDataColumns,\n        save: function() {\n          self.emitConfig(configObj);\n        },\n        removeKey: function(idx) {\n          configObj.common.pivot.keys.splice(idx, 1);\n          self.emitConfig(configObj);\n        },\n        removeGroup: function(idx) {\n          configObj.common.pivot.groups.splice(idx, 1);\n          self.emitConfig(configObj);\n        },\n        removeValue: function(idx) {\n          configObj.common.pivot.values.splice(idx, 1);\n          self.emitConfig(configObj);\n        },\n        setValueAggr: function(idx, aggr) {\n          configObj.common.pivot.values[idx].aggr = aggr;\n          self.emitConfig(configObj);\n        }\n      }\n    };\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    this.tableDataColumns = tableData.columns;\n    this.config.common = this.config.common || {};\n    this.config.common.pivot = this.config.common.pivot || {};\n    var config = this.config.common.pivot;\n    var firstTime = (!config.keys && !config.groups && !config.values);\n\n    config.keys = config.keys || [];\n    config.groups = config.groups || [];\n    config.values = config.values || [];\n\n    this.removeUnknown();\n    if (firstTime) {\n      this.selectDefault();\n    }\n    return this.pivot(\n      tableData,\n      config.keys,\n      config.groups,\n      config.values);\n  };\n\n  removeUnknown() {\n    var config = this.config.common.pivot;\n    var tableDataColumns = this.tableDataColumns;\n    var unique = function(list) {\n      for (var i = 0; i < list.length; i++) {\n        for (var j = i + 1; j < list.length; j++) {\n          if (angular.equals(list[i], list[j])) {\n            list.splice(j, 1);\n          }\n        }\n      }\n    };\n\n    var removeUnknown = function(list) {\n      for (var i = 0; i < list.length; i++) {\n        // remove non existing column\n        var found = false;\n        for (var j = 0; j < tableDataColumns.length; j++) {\n          var a = list[i];\n          var b = tableDataColumns[j];\n          if (a.index === b.index && a.name === b.name) {\n            found = true;\n            break;\n          }\n        }\n        if (!found) {\n          list.splice(i, 1);\n        }\n      }\n    };\n\n    unique(config.keys);\n    removeUnknown(config.keys);\n    unique(config.groups);\n    removeUnknown(config.groups);\n    removeUnknown(config.values);\n  };\n\n  selectDefault() {\n    var config = this.config.common.pivot;\n    if (config.keys.length === 0 &&\n        config.groups.length === 0 &&\n        config.values.length === 0) {\n      if (config.keys.length === 0 && this.tableDataColumns.length > 0) {\n        config.keys.push(this.tableDataColumns[0]);\n      }\n\n      if (config.values.length === 0 && this.tableDataColumns.length > 1) {\n        config.values.push(this.tableDataColumns[1]);\n      }\n    }\n  };\n\n  pivot(data, keys, groups, values) {\n    var aggrFunc = {\n      sum: function(a, b) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return varA + varB;\n      },\n      count: function(a, b) {\n        var varA = (a !== undefined) ? parseInt(a) : 0;\n        var varB = (b !== undefined) ? 1 : 0;\n        return varA + varB;\n      },\n      min: function(a, b) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return Math.min(varA,varB);\n      },\n      max: function(a, b) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return Math.max(varA,varB);\n      },\n      avg: function(a, b, c) {\n        var varA = (a !== undefined) ? (isNaN(a) ? 1 : parseFloat(a)) : 0;\n        var varB = (b !== undefined) ? (isNaN(b) ? 1 : parseFloat(b)) : 0;\n        return varA + varB;\n      }\n    };\n\n    var aggrFuncDiv = {\n      sum: false,\n      count: false,\n      min: false,\n      max: false,\n      avg: true\n    };\n\n    var schema = {};\n    var rows = {};\n\n    for (var i = 0; i < data.rows.length; i++) {\n      var row = data.rows[i];\n      var s = schema;\n      var p = rows;\n\n      for (var k = 0; k < keys.length; k++) {\n        var key = keys[k];\n\n        // add key to schema\n        if (!s[key.name]) {\n          s[key.name] = {\n            order: k,\n            index: key.index,\n            type: 'key',\n            children: {}\n          };\n        }\n        s = s[key.name].children;\n\n        // add key to row\n        var keyKey = row[key.index];\n        if (!p[keyKey]) {\n          p[keyKey] = {};\n        }\n        p = p[keyKey];\n      }\n\n      for (var g = 0; g < groups.length; g++) {\n        var group = groups[g];\n        var groupKey = row[group.index];\n\n        // add group to schema\n        if (!s[groupKey]) {\n          s[groupKey] = {\n            order: g,\n            index: group.index,\n            type: 'group',\n            children: {}\n          };\n        }\n        s = s[groupKey].children;\n\n        // add key to row\n        if (!p[groupKey]) {\n          p[groupKey] = {};\n        }\n        p = p[groupKey];\n      }\n\n      for (var v = 0; v < values.length; v++) {\n        var value = values[v];\n        var valueKey = value.name + '(' + value.aggr + ')';\n\n        // add value to schema\n        if (!s[valueKey]) {\n          s[valueKey] = {\n            type: 'value',\n            order: v,\n            index: value.index\n          };\n        }\n\n        // add value to row\n        if (!p[valueKey]) {\n          p[valueKey] = {\n            value: (value.aggr !== 'count') ? row[value.index] : 1,\n            count: 1\n          };\n        } else {\n          p[valueKey] = {\n            value: aggrFunc[value.aggr](p[valueKey].value, row[value.index], p[valueKey].count + 1),\n            count: (aggrFuncDiv[value.aggr]) ?  p[valueKey].count + 1 : p[valueKey].count\n          };\n        }\n      }\n    }\n\n    //console.log('schema=%o, rows=%o', schema, rows);\n    return {\n      keys: keys,\n      groups: groups,\n      values: values,\n      schema: schema,\n      rows: rows\n    };\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/pivot.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Transformation from './transformation';\n\n/**\n * passthough the data\n */\nexport default class PassthroughTransformation extends Transformation {\n  constructor(config) {\n    super(config);\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    return tableData;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/passthrough.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Transformation from './transformation';\n\n/**\n * select columns\n * - columnSelectorProp\n *   [\n *     {\n *       \"name\":\n *       \"tooltip\":\n *     },\n *     ...\n *   ]\n */\nexport default class ColumnselectorTransformation extends Transformation {\n  constructor(config, columnSelectorProp) {\n    super(config);\n    this.props = columnSelectorProp;\n  };\n\n  getSetting() {\n    var self = this;\n    var configObj = self.config;\n    return {\n      template: 'app/tabledata/columnselector_settings.html',\n      scope: {\n        config: self.config,\n        props: self.props,\n        tableDataColumns: self.tableDataColumns,\n        save: function() {\n          self.emitConfig(configObj);\n        },\n        remove: function(selectorName) {\n          configObj[selectorName] = null;\n          self.emitConfig(configObj);\n        }\n      }\n    };\n  };\n\n  /**\n   * Method will be invoked when tableData or config changes\n   */\n  transform(tableData) {\n    this.tableDataColumns = tableData.columns;\n    this.removeUnknown();\n    return tableData;\n  };\n\n  removeUnknown() {\n    var fields = this.config;\n    for (var f in fields) {\n      if (fields[f]) {\n        var found = false;\n        for (var i = 0; i < this.tableDataColumns.length; i++) {\n          var a = fields[f];\n          var b = this.tableDataColumns[i];\n          if (a.index === b.index && a.name === b.name) {\n            found = true;\n            break;\n          }\n        }\n        if (!found && (fields[f] instanceof Object) && !(fields[f] instanceof Array)) {\n          fields[f] = null;\n        }\n      }\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/tabledata/columnselector.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Base class for visualization\n */\nexport default class Visualization {\n  constructor(targetEl, config) {\n    this.targetEl = targetEl;\n    this.config = config;\n    this._dirty = false;\n    this._active = false;\n    this._emitter;\n  };\n\n  /**\n   * get transformation\n   */\n  getTransformation() {\n    // override this\n  };\n\n  /**\n   * Method will be invoked when data or configuration changed\n   */\n  render(tableData) {\n    // override this\n  };\n\n  /**\n   * Refresh visualization.\n   */\n  refresh() {\n    // override this\n  };\n\n  /**\n   * method will be invoked when visualization need to be destroyed.\n   * Don't need to destroy this.targetEl.\n   */\n  destroy() {\n    // override this\n  };\n\n  /**\n   * return {\n   *   template : angular template string or url (url should end with .html),\n   *   scope : an object to bind to template scope\n   * }\n   */\n  getSetting() {\n    // override this\n  };\n\n  /**\n   * Activate. invoked when visualization is selected\n   */\n  activate() {\n    if (!this._active || this._dirty) {\n      this.refresh();\n      this._dirty = false;\n    }\n    this._active = true;\n  };\n\n  /**\n   * Activate. invoked when visualization is de selected\n   */\n  deactivate() {\n    this._active = false;\n  };\n\n  /**\n   * Is active\n   */\n  isActive() {\n    return this._active;\n  };\n\n  /**\n   * When window or paragraph is resized\n   */\n  resize() {\n    if (this.isActive()) {\n      this.refresh();\n    } else {\n      this._dirty = true;\n    }\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    this.config = config;\n    if (this.isActive()) {\n      this.refresh();\n    } else {\n      this._dirty = true;\n    }\n  };\n\n  /**\n   * Emit config. config will sent to server and saved.\n   */\n  emitConfig(config) {\n    this._emitter(config);\n  };\n\n  /**\n   * render setting\n   */\n  renderSetting(targetEl) {\n    var setting = this.getSetting();\n    if (!setting) {\n      return;\n    }\n\n    // already readered\n    if (this._scope) {\n      var self = this;\n      this._scope.$apply(function() {\n        for (var k in setting.scope) {\n          self._scope[k] = setting.scope[k];\n        }\n\n        for (var k in self._prevSettingScope) {\n          if (!setting.scope[k]) {\n            self._scope[k] = setting.scope[k];\n          }\n        }\n      });\n      return;\n    } else {\n      this._prevSettingScope = setting.scope;\n    }\n\n    var scope = this._createNewScope();\n    for (var k in setting.scope) {\n      scope[k] = setting.scope[k];\n    }\n    var template = setting.template;\n\n    if (template.split('\\n').length === 1 &&\n        template.endsWith('.html')) { // template is url\n      this._templateRequest(template).then(t =>\n      _renderSetting(this, targetEl, t, scope)\n      );\n    } else {\n      _renderSetting(this, targetEl, template, scope);\n    }\n  };\n}\n\nfunction _renderSetting(instance, targetEl, template, scope) {\n  instance._targetEl = targetEl;\n  targetEl.html(template);\n  instance._compile(targetEl.contents())(scope);\n  instance._scope = scope;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/visualization.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Visualization from '../visualization';\nimport PassthroughTransformation from '../../tabledata/passthrough';\nimport HandsonHelper from '../../handsontable/handsonHelper';\n\n/**\n * Visualize data in table format\n */\nexport default class TableVisualization extends Visualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n    console.log('Init table viz');\n    targetEl.addClass('table');\n    this.passthrough = new PassthroughTransformation(config);\n  };\n\n  refresh() {\n    this.hot.render();\n  };\n\n  render(tableData) {\n    var height = this.targetEl.height();\n    var container = this.targetEl.css('height', height).get(0);\n    var resultRows = tableData.rows;\n    var columnNames = _.pluck(tableData.columns, 'name');\n    var columns = Array.apply(null, Array(tableData.columns.length)).map(function() {\n      return {type: 'text'};\n    });\n\n    if (this.hot) {\n      this.hot.destroy();\n    }\n\n    var handsonHelper = new HandsonHelper();\n    this.hot = new Handsontable(container, handsonHelper.getHandsonTableConfig(\n      columns, columnNames, resultRows));\n    this.hot.validateCells(null);\n  };\n\n  destroy() {\n    if (this.hot) {\n      this.hot.destroy();\n    }\n  };\n\n  getTransformation() {\n    return this.passthrough;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-table.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Visualization from '../visualization';\n\n/**\n * Visualize data in table format\n */\nexport default class Nvd3ChartVisualization extends Visualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n    this.targetEl.append('<svg></svg>');\n  };\n\n  refresh() {\n    if (this.chart) {\n      this.chart.update();\n    }\n  };\n\n  render(data) {\n    var type = this.type();\n    var d3g = data.d3g;\n\n    if (!this.chart) {\n      this.chart = nv.models[type]();\n    }\n\n    this.configureChart(this.chart);\n\n    var animationDuration = 300;\n    var numberOfDataThreshold = 150;\n    var height = this.targetEl.height();\n\n    // turn off animation when dataset is too large. (for performance issue)\n    // still, since dataset is large, the chart content sequentially appears like animated.\n    try {\n      if (d3g[0].values.length > numberOfDataThreshold) {\n        animationDuration = 0;\n      }\n    } catch (ignoreErr) {\n    }\n\n    d3.select('#' + this.targetEl[0].id + ' svg')\n      .attr('height', height)\n      .datum(d3g)\n      .transition()\n      .duration(animationDuration)\n      .call(this.chart);\n    d3.select('#' + this.targetEl[0].id + ' svg').style.height = height + 'px';\n  };\n\n  type() {\n    // override this and return chart type\n  };\n\n  configureChart(chart) {\n    // override this to configure chart\n  };\n\n  groupedThousandsWith3DigitsFormatter(x) {\n    return d3.format(',')(d3.round(x, 3));\n  };\n\n  customAbbrevFormatter(x) {\n    var s = d3.format('.3s')(x);\n    switch (s[s.length - 1]) {\n      case 'G': return s.slice(0, -1) + 'B';\n    }\n    return s;\n  };\n\n  xAxisTickFormat(d, xLabels) {\n    if (xLabels[d] && (isNaN(parseFloat(xLabels[d])) || !isFinite(xLabels[d]))) { // to handle string type xlabel\n      return xLabels[d];\n    } else {\n      return d;\n    }\n  };\n\n  yAxisTickFormat(d) {\n    if (Math.abs(d) >= Math.pow(10,6)) {\n      return this.customAbbrevFormatter(d);\n    }\n    return this.groupedThousandsWith3DigitsFormatter(d);\n  };\n\n  d3DataFromPivot(\n    schema, rows, keys, groups, values, allowTextXAxis, fillMissingValues, multiBarChart) {\n    // construct table data\n    var d3g = [];\n\n    var concat = function(o, n) {\n      if (!o) {\n        return n;\n      } else {\n        return o + '.' + n;\n      }\n    };\n\n    var getSchemaUnderKey = function(key, s) {\n      for (var c in key.children) {\n        s[c] = {};\n        getSchemaUnderKey(key.children[c], s[c]);\n      }\n    };\n\n    var traverse = function(sKey, s, rKey, r, func, rowName, rowValue, colName) {\n      //console.log(\"TRAVERSE sKey=%o, s=%o, rKey=%o, r=%o, rowName=%o, rowValue=%o, colName=%o\", sKey, s, rKey, r, rowName, rowValue, colName);\n\n      if (s.type === 'key') {\n        rowName = concat(rowName, sKey);\n        rowValue = concat(rowValue, rKey);\n      } else if (s.type === 'group') {\n        colName = concat(colName, rKey);\n      } else if (s.type === 'value' && sKey === rKey || valueOnly) {\n        colName = concat(colName, rKey);\n        func(rowName, rowValue, colName, r);\n      }\n\n      for (var c in s.children) {\n        if (fillMissingValues && s.children[c].type === 'group' && r[c] === undefined) {\n          var cs = {};\n          getSchemaUnderKey(s.children[c], cs);\n          traverse(c, s.children[c], c, cs, func, rowName, rowValue, colName);\n          continue;\n        }\n\n        for (var j in r) {\n          if (s.children[c].type === 'key' || c === j) {\n            traverse(c, s.children[c], j, r[j], func, rowName, rowValue, colName);\n          }\n        }\n      }\n    };\n\n    var valueOnly = (keys.length === 0 && groups.length === 0 && values.length > 0);\n    var noKey = (keys.length === 0);\n    var isMultiBarChart = multiBarChart;\n\n    var sKey = Object.keys(schema)[0];\n\n    var rowNameIndex = {};\n    var rowIdx = 0;\n    var colNameIndex = {};\n    var colIdx = 0;\n    var rowIndexValue = {};\n\n    for (var k in rows) {\n      traverse(sKey, schema[sKey], k, rows[k], function(rowName, rowValue, colName, value) {\n        //console.log(\"RowName=%o, row=%o, col=%o, value=%o\", rowName, rowValue, colName, value);\n        if (rowNameIndex[rowValue] === undefined) {\n          rowIndexValue[rowIdx] = rowValue;\n          rowNameIndex[rowValue] = rowIdx++;\n        }\n\n        if (colNameIndex[colName] === undefined) {\n          colNameIndex[colName] = colIdx++;\n        }\n        var i = colNameIndex[colName];\n        if (noKey && isMultiBarChart) {\n          i = 0;\n        }\n\n        if (!d3g[i]) {\n          d3g[i] = {\n            values: [],\n            key: (noKey && isMultiBarChart) ? 'values' : colName\n          };\n        }\n\n        var xVar = isNaN(rowValue) ? ((allowTextXAxis) ? rowValue : rowNameIndex[rowValue]) : parseFloat(rowValue);\n        var yVar = 0;\n        if (xVar === undefined) { xVar = colName; }\n        if (value !== undefined) {\n          yVar = isNaN(value.value) ? 0 : parseFloat(value.value) / parseFloat(value.count);\n        }\n        d3g[i].values.push({\n          x: xVar,\n          y: yVar\n        });\n      });\n    }\n\n    // clear aggregation name, if possible\n    var namesWithoutAggr = {};\n    var colName;\n    var withoutAggr;\n    // TODO - This part could use som refactoring - Weird if/else with similar actions and variable names\n    for (colName in colNameIndex) {\n      withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n      if (!namesWithoutAggr[withoutAggr]) {\n        namesWithoutAggr[withoutAggr] = 1;\n      } else {\n        namesWithoutAggr[withoutAggr]++;\n      }\n    }\n\n    if (valueOnly) {\n      for (var valueIndex = 0; valueIndex < d3g[0].values.length; valueIndex++) {\n        colName = d3g[0].values[valueIndex].x;\n        if (!colName) {\n          continue;\n        }\n\n        withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n        if (namesWithoutAggr[withoutAggr] <= 1) {\n          d3g[0].values[valueIndex].x = withoutAggr;\n        }\n      }\n    } else {\n      for (var d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n        colName = d3g[d3gIndex].key;\n        withoutAggr = colName.substring(0, colName.lastIndexOf('('));\n        if (namesWithoutAggr[withoutAggr] <= 1) {\n          d3g[d3gIndex].key = withoutAggr;\n        }\n      }\n\n      // use group name instead of group.value as a column name, if there're only one group and one value selected.\n      if (groups.length === 1 && values.length === 1) {\n        for (d3gIndex = 0; d3gIndex < d3g.length; d3gIndex++) {\n          colName = d3g[d3gIndex].key;\n          colName = colName.split('.').slice(0, -1).join('.');\n          d3g[d3gIndex].key = colName;\n        }\n      }\n    }\n\n    return {\n      xLabels: rowIndexValue,\n      d3g: d3g\n    };\n  };\n\n  /**\n   * method will be invoked when visualization need to be destroyed.\n   * Don't need to destroy this.targetEl.\n   */\n  destroy() {\n    if (this.chart) {\n      d3.selectAll('#' + this.targetEl[0].id + ' svg > *').remove();\n      this.chart = undefined;\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-nvd3chart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in bar char\n */\nexport default class BarchartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.pivot = new PivotTransformation(config);\n  };\n\n  type() {\n    return 'multiBarChart';\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    var d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      true,\n      true,\n      true);\n\n    super.render(d3Data);\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n  };\n\n  configureChart(chart) {\n    var self = this;\n    chart.yAxis.axisLabelDistance(50);\n    chart.yAxis.tickFormat(function(d) {return self.yAxisTickFormat(d);});\n\n    this.chart.stacked(this.config.stacked);\n\n    var self = this;\n    this.chart.dispatch.on('stateChange', function(s) {\n      self.config.stacked = s.stacked;\n\n      // give some time to animation finish\n      setTimeout(function() {\n        self.emitConfig(self.config);\n      }, 500);\n    });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-barchart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in pie chart\n */\nexport default class PiechartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n    this.pivot = new PivotTransformation(config);\n  };\n\n  type() {\n    return 'pieChart';\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    // [ZEPPELIN-2253] New chart function will be created each time inside super.render()\n    this.chart = null;\n    const d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      true,\n      false,\n      false);\n    const d = d3Data.d3g;\n\n    let generateLabel;\n    // data is grouped\n    if (pivot.groups && pivot.groups.length > 0) {\n      generateLabel = (suffix, prefix) => `${prefix}.${suffix}`;\n    } else { // data isn't grouped\n      generateLabel = suffix => suffix;\n    }\n\n    let d3g = d.map(group => {\n      return group.values.map(row => ({\n        label: generateLabel(row.x, group.key),\n        value: row.y\n      }));\n    });\n    // the map function returns d3g as a nested array\n    // [].concat flattens it, http://stackoverflow.com/a/10865042/5154397\n    d3g = [].concat.apply([], d3g);\n    super.render({d3g: d3g});\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n  };\n\n  configureChart(chart) {\n    chart.x(function(d) { return d.label;})\n\t .y(function(d) { return d.value;})\n\t .showLabels(false)\n\t .showTooltipPercent(true);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-piechart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in area chart\n */\nexport default class AreachartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.pivot = new PivotTransformation(config);\n  };\n\n  type() {\n    return 'stackedAreaChart';\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    var d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      false,\n      true,\n      false);\n\n    this.xLabels = d3Data.xLabels;\n    super.render(d3Data);\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n  };\n\n  configureChart(chart) {\n    var self = this;\n    chart.xAxis.tickFormat(function(d) {return self.xAxisTickFormat(d, self.xLabels);});\n    chart.yAxis.tickFormat(function(d) {return self.yAxisTickFormat(d);});\n    chart.yAxis.axisLabelDistance(50);\n    chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n\n    this.chart.style(this.config.style || 'stack');\n\n    var self = this;\n    this.chart.dispatch.on('stateChange', function(s) {\n      self.config.style = s.style;\n\n      // give some time to animation finish\n      setTimeout(function() {\n        self.emitConfig(self.config);\n      }, 500);\n    });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-areachart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport PivotTransformation from '../../tabledata/pivot';\n\n/**\n * Visualize data in line chart\n */\nexport default class LinechartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.pivot = new PivotTransformation(config);\n  };\n\n  type() {\n    if (this.config.lineWithFocus) {\n      return 'lineWithFocusChart';\n    } else {\n      return 'lineChart';\n    }\n  };\n\n  getTransformation() {\n    return this.pivot;\n  };\n\n  render(pivot) {\n    var d3Data = this.d3DataFromPivot(\n      pivot.schema,\n      pivot.rows,\n      pivot.keys,\n      pivot.groups,\n      pivot.values,\n      false,\n      true,\n      false);\n\n    this.xLabels = d3Data.xLabels;\n    super.render(d3Data);\n  };\n\n  /**\n   * Set new config\n   */\n  setConfig(config) {\n    super.setConfig(config);\n    this.pivot.setConfig(config);\n\n    // change mode\n    if (this.currentMode !== config.lineWithFocus) {\n      super.destroy();\n      this.currentMode = config.lineWithFocus;\n    }\n  };\n\n  configureChart(chart) {\n    var self = this;\n    chart.xAxis.tickFormat(function(d) {return self.xAxisTickFormat(d, self.xLabels);});\n    chart.yAxis.tickFormat(function(d) {return self.yAxisTickFormat(d, self.xLabels);});\n    chart.yAxis.axisLabelDistance(50);\n    if (chart.useInteractiveGuideline) {   // lineWithFocusChart hasn't got useInteractiveGuideline\n      chart.useInteractiveGuideline(true); // for better UX and performance issue. (https://github.com/novus/nvd3/issues/691)\n    }\n    if (this.config.forceY) {\n      chart.forceY([0]); // force y-axis minimum to 0 for line chart.\n    } else {\n      chart.forceY([]);\n    }\n  };\n\n  getSetting(chart) {\n    var self = this;\n    var configObj = self.config;\n\n    return {\n      template: `<div>\n        <label>\n          <input type=\"checkbox\"\n               ng-model=\"config.forceY\"\n               ng-click=\"save()\" />\n          force Y to 0\n        </label>\n        <br/>\n\n        <label>\n          <input type=\"checkbox\"\n               ng-model=\"config.lineWithFocus\"\n               ng-click=\"save()\" />\n          show line chart with focus\n        </label>\n      </div>`,\n      scope: {\n        config: configObj,\n        save: function() {\n          self.emitConfig(configObj);\n        }\n      }\n    };\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-linechart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Nvd3ChartVisualization from './visualization-nvd3chart';\nimport ColumnselectorTransformation from '../../tabledata/columnselector';\n\n/**\n * Visualize data in scatter char\n */\nexport default class ScatterchartVisualization extends Nvd3ChartVisualization {\n  constructor(targetEl, config) {\n    super(targetEl, config);\n\n    this.columnselectorProps = [\n      {\n        name: 'xAxis'\n      },\n      {\n        name: 'yAxis'\n      },\n      {\n        name: 'group'\n      },\n      {\n        name: 'size',\n        tooltip: `<li>Size option is valid only when you drop numeric field here.</li>\n                  <li>When data in each axis are discrete,\n                  'number of values in corresponding coordinate' will be used as size.</li>\n                  <li>Zeppelin consider values as discrete when the values contain string value\n                  or the number of distinct values are bigger than 5% of total number of values.</li>\n                  <li>Size field button turns to grey when the option you chose is not valid.</li>`\n      }\n    ];\n    this.columnselector = new ColumnselectorTransformation(config, this.columnselectorProps);\n  };\n\n  type() {\n    return 'scatterChart';\n  };\n\n  getTransformation() {\n    return this.columnselector;\n  };\n\n  render(tableData) {\n    this.tableData = tableData;\n    this.selectDefault();\n    var d3Data = this.setScatterChart(tableData, true);\n    this.xLabels = d3Data.xLabels;\n    this.yLabels = d3Data.yLabels;\n\n    super.render(d3Data);\n  };\n\n  configureChart(chart) {\n    var self = this;\n\n    chart.xAxis.tickFormat(function(d) { // TODO remove round after bump to nvd3 > 1.8.5\n      return self.xAxisTickFormat(Math.round(d * 1e3)/1e3, self.xLabels);\n      });\n\n    chart.yAxis.tickFormat(function(d) { // TODO remove round after bump to nvd3 > 1.8.5\n      return self.yAxisTickFormat(Math.round(d * 1e3)/1e3, self.yLabels);\n      });\n\n    chart.showDistX(true).showDistY(true);\n    //handle the problem of tooltip not showing when muliple points have same value.\n  };\n\n  yAxisTickFormat(d, yLabels){\n     if (yLabels[d] && (isNaN(parseFloat(yLabels[d])) || !isFinite(yLabels[d]))) { // to handle string type xlabel\n      return yLabels[d];\n     } else {\n      return super.yAxisTickFormat(d);\n     }\n   }\n\n  selectDefault() {\n    if (!this.config.xAxis && !this.config.yAxis) {\n      if (this.tableData.columns.length > 1) {\n        this.config.xAxis = this.tableData.columns[0];\n        this.config.yAxis = this.tableData.columns[1];\n      } else if (this.tableData.columns.length === 1) {\n        this.config.xAxis = this.tableData.columns[0];\n      }\n    }\n  };\n\n  setScatterChart(data, refresh) {\n    var xAxis = this.config.xAxis;\n    var yAxis = this.config.yAxis;\n    var group = this.config.group;\n    var size = this.config.size;\n\n    var xValues = [];\n    var yValues = [];\n    var rows = {};\n    var d3g = [];\n\n    var rowNameIndex = {};\n    var colNameIndex = {};\n    var grpNameIndex = {};\n    var rowIndexValue = {};\n    var colIndexValue = {};\n    var grpIndexValue = {};\n    var rowIdx = 0;\n    var colIdx = 0;\n    var grpIdx = 0;\n    var grpName = '';\n\n    var xValue;\n    var yValue;\n    var row;\n\n    if (!xAxis && !yAxis) {\n      return {\n        d3g: []\n      };\n    }\n\n\n\n\n    for (var i = 0; i < data.rows.length; i++) {\n      row = data.rows[i];\n      if (xAxis) {\n        xValue = row[xAxis.index];\n        xValues[i] = xValue;\n      }\n      if (yAxis) {\n        yValue = row[yAxis.index];\n        yValues[i] = yValue;\n      }\n    }\n\n    var isAllDiscrete = ((xAxis && yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues)) ||\n    (!xAxis && this.isDiscrete(yValues)) ||\n    (!yAxis && this.isDiscrete(xValues)));\n\n    if (isAllDiscrete) {\n      rows = this.setDiscreteScatterData(data);\n    } else {\n      rows = data.rows;\n    }\n\n    if (!group && isAllDiscrete) {\n      grpName = 'count';\n    } else if (!group && !size) {\n      if (xAxis && yAxis) {\n        grpName = '(' + xAxis.name + ', ' + yAxis.name + ')';\n      } else if (xAxis && !yAxis) {\n        grpName = xAxis.name;\n      } else if (!xAxis && yAxis) {\n        grpName = yAxis.name;\n      }\n    } else if (!group && size) {\n      grpName = size.name;\n    }\n\n    var epsilon = 1e-4; // TODO remove after bump to nvd3 > 1.8.5\n\n    for (i = 0; i < rows.length; i++) {\n      row = rows[i];\n      if (xAxis) {\n        xValue = row[xAxis.index];\n      }\n      if (yAxis) {\n        yValue = row[yAxis.index];\n      }\n      if (group) {\n        grpName = row[group.index];\n      }\n      var sz = (isAllDiscrete) ? row[row.length - 1] : ((size) ? row[size.index] : 1);\n\n      if (grpNameIndex[grpName] === undefined) {\n        grpIndexValue[grpIdx] = grpName;\n        grpNameIndex[grpName] = grpIdx++;\n      }\n\n      if (xAxis && rowNameIndex[xValue] === undefined) {\n        rowIndexValue[rowIdx] = xValue;\n        rowNameIndex[xValue] = rowIdx++;\n      }\n\n      if (yAxis && colNameIndex[yValue] === undefined) {\n        colIndexValue[colIdx] = yValue;\n        colNameIndex[yValue] = colIdx++;\n      }\n\n      if (!d3g[grpNameIndex[grpName]]) {\n        d3g[grpNameIndex[grpName]] = {\n          key: grpName,\n          values: []\n        };\n      }\n\n\n      // TODO remove epsilon jitter after bump to nvd3 > 1.8.5\n      var xval, yval = 0;\n      if ( xAxis ){\n        xval = (isNaN(xValue) ? rowNameIndex[xValue] : parseFloat(xValue)) + Math.random() * epsilon;\n      }\n      if ( yAxis ){\n        yval = (isNaN(yValue) ? colNameIndex[yValue] : parseFloat(yValue)) + Math.random() * epsilon;\n      }\n\n      d3g[grpNameIndex[grpName]].values.push({\n        x: xval,\n        y: yval,\n        size: isNaN(parseFloat(sz)) ? 1 : parseFloat(sz)\n      });\n    }\n\n    // TODO remove sort and dedup after bump to nvd3 > 1.8.5\n    var d3gvalues = d3g[grpNameIndex[grpName]].values;\n    d3gvalues.sort(function(a,b){\n                  return ((a['x'] - b['x']) || (a['y'] - b['y']))});\n\n    for (var i = 0; i < d3gvalues.length - 1; ){\n      if ( (Math.abs(d3gvalues[i]['x'] - d3gvalues[i+1]['x']) < epsilon) &&\n           (Math.abs(d3gvalues[i]['y'] - d3gvalues[i+1]['y']) < epsilon) ){\n           d3gvalues.splice(i+1,1);\n      } else{\n        i++;\n      }\n    }\n\n    return {\n      xLabels: rowIndexValue,\n      yLabels: colIndexValue,\n      d3g: d3g\n    };\n  };\n\n  setDiscreteScatterData(data) {\n    var xAxis = this.config.xAxis;\n    var yAxis = this.config.yAxis;\n    var group = this.config.group;\n\n    var xValue;\n    var yValue;\n    var grp;\n\n    var rows = {};\n\n    for (var i = 0; i < data.rows.length; i++) {\n      var row = data.rows[i];\n      if (xAxis) {\n        xValue = row[xAxis.index];\n      }\n      if (yAxis) {\n        yValue = row[yAxis.index];\n      }\n      if (group) {\n        grp = row[group.index];\n      }\n\n      var key = xValue + ',' + yValue +  ',' + grp;\n\n      if (!rows[key]) {\n        rows[key] = {\n          x: xValue,\n          y: yValue,\n          group: grp,\n          size: 1\n        };\n      } else {\n        rows[key].size++;\n      }\n    }\n\n    // change object into array\n    var newRows = [];\n    for (var r in rows) {\n      var newRow = [];\n      if (xAxis) { newRow[xAxis.index] = rows[r].x; }\n      if (yAxis) { newRow[yAxis.index] = rows[r].y; }\n      if (group) { newRow[group.index] = rows[r].group; }\n      newRow[data.rows[0].length] = rows[r].size;\n      newRows.push(newRow);\n    }\n    return newRows;\n  };\n\n  isDiscrete(field) {\n    var getUnique = function(f) {\n      var uniqObj = {};\n      var uniqArr = [];\n      var j = 0;\n      for (var i = 0; i < f.length; i++) {\n        var item = f[i];\n        if (uniqObj[item] !== 1) {\n          uniqObj[item] = 1;\n          uniqArr[j++] = item;\n        }\n      }\n      return uniqArr;\n    };\n\n    for (var i = 0; i < field.length; i++) {\n      if (isNaN(parseFloat(field[i])) &&\n        (typeof field[i] === 'string' || field[i] instanceof String)) {\n        return true;\n      }\n    }\n\n    var threshold = 0.05;\n    var unique = getUnique(field);\n    if (unique.length / field.length < threshold) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  isValidSizeOption(options) {\n    var xValues = [];\n    var yValues = [];\n    var rows = this.tableData.rows;\n\n    for (var i = 0; i < rows.length; i++) {\n      var row = rows[i];\n      var size = row[options.size.index];\n\n      //check if the field is numeric\n      if (isNaN(parseFloat(size)) || !isFinite(size)) {\n        return false;\n      }\n\n      if (options.xAxis) {\n        var x = row[options.xAxis.index];\n        xValues[i] = x;\n      }\n      if (options.yAxis) {\n        var y = row[options.yAxis.index];\n        yValues[i] = y;\n      }\n    }\n\n    //check if all existing fields are discrete\n    var isAllDiscrete = ((options.xAxis && options.yAxis && this.isDiscrete(xValues) && this.isDiscrete(yValues)) ||\n    (!options.xAxis && this.isDiscrete(yValues)) ||\n    (!options.yAxis && this.isDiscrete(xValues)));\n\n    if (isAllDiscrete) {\n      return false;\n    }\n\n    return true;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/visualization/builtins/visualization-scatterchart.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp')\n  .controller('JobmanagerCtrl', JobmanagerCtrl);\n\nJobmanagerCtrl.$inject = ['$scope', 'websocketMsgSrv', '$interval', 'ngToast', '$q', '$timeout', 'jobManagerFilter'];\n\nfunction JobmanagerCtrl($scope, websocketMsgSrv, $interval, ngToast, $q, $timeout, jobManagerFilter) {\n  ngToast.dismiss();\n  var asyncNotebookJobFilter = function(jobInfomations, filterConfig) {\n    return $q(function(resolve, reject) {\n      $scope.JobInfomationsByFilter = $scope.jobTypeFilter(jobInfomations, filterConfig);\n      resolve($scope.JobInfomationsByFilter);\n    });\n  };\n\n  $scope.doFiltering = function(jobInfomations, filterConfig) {\n    asyncNotebookJobFilter(jobInfomations, filterConfig).then(\n      function() {\n        // success\n        $scope.isLoadingFilter = false;\n      },\n      function() {\n        // failed\n      });\n  };\n\n  $scope.filterValueToName = function(filterValue, maxStringLength) {\n    if ($scope.activeInterpreters === undefined) {\n      return;\n    }\n    var index = _.findIndex($scope.activeInterpreters, {value: filterValue});\n    if ($scope.activeInterpreters[index].name !== undefined) {\n      if (maxStringLength !== undefined && maxStringLength > $scope.activeInterpreters[index].name) {\n        return $scope.activeInterpreters[index].name.substr(0, maxStringLength - 3) + '...';\n      }\n      return $scope.activeInterpreters[index].name;\n    } else {\n      return 'Interpreter is not set';\n    }\n  };\n\n  $scope.setFilterValue = function(filterValue) {\n    $scope.filterConfig.filterValueInterpreter = filterValue;\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  };\n\n  $scope.onChangeRunJobToAlwaysTopToggle = function() {\n    $scope.filterConfig.isRunningAlwaysTop = !$scope.filterConfig.isRunningAlwaysTop;\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  };\n\n  $scope.onChangeSortAsc = function() {\n    $scope.filterConfig.isSortByAsc = !$scope.filterConfig.isSortByAsc;\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  };\n\n  $scope.doFilterInputTyping = function(keyEvent, jobInfomations, filterConfig) {\n    var RETURN_KEY_CODE = 13;\n    $timeout.cancel($scope.dofilterTimeoutObject);\n    $scope.isActiveSearchTimer = true;\n    $scope.dofilterTimeoutObject = $timeout(function() {\n      $scope.doFiltering(jobInfomations, filterConfig);\n      $scope.isActiveSearchTimer = false;\n    }, 10000);\n    if (keyEvent.which === RETURN_KEY_CODE) {\n      $timeout.cancel($scope.dofilterTimeoutObject);\n      $scope.doFiltering(jobInfomations, filterConfig);\n      $scope.isActiveSearchTimer = false;\n    }\n  };\n\n  $scope.doForceFilterInputTyping = function(keyEvent, jobInfomations, filterConfig) {\n    $timeout.cancel($scope.dofilterTimeoutObject);\n    $scope.doFiltering(jobInfomations, filterConfig);\n    $scope.isActiveSearchTimer = false;\n  };\n\n  $scope.init = function() {\n    $scope.isLoadingFilter = true;\n    $scope.jobInfomations = [];\n    $scope.JobInfomationsByFilter = $scope.jobInfomations;\n    $scope.filterConfig = {\n      isRunningAlwaysTop: true,\n      filterValueNotebookName: '',\n      filterValueInterpreter: '*',\n      isSortByAsc: true\n    };\n    $scope.sortTooltipMsg = 'Switch to sort by desc';\n    $scope.jobTypeFilter = jobManagerFilter;\n\n    websocketMsgSrv.getNoteJobsList();\n\n    $scope.$watch('filterConfig.isSortByAsc', function (value) {\n      if (value) {\n        $scope.sortTooltipMsg = 'Switch to sort by desc';\n      } else {\n        $scope.sortTooltipMsg = 'Switch to sort by asc';\n      }\n    });\n\n    $scope.$on('$destroy', function() {\n      websocketMsgSrv.unsubscribeJobManager();\n    });\n  };\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteJobs', function(event, responseData) {\n    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n    $scope.jobInfomations = responseData.jobs;\n    $scope.jobInfomationsIndexs = $scope.jobInfomations ? _.indexBy($scope.jobInfomations, 'noteId') : {};\n    $scope.jobTypeFilter($scope.jobInfomations, $scope.filterConfig);\n    $scope.activeInterpreters = [\n      {\n        name: 'ALL',\n        value: '*'\n      }\n    ];\n    var interpreterLists = _.uniq(_.pluck($scope.jobInfomations, 'interpreter'), false);\n    for (var index = 0, length = interpreterLists.length; index < length; index++) {\n      $scope.activeInterpreters.push({\n        name: interpreterLists[index],\n        value: interpreterLists[index]\n      });\n    }\n    $scope.doFiltering($scope.jobInfomations, $scope.filterConfig);\n  });\n\n  $scope.$on('setUpdateNoteJobs', function(event, responseData) {\n    var jobInfomations = $scope.jobInfomations;\n    var indexStore = $scope.jobInfomationsIndexs;\n    $scope.lastJobServerUnixTime = responseData.lastResponseUnixTime;\n    var notes = responseData.jobs;\n    notes.map(function(changedItem) {\n      if (indexStore[changedItem.noteId] === undefined) {\n        var newItem = angular.copy(changedItem);\n        jobInfomations.push(newItem);\n        indexStore[changedItem.noteId] = newItem;\n      } else {\n        var changeOriginTarget = indexStore[changedItem.noteId];\n\n        if (changedItem.isRemoved !== undefined && changedItem.isRemoved === true) {\n\n          // remove Item.\n          var removeIndex = _.findIndex(indexStore, changedItem.noteId);\n          if (removeIndex > -1) {\n            indexStore.splice(removeIndex, 1);\n          }\n\n          removeIndex = _.findIndex(jobInfomations, {'noteId': changedItem.noteId});\n          if (removeIndex) {\n            jobInfomations.splice(removeIndex, 1);\n          }\n\n        } else {\n          // change value for item.\n          changeOriginTarget.isRunningJob = changedItem.isRunningJob;\n          changeOriginTarget.noteName = changedItem.noteName;\n          changeOriginTarget.noteType = changedItem.noteType;\n          changeOriginTarget.interpreter = changedItem.interpreter;\n          changeOriginTarget.unixTimeLastRun = changedItem.unixTimeLastRun;\n          changeOriginTarget.paragraphs = changedItem.paragraphs;\n        }\n      }\n    });\n    $scope.doFiltering(jobInfomations, $scope.filterConfig);\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/jobmanager/jobmanager.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('JobCtrl', JobCtrl);\n\nJobCtrl.$inject = ['$scope', '$http', 'baseUrlSrv'];\n\nfunction JobCtrl($scope, $http, baseUrlSrv) {\n  $scope.init = function(jobInformation) {\n    $scope.progressValue = 0;\n  };\n\n  $scope.getProgress = function() {\n    var statusList = _.pluck($scope.notebookJob.paragraphs, 'status');\n    var runningJob = _.countBy(statusList, function(status) {\n      if (status === 'FINISHED' || status === 'RUNNING') {\n        return 'matchCount';\n      } else {\n        return 'none';\n      }\n    });\n    var totalCount = statusList.length;\n    var runningJobCount = runningJob.matchCount;\n    var result = Math.ceil(runningJobCount / totalCount * 100);\n    return isNaN(result) ? 0 : result;\n  };\n\n  $scope.runNotebookJob = function(notebookId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Run all paragraphs?',\n      callback: function(result) {\n        if (result) {\n          $http({\n            method: 'POST',\n            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            }\n          }).then(function successCallback(response) {\n            // success\n          }, function errorCallback(errorResponse) {\n            var errorText = 'SERVER ERROR';\n            if (!!errorResponse.data.message) {\n              errorText = errorResponse.data.message;\n            }\n            BootstrapDialog.alert({\n              closable: true,\n              title: 'Execution Failure',\n              message: errorText\n            });\n          });\n        }\n      }\n    });\n  };\n\n  $scope.stopNotebookJob = function(notebookId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Stop all paragraphs?',\n      callback: function(result) {\n        if (result) {\n          $http({\n            method: 'DELETE',\n            url: baseUrlSrv.getRestApiBase() + '/notebook/job/' + notebookId,\n            headers: {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            }\n          }).then(function successCallback(response) {\n            // success\n          }, function errorCallback(errorResponse) {\n            var errorText = 'SERVER ERROR';\n            if (!!errorResponse.data.message) {\n\n              errorText = errorResponse.data.message;\n            }\n            BootstrapDialog.alert({\n              closable: true,\n              title: 'Stop Failure',\n              message: errorText\n            });\n          });\n        }\n      }\n    });\n  };\n\n  $scope.lastExecuteTime = function(unixtime) {\n    return moment.unix(unixtime / 1000).fromNow();\n  };\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/jobmanager/jobs/job.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').filter('jobManager', jobManagerFilter);\n\nfunction jobManagerFilter() {\n  function filterContext(jobItems, filterConfig) {\n    var filterValueInterpreter = filterConfig.filterValueInterpreter;\n    var filterValueNotebookName = filterConfig.filterValueNotebookName;\n    var isSortByAsc = filterConfig.isSortByAsc;\n    var filterItems = jobItems;\n\n    if (filterValueInterpreter === undefined) {\n      filterItems = _.filter(filterItems, function(jobItem) {\n        return jobItem.interpreter === undefined ? true : false;\n      });\n    } else if (filterValueInterpreter !== '*') {\n      filterItems = _.where(filterItems, {interpreter: filterValueInterpreter});\n    }\n\n    if (filterValueNotebookName !== '') {\n      filterItems = _.filter(filterItems, function(jobItem) {\n        var lowerFilterValue = filterValueNotebookName.toLocaleLowerCase();\n        var lowerNotebookName = jobItem.noteName.toLocaleLowerCase();\n        return lowerNotebookName.match(new RegExp('.*' + lowerFilterValue + '.*'));\n      });\n    }\n\n    filterItems = _.sortBy(filterItems, function(sortItem) {\n      return sortItem.noteName.toLowerCase();\n    });\n\n    return isSortByAsc ? filterItems : filterItems.reverse();\n  }\n  return filterContext;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/jobmanager/jobmanager.filter.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('InterpreterCtrl', InterpreterCtrl);\n\nInterpreterCtrl.$inject = ['$rootScope', '$scope', '$http', 'baseUrlSrv', 'ngToast', '$timeout', '$route'];\n\nfunction InterpreterCtrl($rootScope, $scope, $http, baseUrlSrv, ngToast, $timeout, $route) {\n  var interpreterSettingsTmp = [];\n  $scope.interpreterSettings = [];\n  $scope.availableInterpreters = {};\n  $scope.showAddNewSetting = false;\n  $scope.showRepositoryInfo = false;\n  $scope.searchInterpreter = '';\n  $scope._ = _;\n  ngToast.dismiss();\n\n  $scope.openPermissions = function() {\n    $scope.showInterpreterAuth = true;\n  };\n\n  $scope.closePermissions = function() {\n    $scope.showInterpreterAuth = false;\n  };\n\n  var getSelectJson = function() {\n    var selectJson = {\n      tags: false,\n      multiple: true,\n      tokenSeparators: [',', ' '],\n      minimumInputLength: 2,\n      ajax: {\n        url: function(params) {\n          if (!params.term) {\n            return false;\n          }\n          return baseUrlSrv.getRestApiBase() + '/security/userlist/' + params.term;\n        },\n        delay: 250,\n        processResults: function(data, params) {\n          var users = [];\n          if (data.body.users.length !== 0) {\n            for (var i = 0; i < data.body.users.length; i++) {\n              users.push({\n                'id': data.body.users[i],\n                'text': data.body.users[i]\n              });\n            }\n          }\n          return {\n            results: users,\n            pagination: {\n              more: false\n            }\n          };\n        },\n        cache: false\n      }\n    };\n    return selectJson;\n  };\n\n  $scope.togglePermissions = function(intpName) {\n    angular.element('#' + intpName + 'Users').select2(getSelectJson());\n    if ($scope.showInterpreterAuth) {\n      $scope.closePermissions();\n    } else {\n      $scope.openPermissions();\n    }\n  };\n\n  $scope.$on('ngRenderFinished', function(event, data) {\n    for (var setting = 0; setting < $scope.interpreterSettings.length; setting++) {\n      angular.element('#' + $scope.interpreterSettings[setting].name + 'Users').select2(getSelectJson());\n    }\n  });\n\n  var getInterpreterSettings = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting')\n      .success(function(data, status, headers, config) {\n        $scope.interpreterSettings = data.body;\n        checkDownloadingDependencies();\n      }).error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var checkDownloadingDependencies = function() {\n    var isDownloading = false;\n    for (var index = 0; index < $scope.interpreterSettings.length; index++) {\n      var setting = $scope.interpreterSettings[index];\n      if (setting.status === 'DOWNLOADING_DEPENDENCIES') {\n        isDownloading = true;\n      }\n\n      if (setting.status === 'ERROR' || setting.errorReason) {\n        ngToast.danger({content: 'Error setting properties for interpreter \\'' +\n        setting.group + '.' + setting.name + '\\': ' + setting.errorReason,\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    }\n\n    if (isDownloading) {\n      $timeout(function() {\n        if ($route.current.$$route.originalPath === '/interpreter') {\n          getInterpreterSettings();\n        }\n      }, 2000);\n    }\n  };\n\n  var getAvailableInterpreters = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter').success(function(data, status, headers, config) {\n      $scope.availableInterpreters = data.body;\n    }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var emptyNewProperty = function(object) {\n    angular.extend(object, {propertyValue: '', propertyKey: ''});\n  };\n\n  var emptyNewDependency = function(object) {\n    angular.extend(object, {depArtifact: '', depExclude: ''});\n  };\n\n  var removeTMPSettings = function(index) {\n    interpreterSettingsTmp.splice(index, 1);\n  };\n\n  $scope.copyOriginInterpreterSettingProperties = function(settingId) {\n    var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n    interpreterSettingsTmp[index] = angular.copy($scope.interpreterSettings[index]);\n  };\n\n  $scope.setPerNoteOption = function(settingId, sessionOption) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (sessionOption === 'isolated') {\n      option.perNote = sessionOption;\n      option.session = false;\n      option.process = true;\n    } else if (sessionOption === 'scoped') {\n      option.perNote = sessionOption;\n      option.session = true;\n      option.process = false;\n    } else {\n      option.perNote = 'shared';\n      option.session = false;\n      option.process = false;\n    }\n  };\n\n  $scope.setPerUserOption = function(settingId, sessionOption) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (sessionOption === 'isolated') {\n      option.perUser = sessionOption;\n      option.session = false;\n      option.process = true;\n    } else if (sessionOption === 'scoped') {\n      option.perUser = sessionOption;\n      option.session = true;\n      option.process = false;\n    } else {\n      option.perUser = 'shared';\n      option.session = false;\n      option.process = false;\n    }\n  };\n\n  $scope.getPerNoteOption = function(settingId) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (option.perNote === 'scoped') {\n      return 'scoped';\n    } else if (option.perNote === 'isolated') {\n      return 'isolated';\n    } else {\n      return 'shared';\n    }\n  };\n\n  $scope.getPerUserOption = function(settingId) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    if (option.perUser === 'scoped') {\n      return 'scoped';\n    } else if (option.perUser === 'isolated') {\n      return 'isolated';\n    } else {\n      return 'shared';\n    }\n  };\n\n  $scope.getInterpreterRunningOption = function(settingId) {\n    var sharedModeName = 'shared';\n\n    var globallyModeName = 'Globally';\n    var perNoteModeName = 'Per Note';\n    var perUserModeName = 'Per User';\n\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n\n    var perNote = option.perNote;\n    var perUser = option.perUser;\n\n    // Globally == shared_perNote + shared_perUser\n    if (perNote === sharedModeName && perUser === sharedModeName) {\n      return globallyModeName;\n    }\n\n    if ($rootScope.ticket.ticket === 'anonymous' && $rootScope.ticket.roles === '[]') {\n      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n        return perNoteModeName;\n      }\n    } else if ($rootScope.ticket.ticket !== 'anonymous') {\n      if (perNote !== undefined && typeof perNote === 'string' && perNote !== '') {\n        if (perUser !== undefined && typeof perUser === 'string' && perUser !== '') {\n          return perUserModeName;\n        }\n        return perNoteModeName;\n      }\n    }\n\n    option.perNote = sharedModeName;\n    option.perUser = sharedModeName;\n    return globallyModeName;\n  };\n\n  $scope.setInterpreterRunningOption = function(settingId, isPerNoteMode, isPerUserMode) {\n    var option;\n    if (settingId === undefined) {\n      option = $scope.newInterpreterSetting.option;\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      option = setting.option;\n    }\n    option.perNote = isPerNoteMode;\n    option.perUser = isPerUserMode;\n  };\n\n  $scope.updateInterpreterSetting = function(form, settingId) {\n    var thisConfirm = BootstrapDialog.confirm({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: '',\n      message: 'Do you want to update this interpreter and restart with new settings?',\n      callback: function(result) {\n        if (result) {\n          var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n          var setting = $scope.interpreterSettings[index];\n          if (setting.propertyKey !== '' || setting.propertyKey) {\n            $scope.addNewInterpreterProperty(settingId);\n          }\n          if (setting.depArtifact !== '' || setting.depArtifact) {\n            $scope.addNewInterpreterDependency(settingId);\n          }\n          // add missing field of option\n          if (!setting.option) {\n            setting.option = {};\n          }\n          if (setting.option.isExistingProcess === undefined) {\n            setting.option.isExistingProcess = false;\n          }\n          if (setting.option.setPermission === undefined) {\n            setting.option.setPermission = false;\n          }\n          if (setting.option.isUserImpersonate === undefined) {\n            setting.option.isUserImpersonate = false;\n          }\n          if (!($scope.getInterpreterRunningOption(settingId) === 'Per User' &&\n            $scope.getPerUserOption(settingId) === 'isolated')) {\n            setting.option.isUserImpersonate = false;\n          }\n          if (setting.option.remote === undefined) {\n            // remote always true for now\n            setting.option.remote = true;\n          }\n          setting.option.users = angular.element('#' + setting.name + 'Users').val();\n\n          var request = {\n            option: angular.copy(setting.option),\n            properties: angular.copy(setting.properties),\n            dependencies: angular.copy(setting.dependencies)\n          };\n\n          thisConfirm.$modalFooter.find('button').addClass('disabled');\n          thisConfirm.$modalFooter.find('button:contains(\"OK\")')\n            .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Saving Setting');\n\n          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId, request)\n            .success(function(data, status, headers, config) {\n              $scope.interpreterSettings[index] = data.body;\n              removeTMPSettings(index);\n              checkDownloadingDependencies();\n              thisConfirm.close();\n            })\n            .error(function(data, status, headers, config) {\n              console.log('Error %o %o', status, data.message);\n              ngToast.danger({content: data.message, verticalPosition: 'bottom'});\n              form.$show();\n              thisConfirm.close();\n            });\n          return false;\n        } else {\n          form.$show();\n        }\n      }\n    });\n  };\n\n  $scope.resetInterpreterSetting = function(settingId) {\n    var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n\n    // Set the old settings back\n    $scope.interpreterSettings[index] = angular.copy(interpreterSettingsTmp[index]);\n    removeTMPSettings(index);\n  };\n\n  $scope.removeInterpreterSetting = function(settingId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to delete this interpreter setting?',\n      callback: function(result) {\n        if (result) {\n          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/setting/' + settingId)\n            .success(function(data, status, headers, config) {\n\n              var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n              $scope.interpreterSettings.splice(index, 1);\n            }).error(function(data, status, headers, config) {\n            console.log('Error %o %o', status, data.message);\n          });\n        }\n      }\n    });\n  };\n\n  $scope.newInterpreterGroupChange = function() {\n    var el = _.pluck(_.filter($scope.availableInterpreters, {'name': $scope.newInterpreterSetting.group}),\n      'properties');\n    var properties = {};\n    for (var i = 0; i < el.length; i++) {\n      var intpInfo = el[i];\n      for (var key in intpInfo) {\n        properties[key] = {\n          value: intpInfo[key].defaultValue,\n          description: intpInfo[key].description\n        };\n      }\n    }\n    $scope.newInterpreterSetting.properties = properties;\n  };\n\n  $scope.restartInterpreterSetting = function(settingId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to restart this interpreter?',\n      callback: function(result) {\n        if (result) {\n          $http.put(baseUrlSrv.getRestApiBase() + '/interpreter/setting/restart/' + settingId)\n            .success(function(data, status, headers, config) {\n              var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n              $scope.interpreterSettings[index] = data.body;\n              ngToast.info('Interpreter stopped. Will be lazily started on next run.');\n            }).error(function(data, status, headers, config) {\n              var errorMsg = (data !== null) ? data.message : 'Could not connect to server.';\n              console.log('Error %o %o', status, errorMsg);\n              ngToast.danger(errorMsg);\n          });\n        }\n      }\n    });\n  };\n\n  $scope.addNewInterpreterSetting = function() {\n    //user input validation on interpreter creation\n    if (!$scope.newInterpreterSetting.name ||\n      !$scope.newInterpreterSetting.name.trim() || !$scope.newInterpreterSetting.group) {\n      BootstrapDialog.alert({\n        closable: true,\n        title: 'Add interpreter',\n        message: 'Please fill in interpreter name and choose a group'\n      });\n      return;\n    }\n\n    if ($scope.newInterpreterSetting.name.indexOf('.') >= 0) {\n      BootstrapDialog.alert({\n        closable: true,\n        title: 'Add interpreter',\n        message: '\\'.\\' is invalid for interpreter name'\n      });\n      return;\n    }\n\n    if (_.findIndex($scope.interpreterSettings, {'name': $scope.newInterpreterSetting.name}) >= 0) {\n      BootstrapDialog.alert({\n        closable: true,\n        title: 'Add interpreter',\n        message: 'Name ' + $scope.newInterpreterSetting.name + ' already exists'\n      });\n      return;\n    }\n\n    var newSetting = $scope.newInterpreterSetting;\n    if (newSetting.propertyKey !== '' || newSetting.propertyKey) {\n      $scope.addNewInterpreterProperty();\n    }\n    if (newSetting.depArtifact !== '' || newSetting.depArtifact) {\n      $scope.addNewInterpreterDependency();\n    }\n    if (newSetting.option.setPermission === undefined) {\n      newSetting.option.setPermission = false;\n    }\n    newSetting.option.users = angular.element('#newInterpreterUsers').val();\n\n    var request = angular.copy($scope.newInterpreterSetting);\n\n    // Change properties to proper request format\n    var newProperties = {};\n    for (var p in newSetting.properties) {\n      newProperties[p] = newSetting.properties[p].value;\n    }\n    request.properties = newProperties;\n\n    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/setting', request)\n      .success(function(data, status, headers, config) {\n        $scope.resetNewInterpreterSetting();\n        getInterpreterSettings();\n        $scope.showAddNewSetting = false;\n        checkDownloadingDependencies();\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n      ngToast.danger({content: data.message, verticalPosition: 'bottom'});\n    });\n  };\n\n  $scope.cancelInterpreterSetting = function() {\n    $scope.showAddNewSetting = false;\n    $scope.resetNewInterpreterSetting();\n  };\n\n  $scope.resetNewInterpreterSetting = function() {\n    $scope.newInterpreterSetting = {\n      name: undefined,\n      group: undefined,\n      properties: {},\n      dependencies: [],\n      option: {\n        remote: true,\n        isExistingProcess: false,\n        setPermission: false,\n        session: false,\n        process: false\n\n      }\n    };\n    emptyNewProperty($scope.newInterpreterSetting);\n  };\n\n  $scope.removeInterpreterProperty = function(key, settingId) {\n    if (settingId === undefined) {\n      delete $scope.newInterpreterSetting.properties[key];\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      delete $scope.interpreterSettings[index].properties[key];\n    }\n  };\n\n  $scope.removeInterpreterDependency = function(artifact, settingId) {\n    if (settingId === undefined) {\n      $scope.newInterpreterSetting.dependencies = _.reject($scope.newInterpreterSetting.dependencies,\n        function(el) {\n          return el.groupArtifactVersion === artifact;\n        });\n    } else {\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      $scope.interpreterSettings[index].dependencies = _.reject($scope.interpreterSettings[index].dependencies,\n        function(el) {\n          return el.groupArtifactVersion === artifact;\n        });\n    }\n  };\n\n  $scope.addNewInterpreterProperty = function(settingId) {\n    if (settingId === undefined) {\n      // Add new property from create form\n      if (!$scope.newInterpreterSetting.propertyKey || $scope.newInterpreterSetting.propertyKey === '') {\n        return;\n      }\n\n      $scope.newInterpreterSetting.properties[$scope.newInterpreterSetting.propertyKey] = {\n        value: $scope.newInterpreterSetting.propertyValue\n      };\n      emptyNewProperty($scope.newInterpreterSetting);\n    } else {\n      // Add new property from edit form\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n\n      if (!setting.propertyKey || setting.propertyKey === '') {\n        return;\n      }\n      setting.properties[setting.propertyKey] = setting.propertyValue;\n      emptyNewProperty(setting);\n    }\n  };\n\n  $scope.addNewInterpreterDependency = function(settingId) {\n    if (settingId === undefined) {\n      // Add new dependency from create form\n      if (!$scope.newInterpreterSetting.depArtifact || $scope.newInterpreterSetting.depArtifact === '') {\n        return;\n      }\n\n      // overwrite if artifact already exists\n      var newSetting = $scope.newInterpreterSetting;\n      for (var d in newSetting.dependencies) {\n        if (newSetting.dependencies[d].groupArtifactVersion === newSetting.depArtifact) {\n          newSetting.dependencies[d] = {\n            'groupArtifactVersion': newSetting.depArtifact,\n            'exclusions': newSetting.depExclude\n          };\n          newSetting.dependencies.splice(d, 1);\n        }\n      }\n\n      newSetting.dependencies.push({\n        'groupArtifactVersion': newSetting.depArtifact,\n        'exclusions': (newSetting.depExclude === '') ? [] : newSetting.depExclude\n      });\n      emptyNewDependency(newSetting);\n    } else {\n      // Add new dependency from edit form\n      var index = _.findIndex($scope.interpreterSettings, {'id': settingId});\n      var setting = $scope.interpreterSettings[index];\n      if (!setting.depArtifact || setting.depArtifact === '') {\n        return;\n      }\n\n      // overwrite if artifact already exists\n      for (var dep in setting.dependencies) {\n        if (setting.dependencies[dep].groupArtifactVersion === setting.depArtifact) {\n          setting.dependencies[dep] = {\n            'groupArtifactVersion': setting.depArtifact,\n            'exclusions': setting.depExclude\n          };\n          setting.dependencies.splice(dep, 1);\n        }\n      }\n\n      setting.dependencies.push({\n        'groupArtifactVersion': setting.depArtifact,\n        'exclusions': (setting.depExclude === '') ? [] : setting.depExclude\n      });\n      emptyNewDependency(setting);\n    }\n  };\n\n  $scope.resetNewRepositorySetting = function() {\n    $scope.newRepoSetting = {\n      id: '',\n      url: '',\n      snapshot: false,\n      username: '',\n      password: '',\n      proxyProtocol: 'HTTP',\n      proxyHost: '',\n      proxyPort: null,\n      proxyLogin: '',\n      proxyPassword: ''\n    };\n  };\n\n  var getRepositories = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/repository')\n      .success(function(data, status, headers, config) {\n        $scope.repositories = data.body;\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  $scope.addNewRepository = function() {\n    var request = angular.copy($scope.newRepoSetting);\n\n    $http.post(baseUrlSrv.getRestApiBase() + '/interpreter/repository', request)\n      .success(function(data, status, headers, config) {\n        getRepositories();\n        $scope.resetNewRepositorySetting();\n        angular.element('#repoModal').modal('hide');\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', headers, config);\n    });\n  };\n\n  $scope.removeRepository = function(repoId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to delete this repository?',\n      callback: function(result) {\n        if (result) {\n          $http.delete(baseUrlSrv.getRestApiBase() + '/interpreter/repository/' + repoId)\n            .success(function(data, status, headers, config) {\n              var index = _.findIndex($scope.repositories, {'id': repoId});\n              $scope.repositories.splice(index, 1);\n            }).error(function(data, status, headers, config) {\n            console.log('Error %o %o', status, data.message);\n          });\n        }\n      }\n    });\n  };\n\n  $scope.isDefaultRepository = function(repoId) {\n    if (repoId === 'central' || repoId === 'local') {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  $scope.showErrorMessage = function(setting) {\n    BootstrapDialog.show({\n      title: 'Error downloading dependencies',\n      message: setting.errorReason\n    });\n  };\n\n  var init = function() {\n    $scope.resetNewInterpreterSetting();\n    $scope.resetNewRepositorySetting();\n\n    getInterpreterSettings();\n    getAvailableInterpreters();\n    getRepositories();\n  };\n\n  $scope.showSparkUI = function(settingId) {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/getmetainfos/' + settingId + '?propName=url')\n      .success(function(data, status, headers, config) {\n        var url = data.body.url;\n        if (!url) {\n          BootstrapDialog.alert({\n            message: 'No spark application running'\n          });\n          return;\n        }\n        window.open(url, '_blank');\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  init();\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/interpreter/interpreter.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').filter('sortByKey', sortByKey);\n\nfunction sortByKey() {\n  return function(properties) {\n    var sortedKeys = properties ? Object.keys(properties) : [];\n    return sortedKeys.sort();\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/interpreter/interpreter.filter.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('CredentialCtrl', CredentialCtrl);\n\nCredentialCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\nfunction CredentialCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n  $scope._ = _;\n  ngToast.dismiss();\n\n  $scope.credentialInfo = [];\n  $scope.showAddNewCredentialInfo = false;\n  $scope.availableInterpreters = [];\n\n  var getCredentialInfo = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/credential').\n    success(function(data, status, headers, config) {\n      $scope.credentialInfo  = _.map(data.body.userCredentials, function(value, prop) {\n        return {entity: prop, password: value.password, username: value.username};\n      });\n      console.log('Success %o %o', status, $scope.credentialInfo);\n    }).\n    error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  $scope.addNewCredentialInfo = function() {\n    if ($scope.entity && _.isEmpty($scope.entity.trim()) &&\n      $scope.username && _.isEmpty($scope.username.trim())) {\n      ngToast.danger({\n        content: 'Username \\\\ Entity can not be empty.',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      return;\n    }\n\n    var newCredential  = {\n      'entity': $scope.entity,\n      'username': $scope.username,\n      'password': $scope.password\n    };\n\n    $http.put(baseUrlSrv.getRestApiBase() + '/credential', newCredential).\n    success(function(data, status, headers, config) {\n      ngToast.success({\n        content: 'Successfully saved credentials.',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      $scope.credentialInfo.push(newCredential);\n      resetCredentialInfo();\n      $scope.showAddNewCredentialInfo = false;\n      console.log('Success %o %o', status, data.message);\n    }).\n    error(function(data, status, headers, config) {\n      ngToast.danger({\n        content: 'Error saving credentials',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var getAvailableInterpreters = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/interpreter/setting')\n      .success(function(data, status, headers, config) {\n        for (var setting = 0; setting < data.body.length; setting++) {\n          $scope.availableInterpreters.push(\n            data.body[setting].group + '.' + data.body[setting].name);\n        }\n        angular.element('#entityname').autocomplete({\n          source: $scope.availableInterpreters,\n          select: function(event, selected) {\n            $scope.entity = selected.item.value;\n            return false;\n          }\n        });\n      }).error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  $scope.toggleAddNewCredentialInfo = function() {\n    if ($scope.showAddNewCredentialInfo) {\n      $scope.showAddNewCredentialInfo = false;\n    } else {\n      $scope.showAddNewCredentialInfo = true;\n    }\n  };\n\n  $scope.cancelCredentialInfo = function() {\n    $scope.showAddNewCredentialInfo = false;\n    resetCredentialInfo();\n  };\n\n  var resetCredentialInfo = function() {\n    $scope.entity = '';\n    $scope.username = '';\n    $scope.password = '';\n  };\n\n  $scope.copyOriginCredentialsInfo = function() {\n    ngToast.info({\n      content: 'Since entity is a unique key, you can edit only username & password',\n      verticalPosition: 'bottom',\n      timeout: '3000'\n    });\n  };\n\n  $scope.updateCredentialInfo = function(form, data, entity) {\n    var request = {\n      entity: entity,\n      username: data.username,\n      password: data.password\n    };\n\n    $http.put(baseUrlSrv.getRestApiBase() + '/credential/', request).\n    success(function(data, status, headers, config) {\n      var index = _.findIndex($scope.credentialInfo, {'entity': entity});\n      $scope.credentialInfo[index] = request;\n      return true;\n    }).\n    error(function(data, status, headers, config) {\n      console.log('Error %o %o', status, data.message);\n      ngToast.danger({\n        content: 'We couldn\\'t save the credential',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      form.$show();\n    });\n    return false;\n  };\n\n  $scope.removeCredentialInfo = function(entity) {\n    BootstrapDialog.confirm({\n      closable: false,\n      closeByBackdrop: false,\n      closeByKeyboard: false,\n      title: '',\n      message: 'Do you want to delete this credential information?',\n      callback: function(result) {\n        if (result) {\n          $http.delete(baseUrlSrv.getRestApiBase() + '/credential/' + entity).\n          success(function(data, status, headers, config) {\n            var index = _.findIndex($scope.credentialInfo, {'entity': entity});\n            $scope.credentialInfo.splice(index, 1);\n            console.log('Success %o %o', status, data.message);\n          }).\n          error(function(data, status, headers, config) {\n            console.log('Error %o %o', status, data.message);\n          });\n        }\n      }\n    });\n  };\n\n  var init = function() {\n    getAvailableInterpreters();\n    getCredentialInfo();\n  };\n\n  init();\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/credential/credential.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('ConfigurationCtrl', ConfigurationCtrl);\n\nConfigurationCtrl.$inject = ['$scope', '$rootScope', '$http', 'baseUrlSrv', 'ngToast'];\n\nfunction ConfigurationCtrl($scope, $rootScope, $http, baseUrlSrv, ngToast) {\n  $scope.configrations = [];\n  $scope._ = _;\n  ngToast.dismiss();\n\n  var getConfigurations = function() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/configurations/all').\n    success(function(data, status, headers, config) {\n      $scope.configurations = data.body;\n    }).\n    error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  };\n\n  var init = function() {\n    getConfigurations();\n  };\n\n  init();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/configuration/configuration.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('ParagraphCtrl', ParagraphCtrl);\n\nParagraphCtrl.$inject = [\n  '$scope',\n  '$rootScope',\n  '$route',\n  '$window',\n  '$routeParams',\n  '$location',\n  '$timeout',\n  '$compile',\n  '$http',\n  '$q',\n  'websocketMsgSrv',\n  'baseUrlSrv',\n  'ngToast',\n  'saveAsService',\n  'noteVarShareService'\n];\n\nfunction ParagraphCtrl($scope, $rootScope, $route, $window, $routeParams, $location,\n                       $timeout, $compile, $http, $q, websocketMsgSrv,\n                       baseUrlSrv, ngToast, saveAsService, noteVarShareService) {\n  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n  $rootScope.keys = Object.keys;\n  $scope.parentNote = null;\n  $scope.paragraph = null;\n  $scope.originalText = '';\n  $scope.editor = null;\n\n  var editorSetting = {};\n  // flag that is used to set editor setting on paste percent sign\n  var pastePercentSign = false;\n  // flag that is used to set editor setting on save interpreter bindings\n  var setInterpreterBindings = false;\n  var paragraphScope = $rootScope.$new(true, $rootScope);\n\n  // to keep backward compatibility\n  $scope.compiledScope = paragraphScope;\n\n  paragraphScope.z = {\n    // z.runParagraph('20150213-231621_168813393')\n    runParagraph: function(paragraphId) {\n      if (paragraphId) {\n        var filtered = $scope.parentNote.paragraphs.filter(function(x) {\n          return x.id === paragraphId;});\n        if (filtered.length === 1) {\n          var paragraph = filtered[0];\n          websocketMsgSrv.runParagraph(paragraph.id, paragraph.title, paragraph.text,\n            paragraph.config, paragraph.settings.params);\n        } else {\n          ngToast.danger({content: 'Cannot find a paragraph with id \\'' + paragraphId + '\\'',\n            verticalPosition: 'top', dismissOnTimeout: false});\n        }\n      } else {\n        ngToast.danger({\n          content: 'Please provide a \\'paragraphId\\' when calling z.runParagraph(paragraphId)',\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    },\n\n    // Example: z.angularBind('my_var', 'Test Value', '20150213-231621_168813393')\n    angularBind: function(varName, value, paragraphId) {\n      // Only push to server if there paragraphId is defined\n      if (paragraphId) {\n        websocketMsgSrv.clientBindAngularObject($routeParams.noteId, varName, value, paragraphId);\n      } else {\n        ngToast.danger({\n          content: 'Please provide a \\'paragraphId\\' when calling ' +\n          'z.angularBind(varName, value, \\'PUT_HERE_PARAGRAPH_ID\\')',\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    },\n\n    // Example: z.angularUnBind('my_var', '20150213-231621_168813393')\n    angularUnbind: function(varName, paragraphId) {\n      // Only push to server if paragraphId is defined\n      if (paragraphId) {\n        websocketMsgSrv.clientUnbindAngularObject($routeParams.noteId, varName, paragraphId);\n      } else {\n        ngToast.danger({\n          content: 'Please provide a \\'paragraphId\\' when calling ' +\n          'z.angularUnbind(varName, \\'PUT_HERE_PARAGRAPH_ID\\')',\n          verticalPosition: 'top', dismissOnTimeout: false});\n      }\n    }\n  };\n\n  var angularObjectRegistry = {};\n\n  // Controller init\n  $scope.init = function(newParagraph, note) {\n    $scope.paragraph = newParagraph;\n    $scope.parentNote = note;\n    $scope.originalText = angular.copy(newParagraph.text);\n    $scope.chart = {};\n    $scope.baseMapOption = ['Streets', 'Satellite', 'Hybrid', 'Topo', 'Gray', 'Oceans', 'Terrain'];\n    $scope.colWidthOption = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];\n    $scope.paragraphFocused = false;\n    if (newParagraph.focus) {\n      $scope.paragraphFocused = true;\n    }\n    if (!$scope.paragraph.config) {\n      $scope.paragraph.config = {};\n    }\n\n    noteVarShareService.put($scope.paragraph.id + '_paragraphScope', paragraphScope);\n\n    initializeDefault($scope.paragraph.config);\n  };\n\n  var initializeDefault = function(config) {\n    var forms = $scope.paragraph.settings.forms;\n\n    if (!config.colWidth) {\n      config.colWidth = 12;\n    }\n\n    if (config.enabled === undefined) {\n      config.enabled = true;\n    }\n\n    for (var idx in forms) {\n      if (forms[idx]) {\n        if (forms[idx].options) {\n          if (config.runOnSelectionChange === undefined) {\n            config.runOnSelectionChange = true;\n          }\n        }\n      }\n    }\n\n    if (!config.results) {\n      config.results = {};\n    }\n\n    if (!config.editorSetting) {\n      config.editorSetting = {};\n    } else if (config.editorSetting.editOnDblClick) {\n      editorSetting.isOutputHidden = config.editorSetting.editOnDblClick;\n    }\n  };\n\n  $scope.$on('updateParagraphOutput', function(event, data) {\n    if ($scope.paragraph.id === data.paragraphId) {\n      if (!$scope.paragraph.results) {\n        $scope.paragraph.results = {};\n      }\n      if (!$scope.paragraph.results.msg) {\n        $scope.paragraph.results.msg = [];\n      }\n\n      var update = ($scope.paragraph.results.msg[data.index]) ? true : false;\n\n      $scope.paragraph.results.msg[data.index] = {\n        data: data.data,\n        type: data.type\n      };\n\n      if (update) {\n        $rootScope.$broadcast(\n          'updateResult',\n          $scope.paragraph.results.msg[data.index],\n          $scope.paragraph.config.results[data.index],\n          $scope.paragraph,\n          data.index);\n      }\n    }\n  });\n\n  $scope.getIframeDimensions = function() {\n    if ($scope.asIframe) {\n      var paragraphid = '#' + $routeParams.paragraphId + '_container';\n      var height = angular.element(paragraphid).height();\n      return height;\n    }\n    return 0;\n  };\n\n  $scope.$watch($scope.getIframeDimensions, function(newValue, oldValue) {\n    if ($scope.asIframe && newValue) {\n      var message = {};\n      message.height = newValue;\n      message.url = $location.$$absUrl;\n      $window.parent.postMessage(angular.toJson(message), '*');\n    }\n  });\n\n  $scope.getEditor = function() {\n    return $scope.editor;\n  };\n\n  $scope.$watch($scope.getEditor, function(newValue, oldValue) {\n    if (!$scope.editor) {\n      return;\n    }\n    if (newValue === null || newValue === undefined) {\n      console.log('editor isnt loaded yet, returning');\n      return;\n    }\n    if ($scope.revisionView === true) {\n      $scope.editor.setReadOnly(true);\n    } else {\n      $scope.editor.setReadOnly(false);\n    }\n  });\n\n  var isEmpty = function(object) {\n    return !object;\n  };\n\n  $scope.isRunning = function(paragraph) {\n    return paragraph.status === 'RUNNING' || paragraph.status === 'PENDING';\n  };\n\n  $scope.cancelParagraph = function(paragraph) {\n    console.log('Cancel %o', paragraph.id);\n    websocketMsgSrv.cancelParagraphRun(paragraph.id);\n  };\n\n  $scope.runParagraph = function(data) {\n    websocketMsgSrv.runParagraph($scope.paragraph.id, $scope.paragraph.title,\n      data, $scope.paragraph.config, $scope.paragraph.settings.params);\n    $scope.originalText = angular.copy(data);\n    $scope.dirtyText = undefined;\n\n    if ($scope.paragraph.config.editorSetting.editOnDblClick) {\n      closeEditorAndOpenTable($scope.paragraph);\n    } else if (editorSetting.isOutputHidden &&\n      !$scope.paragraph.config.editorSetting.editOnDblClick) {\n      // %md/%angular repl make output to be hidden by default after running\n      // so should open output if repl changed from %md/%angular to another\n      openEditorAndOpenTable($scope.paragraph);\n    }\n    editorSetting.isOutputHidden = $scope.paragraph.config.editorSetting.editOnDblClick;\n  };\n\n  $scope.saveParagraph = function(paragraph) {\n    const dirtyText = paragraph.text;\n    if (dirtyText === undefined || dirtyText === $scope.originalText) {\n      return;\n    }\n    commitParagraph(paragraph);\n    $scope.originalText = dirtyText;\n    $scope.dirtyText = undefined;\n  };\n\n  $scope.toggleEnableDisable = function(paragraph) {\n    paragraph.config.enabled = !paragraph.config.enabled;\n    commitParagraph(paragraph);\n  };\n\n  $scope.run = function(paragraph, editorValue) {\n    if (editorValue && !$scope.isRunning(paragraph)) {\n      $scope.runParagraph(editorValue);\n    }\n  };\n\n  $scope.turnOnAutoRun = function (paragraph) {\n    paragraph.config.runOnSelectionChange = !paragraph.config.runOnSelectionChange;\n    commitParagraph(paragraph);\n  };\n\n  $scope.moveUp = function(paragraph) {\n    $scope.$emit('moveParagraphUp', paragraph);\n  };\n\n  $scope.moveDown = function(paragraph) {\n    $scope.$emit('moveParagraphDown', paragraph);\n  };\n\n  $scope.insertNew = function(position) {\n    $scope.$emit('insertParagraph', $scope.paragraph.id, position);\n  };\n\n  $scope.copyPara = function(position) {\n    var editorValue = $scope.getEditorValue();\n    if (editorValue) {\n      $scope.copyParagraph(editorValue, position);\n    }\n  };\n\n  $scope.copyParagraph = function(data, position) {\n    var newIndex = -1;\n    for (var i = 0; i < $scope.note.paragraphs.length; i++) {\n      if ($scope.note.paragraphs[i].id === $scope.paragraph.id) {\n        //determine position of where to add new paragraph; default is below\n        if (position === 'above') {\n          newIndex = i;\n        } else {\n          newIndex = i + 1;\n        }\n        break;\n      }\n    }\n\n    if (newIndex < 0 || newIndex > $scope.note.paragraphs.length) {\n      return;\n    }\n\n    var config = angular.copy($scope.paragraph.config);\n    config.editorHide = false;\n\n    websocketMsgSrv.copyParagraph(newIndex, $scope.paragraph.title, data,\n      config, $scope.paragraph.settings.params);\n  };\n\n  $scope.removeParagraph = function(paragraph) {\n    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n    if (paragraphs[paragraphs.length - 1].id.indexOf(paragraph.id) === 0) {\n      BootstrapDialog.alert({\n        closable: true,\n        message: 'The last paragraph can\\'t be deleted.',\n        callback: function(result) {\n          if (result) {\n            $scope.editor.focus();\n          }\n        }\n      });\n    } else {\n      BootstrapDialog.confirm({\n        closable: true,\n        title: '',\n        message: 'Do you want to delete this paragraph?',\n        callback: function(result) {\n          if (result) {\n            console.log('Remove paragraph');\n            websocketMsgSrv.removeParagraph(paragraph.id);\n            $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n          }\n        }\n      });\n    }\n  };\n\n  $scope.clearParagraphOutput = function(paragraph) {\n    websocketMsgSrv.clearParagraphOutput(paragraph.id);\n  };\n\n  $scope.toggleEditor = function(paragraph) {\n    if (paragraph.config.editorHide) {\n      $scope.openEditor(paragraph);\n    } else {\n      $scope.closeEditor(paragraph);\n    }\n  };\n\n  $scope.closeEditor = function(paragraph) {\n    console.log('close the note');\n    paragraph.config.editorHide = true;\n    commitParagraph(paragraph);\n  };\n\n  $scope.openEditor = function(paragraph) {\n    console.log('open the note');\n    paragraph.config.editorHide = false;\n    commitParagraph(paragraph);\n  };\n\n  $scope.closeTable = function(paragraph) {\n    console.log('close the output');\n    paragraph.config.tableHide = true;\n    commitParagraph(paragraph);\n  };\n\n  $scope.openTable = function(paragraph) {\n    console.log('open the output');\n    paragraph.config.tableHide = false;\n    commitParagraph(paragraph);\n  };\n\n  var openEditorAndCloseTable = function(paragraph) {\n    manageEditorAndTableState(paragraph, false, true);\n  };\n\n  var closeEditorAndOpenTable = function(paragraph) {\n    manageEditorAndTableState(paragraph, true, false);\n  };\n\n  var openEditorAndOpenTable = function(paragraph) {\n    manageEditorAndTableState(paragraph, false, false);\n  };\n\n  var manageEditorAndTableState = function(paragraph, hideEditor, hideTable) {\n    paragraph.config.editorHide = hideEditor;\n    paragraph.config.tableHide = hideTable;\n    commitParagraph(paragraph);\n  };\n\n  $scope.showTitle = function(paragraph) {\n    paragraph.config.title = true;\n    commitParagraph(paragraph);\n  };\n\n  $scope.hideTitle = function(paragraph) {\n    paragraph.config.title = false;\n    commitParagraph(paragraph);\n  };\n\n  $scope.setTitle = function(paragraph) {\n    commitParagraph(paragraph);\n  };\n\n  $scope.showLineNumbers = function(paragraph) {\n    if ($scope.editor) {\n      paragraph.config.lineNumbers = true;\n      $scope.editor.renderer.setShowGutter(true);\n      commitParagraph(paragraph);\n    }\n  };\n\n  $scope.hideLineNumbers = function(paragraph) {\n    if ($scope.editor) {\n      paragraph.config.lineNumbers = false;\n      $scope.editor.renderer.setShowGutter(false);\n      commitParagraph(paragraph);\n    }\n  };\n\n  $scope.columnWidthClass = function(n) {\n    if ($scope.asIframe) {\n      return 'col-md-12';\n    } else {\n      return 'paragraph-col col-md-' + n;\n    }\n  };\n\n  $scope.changeColWidth = function(paragraph, width) {\n    angular.element('.navbar-right.open').removeClass('open');\n    paragraph.config.colWidth = width;\n    commitParagraph(paragraph);\n  };\n\n  $scope.toggleOutput = function(paragraph) {\n    paragraph.config.tableHide = !paragraph.config.tableHide;\n    commitParagraph(paragraph);\n  };\n\n  $scope.loadForm = function(formulaire, params) {\n    var value = formulaire.defaultValue;\n    if (params[formulaire.name]) {\n      value = params[formulaire.name];\n    }\n\n    $scope.paragraph.settings.params[formulaire.name] = value;\n  };\n\n  $scope.toggleCheckbox = function(formulaire, option) {\n    var idx = $scope.paragraph.settings.params[formulaire.name].indexOf(option.value);\n    if (idx > -1) {\n      $scope.paragraph.settings.params[formulaire.name].splice(idx, 1);\n    } else {\n      $scope.paragraph.settings.params[formulaire.name].push(option.value);\n    }\n  };\n\n  $scope.aceChanged = function(_, editor) {\n    var session = editor.getSession();\n    var dirtyText = session.getValue();\n    $scope.dirtyText = dirtyText;\n    $scope.startSaveTimer();\n    setParagraphMode(session, dirtyText, editor.getCursorPosition());\n  };\n\n  $scope.aceLoaded = function(_editor) {\n    var langTools = ace.require('ace/ext/language_tools');\n    var Range = ace.require('ace/range').Range;\n\n    _editor.$blockScrolling = Infinity;\n    $scope.editor = _editor;\n    $scope.editor.on('input', $scope.aceChanged);\n    if (_editor.container.id !== '{{paragraph.id}}_editor') {\n      $scope.editor.renderer.setShowGutter($scope.paragraph.config.lineNumbers);\n      $scope.editor.setShowFoldWidgets(false);\n      $scope.editor.setHighlightActiveLine(false);\n      $scope.editor.setHighlightGutterLine(false);\n      $scope.editor.getSession().setUseWrapMode(true);\n      $scope.editor.setTheme('ace/theme/chrome');\n      $scope.editor.setReadOnly($scope.isRunning($scope.paragraph));\n      if ($scope.paragraphFocused) {\n        $scope.editor.focus();\n        $scope.goToEnd($scope.editor);\n      }\n\n      autoAdjustEditorHeight(_editor);\n      angular.element(window).resize(function() {\n        autoAdjustEditorHeight(_editor);\n      });\n\n      if (navigator.appVersion.indexOf('Mac') !== -1) {\n        $scope.editor.setKeyboardHandler('ace/keyboard/emacs');\n        $rootScope.isMac = true;\n      } else if (navigator.appVersion.indexOf('Win') !== -1 ||\n        navigator.appVersion.indexOf('X11') !== -1 ||\n        navigator.appVersion.indexOf('Linux') !== -1) {\n        $rootScope.isMac = false;\n        // not applying emacs key binding while the binding override Ctrl-v. default behavior of paste text on windows.\n      }\n\n      var remoteCompleter = {\n        getCompletions: function(editor, session, pos, prefix, callback) {\n          if (!editor.isFocused()) {\n            return;\n          }\n\n          pos = session.getTextRange(new Range(0, 0, pos.row, pos.column)).length;\n          var buf = session.getValue();\n\n          websocketMsgSrv.completion($scope.paragraph.id, buf, pos);\n\n          $scope.$on('completionList', function(event, data) {\n            if (data.completions) {\n              var completions = [];\n              for (var c in data.completions) {\n                var v = data.completions[c];\n                completions.push({\n                  name: v.name,\n                  value: v.value,\n                  score: 300\n                });\n              }\n              callback(null, completions);\n            }\n          });\n        }\n      };\n\n      langTools.setCompleters([remoteCompleter, langTools.keyWordCompleter, langTools.snippetCompleter,\n        langTools.textCompleter]);\n\n      $scope.editor.setOptions({\n        enableBasicAutocompletion: true,\n        enableSnippets: false,\n        enableLiveAutocompletion: false\n      });\n\n      $scope.editor.on('focus', function() {\n        handleFocus(true);\n      });\n\n      $scope.editor.on('blur', function() {\n        handleFocus(false);\n        $scope.saveParagraph($scope.paragraph);\n      });\n\n      $scope.editor.on('paste', function(e) {\n        if (e.text.indexOf('%') === 0) {\n          pastePercentSign = true;\n        }\n      });\n\n      $scope.editor.getSession().on('change', function(e, editSession) {\n        autoAdjustEditorHeight(_editor);\n      });\n\n      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n\n      // autocomplete on '.'\n      /*\n       $scope.editor.commands.on(\"afterExec\", function(e, t) {\n       if (e.command.name == \"insertstring\" && e.args == \".\" ) {\n       var all = e.editor.completers;\n       //e.editor.completers = [remoteCompleter];\n       e.editor.execCommand(\"startAutocomplete\");\n       //e.editor.completers = all;\n       }\n       });\n       */\n\n      // remove binding\n      $scope.editor.commands.bindKey('ctrl-alt-n.', null);\n      $scope.editor.commands.removeCommand('showSettingsMenu');\n\n      $scope.editor.commands.bindKey('ctrl-alt-l', null);\n      $scope.editor.commands.bindKey('ctrl-alt-w', null);\n      $scope.editor.commands.bindKey('ctrl-alt-a', null);\n      $scope.editor.commands.bindKey('ctrl-alt-k', null);\n      $scope.editor.commands.bindKey('ctrl-alt-e', null);\n      $scope.editor.commands.bindKey('ctrl-alt-t', null);\n\n      // autocomplete on 'ctrl+.'\n      $scope.editor.commands.bindKey('ctrl-.', 'startAutocomplete');\n      $scope.editor.commands.bindKey('ctrl-space', null);\n\n      var keyBindingEditorFocusAction = function(scrollValue) {\n        var numRows = $scope.editor.getSession().getLength();\n        var currentRow = $scope.editor.getCursorPosition().row;\n        if (currentRow === 0 && scrollValue <= 0) {\n          // move focus to previous paragraph\n          $scope.$emit('moveFocusToPreviousParagraph', $scope.paragraph.id);\n        } else if (currentRow === numRows - 1 && scrollValue >= 0) {\n          $scope.$emit('moveFocusToNextParagraph', $scope.paragraph.id);\n        } else {\n          $scope.scrollToCursor($scope.paragraph.id, scrollValue);\n        }\n      };\n\n      // handle cursor moves\n      $scope.editor.keyBinding.origOnCommandKey = $scope.editor.keyBinding.onCommandKey;\n      $scope.editor.keyBinding.onCommandKey = function(e, hashId, keyCode) {\n        if ($scope.editor.completer && $scope.editor.completer.activated) { // if autocompleter is active\n        } else {\n          // fix ace editor focus issue in chrome (textarea element goes to top: -1000px after focused by cursor move)\n          if (parseInt(angular.element('#' + $scope.paragraph.id + '_editor > textarea')\n              .css('top').replace('px', '')) < 0) {\n            var position = $scope.editor.getCursorPosition();\n            var cursorPos = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n            angular.element('#' + $scope.paragraph.id + '_editor > textarea').css('top', cursorPos.top);\n          }\n\n          var ROW_UP = -1;\n          var ROW_DOWN = 1;\n\n          switch (keyCode) {\n            case 38:\n              keyBindingEditorFocusAction(ROW_UP);\n              break;\n            case 80:\n              if (e.ctrlKey && !e.altKey) {\n                keyBindingEditorFocusAction(ROW_UP);\n              }\n              break;\n            case 40:\n              keyBindingEditorFocusAction(ROW_DOWN);\n              break;\n            case 78:\n              if (e.ctrlKey && !e.altKey) {\n                keyBindingEditorFocusAction(ROW_DOWN);\n              }\n              break;\n          }\n        }\n        this.origOnCommandKey(e, hashId, keyCode);\n      };\n    }\n  };\n\n  var handleFocus = function(value, isDigestPass) {\n    $scope.paragraphFocused = value;\n    if (isDigestPass === false || isDigestPass === undefined) {\n      // Protect against error in case digest is already running\n      $timeout(function() {\n        // Apply changes since they come from 3rd party library\n        $scope.$digest();\n      });\n    }\n  };\n\n  var getEditorSetting = function(paragraph, interpreterName) {\n    var deferred = $q.defer();\n    websocketMsgSrv.getEditorSetting(paragraph.id, interpreterName);\n    $timeout(\n      $scope.$on('editorSetting', function(event, data) {\n          if (paragraph.id === data.paragraphId) {\n            deferred.resolve(data);\n          }\n        }\n      ), 1000);\n    return deferred.promise;\n  };\n\n  var setEditorLanguage = function(session, language) {\n    var mode = 'ace/mode/';\n    mode += language;\n    $scope.paragraph.config.editorMode = mode;\n    session.setMode(mode);\n  };\n\n  var setParagraphMode = function(session, paragraphText, pos) {\n    // Evaluate the mode only if the the position is undefined\n    // or the first 30 characters of the paragraph have been modified\n    // or cursor position is at beginning of second line.(in case user hit enter after typing %magic)\n    if ((typeof pos === 'undefined') || (pos.row === 0 && pos.column < 30) ||\n      (pos.row === 1 && pos.column === 0) || pastePercentSign) {\n      // If paragraph loading, use config value if exists\n      if ((typeof pos === 'undefined') && $scope.paragraph.config.editorMode &&\n        !setInterpreterBindings) {\n        session.setMode($scope.paragraph.config.editorMode);\n      } else {\n        var magic = getInterpreterName(paragraphText);\n        if (editorSetting.magic !== magic) {\n          editorSetting.magic = magic;\n          getEditorSetting($scope.paragraph, magic)\n            .then(function(setting) {\n              setEditorLanguage(session, setting.editor.language);\n              _.merge($scope.paragraph.config.editorSetting, setting.editor);\n            });\n        }\n      }\n    }\n    pastePercentSign = false;\n    setInterpreterBindings = false;\n  };\n\n  var getInterpreterName = function(paragraphText) {\n    var intpNameRegexp = /^\\s*%(.+?)\\s/g;\n    var match = intpNameRegexp.exec(paragraphText);\n    if (match) {\n      return match[1].trim();\n      // get default interpreter name if paragraph text doesn't start with '%'\n      // TODO(mina): dig into the cause what makes interpreterBindings to have no element\n    } else if ($scope.$parent.interpreterBindings && $scope.$parent.interpreterBindings.length !== 0) {\n      return $scope.$parent.interpreterBindings[0].name;\n    }\n    return '';\n  };\n\n  var autoAdjustEditorHeight = function(editor) {\n    var height =\n      editor.getSession().getScreenLength() *\n      editor.renderer.lineHeight +\n      editor.renderer.scrollBar.getWidth();\n\n    angular.element('#' + editor.container.id).height(height.toString() + 'px');\n    editor.resize();\n  };\n\n  $rootScope.$on('scrollToCursor', function(event) {\n    // scroll on 'scrollToCursor' event only when cursor is in the last paragraph\n    var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n    if (paragraphs[paragraphs.length - 1].id.indexOf($scope.paragraph.id) === 0) {\n      $scope.scrollToCursor($scope.paragraph.id, 0);\n    }\n  });\n\n  /** scrollToCursor if it is necessary\n   * when cursor touches scrollTriggerEdgeMargin from the top (or bottom) of the screen, it autoscroll to place cursor around 1/3 of screen height from the top (or bottom)\n   * paragraphId : paragraph that has active cursor\n   * lastCursorMove : 1(down), 0, -1(up) last cursor move event\n   **/\n  $scope.scrollToCursor = function(paragraphId, lastCursorMove) {\n    if (!$scope.editor || !$scope.editor.isFocused()) {\n      // only make sense when editor is focused\n      return;\n    }\n    var lineHeight = $scope.editor.renderer.lineHeight;\n    var headerHeight = 103; // menubar, notebook titlebar\n    var scrollTriggerEdgeMargin = 50;\n\n    var documentHeight = angular.element(document).height();\n    var windowHeight = angular.element(window).height();  // actual viewport height\n\n    var scrollPosition = angular.element(document).scrollTop();\n    var editorPosition = angular.element('#' + paragraphId + '_editor').offset();\n    var position = $scope.editor.getCursorPosition();\n    var lastCursorPosition = $scope.editor.renderer.$cursorLayer.getPixelPosition(position, true);\n\n    var calculatedCursorPosition = editorPosition.top + lastCursorPosition.top + lineHeight * lastCursorMove;\n\n    var scrollTargetPos;\n    if (calculatedCursorPosition < scrollPosition + headerHeight + scrollTriggerEdgeMargin) {\n      scrollTargetPos = calculatedCursorPosition - headerHeight - ((windowHeight - headerHeight) / 3);\n      if (scrollTargetPos < 0) {\n        scrollTargetPos = 0;\n      }\n    } else if (calculatedCursorPosition > scrollPosition + scrollTriggerEdgeMargin + windowHeight - headerHeight) {\n      scrollTargetPos = calculatedCursorPosition - headerHeight - ((windowHeight - headerHeight) * 2 / 3);\n\n      if (scrollTargetPos > documentHeight) {\n        scrollTargetPos = documentHeight;\n      }\n    }\n\n    // cancel previous scroll animation\n    var bodyEl = angular.element('body');\n    bodyEl.stop();\n    bodyEl.finish();\n\n    // scroll to scrollTargetPos\n    bodyEl.scrollTo(scrollTargetPos, {axis: 'y', interrupt: true, duration: 100});\n  };\n\n  $scope.getEditorValue = function() {\n    return !$scope.editor ? $scope.paragraph.text : $scope.editor.getValue();\n  };\n\n  $scope.getProgress = function() {\n    return $scope.currentProgress || 0;\n  };\n\n  $scope.getExecutionTime = function(pdata) {\n    var timeMs = Date.parse(pdata.dateFinished) - Date.parse(pdata.dateStarted);\n    if (isNaN(timeMs) || timeMs < 0) {\n      if ($scope.isResultOutdated(pdata)) {\n        return 'outdated';\n      }\n      return '';\n    }\n    var user = (pdata.user === undefined || pdata.user === null) ? 'anonymous' : pdata.user;\n    var desc = 'Took ' + moment.duration((timeMs / 1000), 'seconds').format('h [hrs] m [min] s [sec]') +\n      '. Last updated by ' + user + ' at ' + moment(pdata.dateFinished).format('MMMM DD YYYY, h:mm:ss A') + '.';\n    if ($scope.isResultOutdated(pdata)) {\n      desc += ' (outdated)';\n    }\n    return desc;\n  };\n\n  $scope.getElapsedTime = function(paragraph) {\n    return 'Started ' + moment(paragraph.dateStarted).fromNow() + '.';\n  };\n\n  $scope.isResultOutdated = function(pdata) {\n    if (pdata.dateUpdated !== undefined && Date.parse(pdata.dateUpdated) > Date.parse(pdata.dateStarted)) {\n      return true;\n    }\n    return false;\n  };\n\n  $scope.goToEnd = function(editor) {\n    editor.navigateFileEnd();\n  };\n\n  $scope.getResultType = function(paragraph) {\n    var pdata = (paragraph) ? paragraph : $scope.paragraph;\n    if (pdata.results && pdata.results.type) {\n      return pdata.results.type;\n    } else {\n      return 'TEXT';\n    }\n  };\n\n  $scope.parseTableCell = function(cell) {\n    if (!isNaN(cell)) {\n      if (cell.length === 0 || Number(cell) > Number.MAX_SAFE_INTEGER || Number(cell) < Number.MIN_SAFE_INTEGER) {\n        return cell;\n      } else {\n        return Number(cell);\n      }\n    }\n    var d = moment(cell);\n    if (d.isValid()) {\n      return d;\n    }\n    return cell;\n  };\n\n  var commitParagraph = function(paragraph) {\n    const {\n      id,\n      title,\n      text,\n      config,\n      settings: {params},\n    } = paragraph;\n\n    websocketMsgSrv.commitParagraph(id, title, text, config, params);\n  };\n\n  /** Utility function */\n  $scope.goToSingleParagraph = function() {\n    var noteId = $route.current.pathParams.noteId;\n    var redirectToUrl = location.protocol + '//' + location.host + location.pathname + '#/notebook/' + noteId +\n      '/paragraph/' + $scope.paragraph.id + '?asIframe';\n    $window.open(redirectToUrl);\n  };\n\n  $scope.showScrollDownIcon = function(id) {\n    var doc = angular.element('#p' + id + '_text');\n    if (doc[0]) {\n      return doc[0].scrollHeight > doc.innerHeight();\n    }\n    return false;\n  };\n\n  $scope.scrollParagraphDown = function(id) {\n    var doc = angular.element('#p' + id + '_text');\n    doc.animate({scrollTop: doc[0].scrollHeight}, 500);\n    $scope.keepScrollDown = true;\n  };\n\n  $scope.showScrollUpIcon = function(id) {\n    if (angular.element('#p' + id + '_text')[0]) {\n      return angular.element('#p' + id + '_text')[0].scrollTop !== 0;\n    }\n    return false;\n\n  };\n\n  $scope.scrollParagraphUp = function(id) {\n    var doc = angular.element('#p' + id + '_text');\n    doc.animate({scrollTop: 0}, 500);\n    $scope.keepScrollDown = false;\n  };\n\n  $scope.$on('angularObjectUpdate', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n        scope = paragraphScope;\n        registry = angularObjectRegistry;\n      } else {\n        return;\n      }\n      var varName = data.angularObject.name;\n\n      if (angular.equals(data.angularObject.object, scope[varName])) {\n        // return when update has no change\n        return;\n      }\n\n      if (!registry[varName]) {\n        registry[varName] = {\n          interpreterGroupId: data.interpreterGroupId,\n          noteId: data.noteId,\n          paragraphId: data.paragraphId\n        };\n      } else {\n        registry[varName].noteId = registry[varName].noteId || data.noteId;\n        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n      }\n\n      registry[varName].skipEmit = true;\n\n      if (!registry[varName].clearWatcher) {\n        registry[varName].clearWatcher = scope.$watch(varName, function(newValue, oldValue) {\n          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n          if (registry[varName].skipEmit) {\n            registry[varName].skipEmit = false;\n            return;\n          }\n          websocketMsgSrv.updateAngularObject(\n            registry[varName].noteId,\n            registry[varName].paragraphId,\n            varName,\n            newValue,\n            registry[varName].interpreterGroupId);\n        });\n      }\n      console.log('angular object (paragraph) created %o', varName);\n      scope[varName] = data.angularObject.object;\n\n      // create proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = function() {\n          scope[varName] = arguments;\n          console.log('angular function (paragraph) invoked %o', arguments);\n        };\n\n        console.log('angular function (paragraph) created %o', scope[funcName]);\n      }\n    }\n  });\n\n  $scope.$on('angularObjectRemove', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      if (!data.paragraphId || data.paragraphId === $scope.paragraph.id) {\n        scope = paragraphScope;\n        registry = angularObjectRegistry;\n      } else {\n        return;\n      }\n\n      var varName = data.name;\n\n      // clear watcher\n      if (registry[varName]) {\n        registry[varName].clearWatcher();\n        registry[varName] = undefined;\n      }\n\n      // remove scope variable\n      scope[varName] = undefined;\n\n      // remove proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = undefined;\n      }\n    }\n  });\n\n  $scope.$on('updateParagraph', function(event, data) {\n    if (data.paragraph.id === $scope.paragraph.id &&\n      (data.paragraph.dateCreated !== $scope.paragraph.dateCreated ||\n      data.paragraph.text !== $scope.paragraph.text ||\n      data.paragraph.dateFinished !== $scope.paragraph.dateFinished ||\n      data.paragraph.dateStarted !== $scope.paragraph.dateStarted ||\n      data.paragraph.dateUpdated !== $scope.paragraph.dateUpdated ||\n      data.paragraph.status !== $scope.paragraph.status ||\n      data.paragraph.jobName !== $scope.paragraph.jobName ||\n      data.paragraph.title !== $scope.paragraph.title ||\n      isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) ||\n      data.paragraph.errorMessage !== $scope.paragraph.errorMessage ||\n      !angular.equals(data.paragraph.settings, $scope.paragraph.settings) ||\n      !angular.equals(data.paragraph.config, $scope.paragraph.config))\n    ) {\n      var statusChanged = (data.paragraph.status !== $scope.paragraph.status);\n      var resultRefreshed = (data.paragraph.dateFinished !== $scope.paragraph.dateFinished) ||\n        isEmpty(data.paragraph.results) !== isEmpty($scope.paragraph.results) ||\n        data.paragraph.status === 'ERROR' || (data.paragraph.status === 'FINISHED' && statusChanged);\n\n      if ($scope.paragraph.text !== data.paragraph.text) {\n        if ($scope.dirtyText) {         // check if editor has local update\n          if ($scope.dirtyText === data.paragraph.text) {  // when local update is the same from remote, clear local update\n            $scope.paragraph.text = data.paragraph.text;\n            $scope.dirtyText = undefined;\n            $scope.originalText = angular.copy(data.paragraph.text);\n          } else { // if there're local update, keep it.\n            $scope.paragraph.text = data.paragraph.text;\n          }\n        } else {\n          $scope.paragraph.text = data.paragraph.text;\n          $scope.originalText = angular.copy(data.paragraph.text);\n        }\n      }\n\n      /** broadcast update to result controller **/\n      if (data.paragraph.results && data.paragraph.results.msg) {\n        for (var i in data.paragraph.results.msg) {\n          var newResult = data.paragraph.results.msg ? data.paragraph.results.msg[i] : {};\n          var oldResult = ($scope.paragraph.results && $scope.paragraph.results.msg) ?\n            $scope.paragraph.results.msg[i] : {};\n          var newConfig = data.paragraph.config.results ? data.paragraph.config.results[i] : {};\n          var oldConfig = $scope.paragraph.config.results ? $scope.paragraph.config.results[i] : {};\n          if (!angular.equals(newResult, oldResult) ||\n            !angular.equals(newConfig, oldConfig)) {\n            $rootScope.$broadcast('updateResult', newResult, newConfig, data.paragraph, parseInt(i));\n          }\n        }\n      }\n\n      // resize col width\n      if ($scope.paragraph.config.colWidth !== data.paragraph.colWidth) {\n        $rootScope.$broadcast('paragraphResized', $scope.paragraph.id);\n      }\n\n      /** push the rest */\n      $scope.paragraph.aborted = data.paragraph.aborted;\n      $scope.paragraph.user = data.paragraph.user;\n      $scope.paragraph.dateUpdated = data.paragraph.dateUpdated;\n      $scope.paragraph.dateCreated = data.paragraph.dateCreated;\n      $scope.paragraph.dateFinished = data.paragraph.dateFinished;\n      $scope.paragraph.dateStarted = data.paragraph.dateStarted;\n      $scope.paragraph.errorMessage = data.paragraph.errorMessage;\n      $scope.paragraph.jobName = data.paragraph.jobName;\n      $scope.paragraph.title = data.paragraph.title;\n      $scope.paragraph.lineNumbers = data.paragraph.lineNumbers;\n      $scope.paragraph.status = data.paragraph.status;\n      if (data.paragraph.status !== 'RUNNING') {\n        $scope.paragraph.results = data.paragraph.results;\n      }\n      $scope.paragraph.settings = data.paragraph.settings;\n      if ($scope.editor) {\n        $scope.editor.setReadOnly($scope.isRunning(data.paragraph));\n      }\n\n      if (!$scope.asIframe) {\n        $scope.paragraph.config = data.paragraph.config;\n        initializeDefault(data.paragraph.config);\n      } else {\n        data.paragraph.config.editorHide = true;\n        data.paragraph.config.tableHide = false;\n        $scope.paragraph.config = data.paragraph.config;\n      }\n\n      if (statusChanged || resultRefreshed) {\n        // when last paragraph runs, zeppelin automatically appends new paragraph.\n        // this broadcast will focus to the newly inserted paragraph\n        var paragraphs = angular.element('div[id$=\"_paragraphColumn_main\"]');\n        if (paragraphs.length >= 2 && paragraphs[paragraphs.length - 2].id.indexOf($scope.paragraph.id) === 0) {\n          // rendering output can took some time. So delay scrolling event firing for sometime.\n          setTimeout(function() {\n            $rootScope.$broadcast('scrollToCursor');\n          }, 500);\n        }\n      }\n    }\n  });\n\n  $scope.$on('updateProgress', function(event, data) {\n    if (data.id === $scope.paragraph.id) {\n      $scope.currentProgress = data.progress;\n    }\n  });\n\n  $scope.$on('keyEvent', function(event, keyEvent) {\n    if ($scope.paragraphFocused) {\n\n      var paragraphId = $scope.paragraph.id;\n      var keyCode = keyEvent.keyCode;\n      var noShortcutDefined = false;\n      var editorHide = $scope.paragraph.config.editorHide;\n\n      if (editorHide && (keyCode === 38 || (keyCode === 80 && keyEvent.ctrlKey && !keyEvent.altKey))) { // up\n        // move focus to previous paragraph\n        $scope.$emit('moveFocusToPreviousParagraph', paragraphId);\n      } else if (editorHide && (keyCode === 40 || (keyCode === 78 && keyEvent.ctrlKey && !keyEvent.altKey))) { // down\n        // move focus to next paragraph\n        // $timeout stops chaining effect of focus propogation\n        $timeout(() => $scope.$emit('moveFocusToNextParagraph', paragraphId))\n      } else if (keyEvent.shiftKey && keyCode === 13) { // Shift + Enter\n        $scope.run($scope.paragraph, $scope.getEditorValue());\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 67) { // Ctrl + Alt + c\n        $scope.cancelParagraph($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 68) { // Ctrl + Alt + d\n        $scope.removeParagraph($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 75) { // Ctrl + Alt + k\n        $scope.moveUp($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 74) { // Ctrl + Alt + j\n        $scope.moveDown($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 65) { // Ctrl + Alt + a\n        $scope.insertNew('above');\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 66) { // Ctrl + Alt + b\n        $scope.insertNew('below');\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 79) { // Ctrl + Alt + o\n        $scope.toggleOutput($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 82) { // Ctrl + Alt + r\n        $scope.toggleEnableDisable($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 69) { // Ctrl + Alt + e\n        $scope.toggleEditor($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 77) { // Ctrl + Alt + m\n        if ($scope.paragraph.config.lineNumbers) {\n          $scope.hideLineNumbers($scope.paragraph);\n        } else {\n          $scope.showLineNumbers($scope.paragraph);\n        }\n      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 189) { // Ctrl + Shift + -\n        $scope.changeColWidth($scope.paragraph, Math.max(1, $scope.paragraph.config.colWidth - 1));\n      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 187) { // Ctrl + Shift + =\n        $scope.changeColWidth($scope.paragraph, Math.min(12, $scope.paragraph.config.colWidth + 1));\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 84) { // Ctrl + Alt + t\n        if ($scope.paragraph.config.title) {\n          $scope.hideTitle($scope.paragraph);\n        } else {\n          $scope.showTitle($scope.paragraph);\n        }\n      } else if (keyEvent.ctrlKey && keyEvent.shiftKey && keyCode === 67) { // Ctrl + Alt + c\n        $scope.copyPara('below');\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 76) { // Ctrl + Alt + l\n        $scope.clearParagraphOutput($scope.paragraph);\n      } else if (keyEvent.ctrlKey && keyEvent.altKey && keyCode === 87) { // Ctrl + Alt + w\n        $scope.goToSingleParagraph();\n      } else {\n        noShortcutDefined = true;\n      }\n\n      if (!noShortcutDefined) {\n        keyEvent.preventDefault();\n      }\n    }\n  });\n\n  $scope.$on('focusParagraph', function(event, paragraphId, cursorPos, mouseEvent) {\n    if ($scope.paragraph.id === paragraphId) {\n      // focus editor\n      if (!$scope.paragraph.config.editorHide) {\n        if (!mouseEvent) {\n          $scope.editor.focus();\n          // move cursor to the first row (or the last row)\n          var row;\n          if (cursorPos >= 0) {\n            row = cursorPos;\n            $scope.editor.gotoLine(row, 0);\n          } else {\n            row = $scope.editor.session.getLength();\n            $scope.editor.gotoLine(row, 0);\n          }\n          $scope.scrollToCursor($scope.paragraph.id, 0);\n        }\n      }\n      handleFocus(true);\n    } else {\n      if ($scope.editor !== undefined && $scope.editor !== null) {\n        $scope.editor.blur();\n      }\n      var isDigestPass = true;\n      handleFocus(false, isDigestPass);\n    }\n  });\n\n  $scope.$on('saveInterpreterBindings', function(event, paragraphId) {\n    if ($scope.paragraph.id === paragraphId && $scope.editor) {\n      setInterpreterBindings = true;\n      setParagraphMode($scope.editor.getSession(), $scope.editor.getSession().getValue());\n    }\n  });\n\n  $scope.$on('doubleClickParagraph', function(event, paragraphId) {\n    if ($scope.paragraph.id === paragraphId && $scope.paragraph.config.editorHide &&\n      $scope.paragraph.config.editorSetting.editOnDblClick && $scope.revisionView !== true) {\n      var deferred = $q.defer();\n      openEditorAndCloseTable($scope.paragraph);\n      $timeout(\n        $scope.$on('updateParagraph', function(event, data) {\n            deferred.resolve(data);\n          }\n        ), 1000);\n\n      deferred.promise.then(function(data) {\n        if ($scope.editor) {\n          $scope.editor.focus();\n          $scope.goToEnd($scope.editor);\n        }\n      });\n    }\n  });\n\n  $scope.$on('openEditor', function(event) {\n    $scope.openEditor($scope.paragraph);\n  });\n\n  $scope.$on('closeEditor', function(event) {\n    $scope.closeEditor($scope.paragraph);\n  });\n\n  $scope.$on('openTable', function(event) {\n    $scope.openTable($scope.paragraph);\n  });\n\n  $scope.$on('closeTable', function(event) {\n    $scope.closeTable($scope.paragraph);\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebook/paragraph/paragraph.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TableData from '../../../tabledata/tabledata';\nimport TableVisualization from '../../../visualization/builtins/visualization-table';\nimport BarchartVisualization from '../../../visualization/builtins/visualization-barchart';\nimport PiechartVisualization from '../../../visualization/builtins/visualization-piechart';\nimport AreachartVisualization from '../../../visualization/builtins/visualization-areachart';\nimport LinechartVisualization from '../../../visualization/builtins/visualization-linechart';\nimport ScatterchartVisualization from '../../../visualization/builtins/visualization-scatterchart';\n\nangular.module('zeppelinWebApp').controller('ResultCtrl', ResultCtrl);\n\nResultCtrl.$inject = [\n  '$scope',\n  '$rootScope',\n  '$route',\n  '$window',\n  '$routeParams',\n  '$location',\n  '$timeout',\n  '$compile',\n  '$http',\n  '$q',\n  '$templateRequest',\n  '$sce',\n  'websocketMsgSrv',\n  'baseUrlSrv',\n  'ngToast',\n  'saveAsService',\n  'noteVarShareService',\n  'heliumService'\n];\n\nfunction ResultCtrl($scope, $rootScope, $route, $window, $routeParams, $location,\n                    $timeout, $compile, $http, $q, $templateRequest, $sce, websocketMsgSrv,\n                    baseUrlSrv, ngToast, saveAsService, noteVarShareService, heliumService) {\n\n  /**\n   * Built-in visualizations\n   */\n  $scope.builtInTableDataVisualizationList = [\n    {\n      id: 'table',   // paragraph.config.graph.mode\n      name: 'Table', // human readable name. tooltip\n      icon: '<i class=\"fa fa-table\"></i>'\n    },\n    {\n      id: 'multiBarChart',\n      name: 'Bar Chart',\n      icon: '<i class=\"fa fa-bar-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'pieChart',\n      name: 'Pie Chart',\n      icon: '<i class=\"fa fa-pie-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'stackedAreaChart',\n      name: 'Area Chart',\n      icon: '<i class=\"fa fa-area-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'lineChart',\n      name: 'Line Chart',\n      icon: '<i class=\"fa fa-line-chart\"></i>',\n      transformation: 'pivot'\n    },\n    {\n      id: 'scatterChart',\n      name: 'Scatter Chart',\n      icon: '<i class=\"cf cf-scatter-chart\"></i>'\n    }\n  ];\n\n  /**\n   * Holds class and actual runtime instance and related infos of built-in visualizations\n   */\n  var builtInVisualizations = {\n    'table': {\n      class: TableVisualization,\n      instance: undefined   // created from setGraphMode()\n    },\n    'multiBarChart': {\n      class: BarchartVisualization,\n      instance: undefined\n    },\n    'pieChart': {\n      class: PiechartVisualization,\n      instance: undefined\n    },\n    'stackedAreaChart': {\n      class: AreachartVisualization,\n      instance: undefined\n    },\n    'lineChart': {\n      class: LinechartVisualization,\n      instance: undefined\n    },\n    'scatterChart': {\n      class: ScatterchartVisualization,\n      instance: undefined\n    }\n  };\n\n  // type\n  $scope.type;\n\n  // Data of the result\n  var data;\n\n  // config\n  $scope.config;\n\n  // resultId = paragraph.id + index\n  $scope.id;\n\n  // referece to paragraph\n  var paragraph;\n\n  // index of the result\n  var resultIndex;\n\n  // TableData instance\n  var tableData;\n\n  // available columns in tabledata\n  $scope.tableDataColumns = [];\n\n  // enable helium\n  var enableHelium = false;\n\n  // graphMode\n  $scope.graphMode;\n\n  // image data\n  $scope.imageData;\n\n  $scope.init = function(result, config, paragraph, index) {\n    console.log('result controller init %o %o %o', result, config, index);\n\n    // register helium plugin vis\n    var heliumVis = heliumService.get();\n    console.log('Helium visualizations %o', heliumVis);\n    heliumVis.forEach(function(vis) {\n      $scope.builtInTableDataVisualizationList.push({\n        id: vis.id,\n        name: vis.name,\n        icon: $sce.trustAsHtml(vis.icon)\n      });\n      builtInVisualizations[vis.id] = {\n        class: vis.class\n      };\n    });\n\n    updateData(result, config, paragraph, index);\n    renderResult($scope.type);\n  };\n\n  $scope.$on('updateResult', function(event, result, newConfig, paragraphRef, index) {\n    if (paragraph.id !== paragraphRef.id || index !== resultIndex) {\n      return;\n    }\n    console.log('updateResult %o %o %o %o', result, newConfig, paragraphRef, index);\n    var refresh = !angular.equals(newConfig, $scope.config) ||\n      !angular.equals(result.type, $scope.type) ||\n      !angular.equals(result.data, data);\n\n    updateData(result, newConfig, paragraph, resultIndex);\n    renderResult($scope.type, refresh);\n  });\n\n  $scope.$on('appendParagraphOutput', function(event, data) {\n    /* It has been observed that append events\n     * can be errorneously called even if paragraph\n     * execution has ended, and in that case, no append\n     * should be made. Also, it was observed that between PENDING\n     * and RUNNING states, append-events can be called and we can't\n     * miss those, else during the length of paragraph run, few\n     * initial output line/s will be missing.\n     */\n    if (paragraph.id === data.paragraphId &&\n      resultIndex === data.index &&\n      (paragraph.status === 'RUNNING' || paragraph.status === 'PENDING')) {\n      appendTextOutput(data.data);\n    }\n  });\n\n  $scope.$on('updateParagraphOutput', function(event, data) {\n    if (paragraph.id === data.paragraphId &&\n      resultIndex === data.index) {\n      clearTextOutput();\n      appendTextOutput(data.data);\n    }\n  });\n\n  var updateData = function(result, config, paragraphRef, index) {\n    data = result.data;\n    paragraph = paragraphRef;\n    resultIndex = parseInt(index);\n\n    $scope.id = paragraph.id + '_' + index;\n    $scope.type = result.type;\n    config = config ? config : {};\n\n    // initialize default config values\n    if (!config.graph) {\n      config.graph = {};\n    }\n\n    if (!config.graph.mode) {\n      config.graph.mode = 'table';\n    }\n\n    if (!config.graph.height) {\n      config.graph.height = 300;\n    }\n\n    if (!config.graph.optionOpen) {\n      config.graph.optionOpen = false;\n    }\n\n    $scope.graphMode = config.graph.mode;\n    $scope.config = angular.copy(config);\n\n    // enable only when it is last result\n    enableHelium = (index === paragraphRef.results.msg.length - 1);\n\n    if ($scope.type === 'TABLE') {\n      tableData = new TableData();\n      tableData.loadParagraphResult({type: $scope.type, msg: data});\n      $scope.tableDataColumns = tableData.columns;\n      $scope.tableDataComment = tableData.comment;\n    } else if ($scope.type === 'IMG') {\n      $scope.imageData = data;\n    }\n  };\n\n  var renderResult = function(type, refresh) {\n    var activeApp;\n    if (enableHelium) {\n      getSuggestions();\n      getApplicationStates();\n      activeApp = _.get($scope.config, 'helium.activeApp');\n    }\n\n    if (activeApp) {\n      var app = _.find($scope.apps, {id: activeApp});\n      renderApp(app);\n    } else {\n      if (type === 'TABLE') {\n        var retryRenderer = function() {\n          var elem = angular.element('#p' + $scope.id + '_graph');\n          if (elem.length) { $scope.renderGraph($scope.graphMode, refresh); }\n          else { $timeout(retryRenderer, 10); }\n        };\n        $timeout(retryRenderer);\n      } else if (type === 'HTML') {\n        renderHtml();\n      } else if (type === 'ANGULAR') {\n        renderAngular();\n      } else if (type === 'TEXT') {\n        renderText();\n      }\n    }\n  };\n\n  var renderHtml = function() {\n    var retryRenderer = function() {\n      var htmlEl = angular.element('#p' + $scope.id + '_html');\n      if (htmlEl.length) {\n        try {\n          htmlEl.html(data);\n\n          htmlEl.find('pre code').each(function(i, e) {\n            hljs.highlightBlock(e);\n          });\n          /*eslint new-cap: [2, {\"capIsNewExceptions\": [\"MathJax.Hub.Queue\"]}]*/\n          MathJax.Hub.Queue(['Typeset', MathJax.Hub, htmlEl[0]]);\n        } catch (err) {\n          console.log('HTML rendering error %o', err);\n        }\n      } else {\n        $timeout(retryRenderer, 10);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  var renderAngular = function() {\n    var retryRenderer = function() {\n      if (angular.element('#p' + $scope.id + '_angular').length) {\n        try {\n          angular.element('#p' + $scope.id + '_angular').html(data);\n\n          var paragraphScope = noteVarShareService.get(paragraph.id + '_paragraphScope');\n          $compile(angular.element('#p' + $scope.id + '_angular').contents())(paragraphScope);\n        } catch (err) {\n          console.log('ANGULAR rendering error %o', err);\n        }\n      } else {\n        $timeout(retryRenderer, 10);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  var getTextEl = function (paragraphId) {\n    return angular.element('#p' + $scope.id + '_text');\n  }\n\n  var textRendererInitialized = false;\n  var renderText = function() {\n    var retryRenderer = function() {\n      var textEl = getTextEl($scope.id);\n      if (textEl.length) {\n        // clear all lines before render\n        clearTextOutput();\n        textRendererInitialized = true;\n\n        if (data) {\n          appendTextOutput(data);\n        } else {\n          flushAppendQueue();\n        }\n\n        getTextEl($scope.id).bind('mousewheel', function(e) {\n          $scope.keepScrollDown = false;\n        });\n      } else {\n        $timeout(retryRenderer, 10);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  var clearTextOutput = function() {\n    var textEl = getTextEl($scope.id);\n    if (textEl.length) {\n      textEl.children().remove();\n    }\n  };\n\n  var textAppendQueueBeforeInitialize = [];\n\n  var flushAppendQueue = function() {\n    while (textAppendQueueBeforeInitialize.length > 0) {\n      appendTextOutput(textAppendQueueBeforeInitialize.pop());\n    }\n  };\n\n  var appendTextOutput = function(msg) {\n    if (!textRendererInitialized) {\n      textAppendQueueBeforeInitialize.push(msg);\n    } else {\n      flushAppendQueue();\n      var textEl = getTextEl($scope.id);\n      if (textEl.length) {\n        var lines = msg.split('\\n');\n        for (var i = 0; i < lines.length; i++) {\n          textEl.append(angular.element('<div></div>').text(lines[i]));\n        }\n      }\n      if ($scope.keepScrollDown) {\n        var doc = getTextEl($scope.id);\n        doc[0].scrollTop = doc[0].scrollHeight;\n      }\n    }\n  };\n\n  $scope.renderGraph = function(type, refresh) {\n    // set graph height\n    var height = $scope.config.graph.height;\n    var graphContainerEl = angular.element('#p' + $scope.id + '_graph');\n    graphContainerEl.height(height);\n\n    if (!type) {\n      type = 'table';\n    }\n\n    var builtInViz = builtInVisualizations[type];\n    if (builtInViz) {\n      // deactive previsouly active visualization\n      for (var t in builtInVisualizations) {\n        var v = builtInVisualizations[t].instance;\n\n        if (t !== type && v && v.isActive()) {\n          v.deactivate();\n          break;\n        }\n      }\n\n      if (!builtInViz.instance) { // not instantiated yet\n        // render when targetEl is available\n        var retryRenderer = function() {\n          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n          var visualizationSettingTargetEl = angular.element('#vizsetting' + $scope.id + '_' + type);\n          if (targetEl.length) {\n            try {\n              // set height\n              targetEl.height(height);\n\n              // instantiate visualization\n              var config = getVizConfig(type);\n              var Visualization = builtInViz.class;\n              builtInViz.instance = new Visualization(targetEl, config);\n\n              // inject emitter, $templateRequest\n              var emitter = function(graphSetting) {\n                commitVizConfigChange(graphSetting, type);\n              };\n              builtInViz.instance._emitter = emitter;\n              builtInViz.instance._compile = $compile;\n              builtInViz.instance._createNewScope = createNewScope;\n              var transformation = builtInViz.instance.getTransformation();\n              transformation._emitter = emitter;\n              transformation._templateRequest = $templateRequest;\n              transformation._compile = $compile;\n              transformation._createNewScope = createNewScope;\n\n              // render\n              var transformed = transformation.transform(tableData);\n              transformation.renderSetting(transformationSettingTargetEl);\n              builtInViz.instance.render(transformed);\n              builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n              builtInViz.instance.activate();\n              angular.element(window).resize(function() {\n                builtInViz.instance.resize();\n              });\n            } catch (err) {\n              console.error('Graph drawing error %o', err);\n            }\n          } else {\n            $timeout(retryRenderer, 10);\n          }\n        };\n        $timeout(retryRenderer);\n      } else if (refresh) {\n        console.log('Refresh data %o', tableData);\n        // when graph options or data are changed\n        var retryRenderer = function() {\n          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n          var transformationSettingTargetEl = angular.element('#trsetting' + $scope.id + '_' + type);\n          var visualizationSettingTargetEl = angular.element('#vizsetting' + $scope.id + '_' + type);\n          if (targetEl.length) {\n            var config = getVizConfig(type);\n            targetEl.height(height);\n            var transformation = builtInViz.instance.getTransformation();\n            transformation.setConfig(config);\n            var transformed = transformation.transform(tableData);\n            transformation.renderSetting(transformationSettingTargetEl);\n            builtInViz.instance.setConfig(config);\n            builtInViz.instance.render(transformed);\n            builtInViz.instance.renderSetting(visualizationSettingTargetEl);\n          } else {\n            $timeout(retryRenderer, 10);\n          }\n        };\n        $timeout(retryRenderer);\n      } else {\n        var retryRenderer = function() {\n          var targetEl = angular.element('#p' + $scope.id + '_' + type);\n          if (targetEl.length) {\n            targetEl.height(height);\n            builtInViz.instance.activate();\n          } else {\n            $timeout(retryRenderer, 10);\n          }\n        };\n        $timeout(retryRenderer);\n      }\n    }\n  };\n  $scope.switchViz = function(newMode) {\n    var newConfig = angular.copy($scope.config);\n    var newParams = angular.copy(paragraph.settings.params);\n\n    // graph options\n    newConfig.graph.mode = newMode;\n\n    // see switchApp()\n    _.set(newConfig, 'helium.activeApp', undefined);\n\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  var createNewScope = function() {\n    return $rootScope.$new(true);\n  };\n\n  var commitParagraphResult = function(title, text, config, params) {\n    var newParagraphConfig = angular.copy(paragraph.config);\n    newParagraphConfig.results = newParagraphConfig.results || [];\n    newParagraphConfig.results[resultIndex] = config;\n    if ($scope.revisionView === true) {\n      // local update without commit\n      updateData({\n        type: $scope.type,\n        data: data\n      }, newParagraphConfig.results[resultIndex], paragraph, resultIndex);\n      renderResult($scope.type, true);\n    } else {\n      websocketMsgSrv.commitParagraph(paragraph.id, title, text, newParagraphConfig, params);\n    }\n  };\n\n  $scope.toggleGraphSetting = function() {\n    var newConfig = angular.copy($scope.config);\n    if (newConfig.graph.optionOpen) {\n      newConfig.graph.optionOpen = false;\n    } else {\n      newConfig.graph.optionOpen = true;\n    }\n    var newParams = angular.copy(paragraph.settings.params);\n\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  var getVizConfig = function(vizId) {\n    var config;\n    var graph = $scope.config.graph;\n    if (graph) {\n      // copy setting for vizId\n      if (graph.setting) {\n        config = angular.copy(graph.setting[vizId]);\n      }\n\n      if (!config) {\n        config = {};\n      }\n\n      // copy common setting\n      config.common = angular.copy(graph.commonSetting) || {};\n\n      // copy pivot setting\n      if (graph.keys) {\n        config.common.pivot = {\n          keys: angular.copy(graph.keys),\n          groups: angular.copy(graph.groups),\n          values: angular.copy(graph.values)\n        };\n      }\n    }\n    console.log('getVizConfig', config);\n    return config;\n  };\n\n  var commitVizConfigChange = function(config, vizId) {\n    var newConfig = angular.copy($scope.config);\n    if (!newConfig.graph) {\n      newConfig.graph = {};\n    }\n\n    // copy setting for vizId\n    if (!newConfig.graph.setting) {\n      newConfig.graph.setting = {};\n    }\n    newConfig.graph.setting[vizId] = angular.copy(config);\n\n    // copy common setting\n    if (newConfig.graph.setting[vizId]) {\n      newConfig.graph.commonSetting = newConfig.graph.setting[vizId].common;\n      delete newConfig.graph.setting[vizId].common;\n    }\n\n    // copy pivot setting\n    if (newConfig.graph.commonSetting && newConfig.graph.commonSetting.pivot) {\n      newConfig.graph.keys = newConfig.graph.commonSetting.pivot.keys;\n      newConfig.graph.groups = newConfig.graph.commonSetting.pivot.groups;\n      newConfig.graph.values = newConfig.graph.commonSetting.pivot.values;\n      delete newConfig.graph.commonSetting.pivot;\n    }\n    console.log('committVizConfig', newConfig);\n    var newParams = angular.copy(paragraph.settings.params);\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  $scope.$on('paragraphResized', function(event, paragraphId) {\n    // paragraph col width changed\n    if (paragraphId === paragraph.id) {\n      var builtInViz = builtInVisualizations[$scope.graphMode];\n      if (builtInViz && builtInViz.instance) {\n        builtInViz.instance.resize();\n      }\n    }\n  });\n\n  $scope.resize = function(width, height) {\n    $timeout(function() {\n      changeHeight(width, height);\n    }, 200);\n  };\n\n  var changeHeight = function(width, height) {\n    var newParams = angular.copy(paragraph.settings.params);\n    var newConfig = angular.copy($scope.config);\n\n    newConfig.graph.height = height;\n    paragraph.config.colWidth = width;\n\n    commitParagraphResult(paragraph.title, paragraph.text, newConfig, newParams);\n  };\n\n  $scope.exportToDSV = function(delimiter) {\n    var dsv = '';\n    var dateFinished = moment(paragraph.dateFinished).format('YYYY-MM-DD hh:mm:ss A');\n    var exportedFileName = paragraph.title ? paragraph.title + '_' + dateFinished : 'data_' + dateFinished;\n\n    for (var titleIndex in tableData.columns) {\n      dsv += tableData.columns[titleIndex].name + delimiter;\n    }\n    dsv = dsv.substring(0, dsv.length - 1) + '\\n';\n    for (var r in tableData.rows) {\n      var row = tableData.rows[r];\n      var dsvRow = '';\n      for (var index in row) {\n        var stringValue =  (row[index]).toString();\n        if (stringValue.indexOf(delimiter) > -1) {\n          dsvRow += '\"' + stringValue + '\"' + delimiter;\n        } else {\n          dsvRow += row[index] + delimiter;\n        }\n      }\n      dsv += dsvRow.substring(0, dsvRow.length - 1) + '\\n';\n    }\n    var extension = '';\n    if (delimiter === '\\t') {\n      extension = 'tsv';\n    } else if (delimiter === ',') {\n      extension = 'csv';\n    }\n    saveAsService.saveAs(dsv, exportedFileName, extension);\n  };\n\n  $scope.getBase64ImageSrc = function(base64Data) {\n    return 'data:image/png;base64,' + base64Data;\n  };\n\n  // Helium ----------------\n  var ANGULAR_FUNCTION_OBJECT_NAME_PREFIX = '_Z_ANGULAR_FUNC_';\n\n  // app states\n  $scope.apps = [];\n\n  // suggested apps\n  $scope.suggestion = {};\n\n  $scope.switchApp = function(appId) {\n    var newConfig = angular.copy($scope.config);\n    var newParams = angular.copy(paragraph.settings.params);\n\n    // 'helium.activeApp' can be cleared by switchViz()\n    _.set(newConfig, 'helium.activeApp', appId);\n\n    commitConfig(newConfig, newParams);\n  };\n\n  $scope.loadApp = function(heliumPackage) {\n    var noteId = $route.current.pathParams.noteId;\n    $http.post(baseUrlSrv.getRestApiBase() + '/helium/load/' + noteId + '/' + paragraph.id, heliumPackage)\n      .success(function(data, status, headers, config) {\n        console.log('Load app %o', data);\n      })\n      .error(function(err, status, headers, config) {\n        console.log('Error %o', err);\n      });\n  };\n\n  var commitConfig = function(config, params) {\n    commitParagraphResult(paragraph.title, paragraph.text, config, params);\n  };\n\n  var getApplicationStates = function() {\n    var appStates = [];\n\n    // Display ApplicationState\n    if (paragraph.apps) {\n      _.forEach(paragraph.apps, function(app) {\n        appStates.push({\n          id: app.id,\n          pkg: app.pkg,\n          status: app.status,\n          output: app.output\n        });\n      });\n    }\n\n    // update or remove app states no longer exists\n    _.forEach($scope.apps, function(currentAppState, idx) {\n      var newAppState = _.find(appStates, {id: currentAppState.id});\n      if (newAppState) {\n        angular.extend($scope.apps[idx], newAppState);\n      } else {\n        $scope.apps.splice(idx, 1);\n      }\n    });\n\n    // add new app states\n    _.forEach(appStates, function(app, idx) {\n      if ($scope.apps.length <= idx || $scope.apps[idx].id !== app.id) {\n        $scope.apps.splice(idx, 0, app);\n      }\n    });\n  };\n\n  var getSuggestions = function() {\n    // Get suggested apps\n    var noteId = $route.current.pathParams.noteId;\n    if (!noteId) {\n    return;\n    }\n    $http.get(baseUrlSrv.getRestApiBase() + '/helium/suggest/' + noteId + '/' + paragraph.id)\n      .success(function(data, status, headers, config) {\n        $scope.suggestion = data.body;\n      })\n      .error(function(err, status, headers, config) {\n        console.log('Error %o', err);\n      });\n  };\n\n  var renderApp = function(appState) {\n    var retryRenderer = function() {\n      var targetEl = angular.element(document.getElementById('p' + appState.id));\n      console.log('retry renderApp %o', targetEl);\n      if (targetEl.length) {\n        try {\n          console.log('renderApp %o', appState);\n          targetEl.html(appState.output);\n          $compile(targetEl.contents())(getAppScope(appState));\n        } catch (err) {\n          console.log('App rendering error %o', err);\n        }\n      } else {\n        $timeout(retryRenderer, 1000);\n      }\n    };\n    $timeout(retryRenderer);\n  };\n\n  /*\n   ** $scope.$on functions below\n   */\n  $scope.$on('appendAppOutput', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (app) {\n        app.output += data.data;\n\n        var paragraphAppState = _.find(paragraph.apps, {id: data.appId});\n        paragraphAppState.output = app.output;\n\n        var targetEl = angular.element(document.getElementById('p' + app.id));\n        targetEl.html(app.output);\n        $compile(targetEl.contents())(getAppScope(app));\n        console.log('append app output %o', $scope.apps);\n      }\n    }\n  });\n\n  $scope.$on('updateAppOutput', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (app) {\n        app.output = data.data;\n\n        var paragraphAppState = _.find(paragraph.apps, {id: data.appId});\n        paragraphAppState.output = app.output;\n\n        var targetEl = angular.element(document.getElementById('p' + app.id));\n        targetEl.html(app.output);\n        $compile(targetEl.contents())(getAppScope(app));\n        console.log('append app output');\n      }\n    }\n  });\n\n  $scope.$on('appLoad', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (!app) {\n        app = {\n          id: data.appId,\n          pkg: data.pkg,\n          status: 'UNLOADED',\n          output: ''\n        };\n\n        $scope.apps.push(app);\n        paragraph.apps.push(app);\n        $scope.switchApp(app.id);\n      }\n    }\n  });\n\n  $scope.$on('appStatusChange', function(event, data) {\n    if (paragraph.id === data.paragraphId) {\n      var app = _.find($scope.apps, {id: data.appId});\n      if (app) {\n        app.status = data.status;\n        var paragraphAppState = _.find(paragraph.apps, {id: data.appId});\n        paragraphAppState.status = app.status;\n      }\n    }\n  });\n\n  var getAppRegistry = function(appState) {\n    if (!appState.registry) {\n      appState.registry = {};\n    }\n\n    return appState.registry;\n  };\n\n  var getAppScope = function(appState) {\n    if (!appState.scope) {\n      appState.scope = $rootScope.$new(true, $rootScope);\n    }\n    return appState.scope;\n  };\n\n  $scope.$on('angularObjectUpdate', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      var app = _.find($scope.apps, {id: data.paragraphId});\n      if (app) {\n        scope = getAppScope(app);\n        registry = getAppRegistry(app);\n      } else {\n        // no matching app in this paragraph\n        return;\n      }\n\n      var varName = data.angularObject.name;\n\n      if (angular.equals(data.angularObject.object, scope[varName])) {\n        // return when update has no change\n        return;\n      }\n\n      if (!registry[varName]) {\n        registry[varName] = {\n          interpreterGroupId: data.interpreterGroupId,\n          noteId: data.noteId,\n          paragraphId: data.paragraphId\n        };\n      } else {\n        registry[varName].noteId = registry[varName].noteId || data.noteId;\n        registry[varName].paragraphId = registry[varName].paragraphId || data.paragraphId;\n      }\n\n      registry[varName].skipEmit = true;\n\n      if (!registry[varName].clearWatcher) {\n        registry[varName].clearWatcher = scope.$watch(varName, function(newValue, oldValue) {\n          console.log('angular object (paragraph) updated %o %o', varName, registry[varName]);\n          if (registry[varName].skipEmit) {\n            registry[varName].skipEmit = false;\n            return;\n          }\n          websocketMsgSrv.updateAngularObject(\n            registry[varName].noteId,\n            registry[varName].paragraphId,\n            varName,\n            newValue,\n            registry[varName].interpreterGroupId);\n        });\n      }\n      console.log('angular object (paragraph) created %o', varName);\n      scope[varName] = data.angularObject.object;\n\n      // create proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = function() {\n          scope[varName] = arguments;\n          console.log('angular function (paragraph) invoked %o', arguments);\n        };\n\n        console.log('angular function (paragraph) created %o', scope[funcName]);\n      }\n    }\n  });\n\n  $scope.$on('angularObjectRemove', function(event, data) {\n    var noteId = $route.current.pathParams.noteId;\n    if (!data.noteId || data.noteId === noteId) {\n      var scope;\n      var registry;\n\n      var app = _.find($scope.apps, {id: data.paragraphId});\n      if (app) {\n        scope = getAppScope(app);\n        registry = getAppRegistry(app);\n      } else {\n        // no matching app in this paragraph\n        return;\n      }\n\n      var varName = data.name;\n\n      // clear watcher\n      if (registry[varName]) {\n        registry[varName].clearWatcher();\n        registry[varName] = undefined;\n      }\n\n      // remove scope variable\n      scope[varName] = undefined;\n\n      // remove proxy for AngularFunction\n      if (varName.indexOf(ANGULAR_FUNCTION_OBJECT_NAME_PREFIX) === 0) {\n        var funcName = varName.substring((ANGULAR_FUNCTION_OBJECT_NAME_PREFIX).length);\n        scope[funcName] = undefined;\n      }\n    }\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebook/paragraph/result/result.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('SearchResultCtrl', SearchResultCtrl);\n\nSearchResultCtrl.$inject = ['$scope', '$routeParams', 'searchService'];\n\nfunction SearchResultCtrl($scope, $routeParams, searchService) {\n  $scope.isResult = true ;\n  $scope.searchTerm = $routeParams.searchTerm;\n  var results = searchService.search({'q': $routeParams.searchTerm}).query();\n\n  results.$promise.then(function(result) {\n    $scope.notes = result.body.map(function(note) {\n      // redirect to notebook when search result is a notebook itself,\n      // not a paragraph\n      if (!/\\/paragraph\\//.test(note.id)) {\n        return note;\n      }\n\n      note.id = note.id.replace('paragraph/', '?paragraph=') +\n        '&term=' + $routeParams.searchTerm;\n\n      return note;\n    });\n    if ($scope.notes.length === 0) {\n      $scope.isResult = false;\n    } else {\n      $scope.isResult = true;\n    }\n\n    $scope.$on('$routeChangeStart', function(event, next, current) {\n      if (next.originalPath !== '/search/:searchTerm') {\n        searchService.searchTerm = '';\n      }\n    });\n  });\n\n  $scope.page = 0;\n  $scope.allResults = false;\n\n  $scope.highlightSearchResults = function(note) {\n    return function(_editor) {\n      function getEditorMode(text) {\n        var editorModes = {\n          'ace/mode/scala': /^%(\\w*\\.)?spark/,\n          'ace/mode/python': /^%(\\w*\\.)?(pyspark|python)/,\n          'ace/mode/r': /^%(\\w*\\.)?(r|sparkr|knitr)/,\n          'ace/mode/sql': /^%(\\w*\\.)?\\wql/,\n          'ace/mode/markdown': /^%md/,\n          'ace/mode/sh': /^%sh/\n        };\n\n        return Object.keys(editorModes).reduce(function(res, mode) {\n          return editorModes[mode].test(text) ? mode : res;\n        }, 'ace/mode/scala');\n      }\n\n      var Range = ace.require('ace/range').Range;\n\n      _editor.setOption('highlightActiveLine', false);\n      _editor.$blockScrolling = Infinity;\n      _editor.setReadOnly(true);\n      _editor.renderer.setShowGutter(false);\n      _editor.setTheme('ace/theme/chrome');\n      _editor.getSession().setMode(getEditorMode(note.text));\n\n      function getIndeces(term) {\n        return function(str) {\n          var indeces = [];\n          var i = -1;\n          while ((i = str.indexOf(term, i + 1)) >= 0) {\n            indeces.push(i);\n          }\n          return indeces;\n        };\n      }\n\n      var result = '';\n      if (note.header !== '') {\n        result = note.header + '\\n\\n' + note.snippet;\n      } else {\n        result = note.snippet;\n      }\n\n      var lines = result\n        .split('\\n')\n        .map(function(line, row) {\n\n          var match = line.match(/<B>(.+?)<\\/B>/);\n\n          // return early if nothing to highlight\n          if (!match) {\n            return line;\n          }\n\n          var term = match[1];\n          var __line = line\n            .replace(/<B>/g, '')\n            .replace(/<\\/B>/g, '');\n\n          var indeces = getIndeces(term)(__line);\n\n          indeces.forEach(function(start) {\n            var end = start + term.length;\n            if (note.header !== '' && row === 0) {\n              _editor\n                .getSession()\n                .addMarker(\n                  new Range(row, 0, row, line.length),\n                  'search-results-highlight-header',\n                  'background'\n                );\n              _editor\n                .getSession()\n                .addMarker(\n                  new Range(row, start, row, end),\n                  'search-results-highlight',\n                  'line'\n                );\n            } else {\n              _editor\n                .getSession()\n                .addMarker(\n                  new Range(row, start, row, end),\n                  'search-results-highlight',\n                  'line'\n                );\n            }\n          });\n          return __line;\n        });\n\n      // resize editor based on content length\n      _editor.setOption(\n        'maxLines',\n        lines.reduce(function(len, line) {return len + line.length;}, 0)\n      );\n\n      _editor.getSession().setValue(lines.join('\\n'));\n\n    };\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/search/result-list.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NotebookReposCtrl', NotebookReposCtrl);\n\nNotebookReposCtrl.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\nfunction NotebookReposCtrl($http, baseUrlSrv, ngToast) {\n  var vm = this;\n  vm.notebookRepos = [];\n  vm.showDropdownSelected = showDropdownSelected;\n  vm.saveNotebookRepo = saveNotebookRepo;\n\n  _init();\n\n  // Public functions\n\n  function saveNotebookRepo(valueform, repo, data) {\n    console.log('data %o', data);\n    $http.put(baseUrlSrv.getRestApiBase() + '/notebook-repositories', {\n      'name': repo.className,\n      'settings': data\n    }).success(function(data) {\n      var index = _.findIndex(vm.notebookRepos, {'className': repo.className});\n      if (index >= 0) {\n        vm.notebookRepos[index] = data.body;\n        console.log('repos %o, data %o', vm.notebookRepos, data.body);\n      }\n      valueform.$show();\n    }).error(function() {\n      ngToast.danger({\n        content: 'We couldn\\'t save that NotebookRepo\\'s settings',\n        verticalPosition: 'bottom',\n        timeout: '3000'\n      });\n      valueform.$show();\n    });\n\n    return 'manual';\n  }\n\n  function showDropdownSelected(setting) {\n    var index = _.findIndex(setting.value, {'value': setting.selected});\n    if (index < 0) {\n      return 'No value';\n    } else {\n      return setting.value[index].name;\n    }\n  }\n\n  // Private functions\n\n  function _getInterpreterSettings() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/notebook-repositories')\n      .success(function(data, status, headers, config) {\n        vm.notebookRepos = data.body;\n        console.log('ya notebookRepos %o', vm.notebookRepos);\n      }).error(function(data, status, headers, config) {\n      if (status === 401) {\n        ngToast.danger({\n          content: 'You don\\'t have permission on this page',\n          verticalPosition: 'bottom',\n          timeout: '3000'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 3000);\n      }\n      console.log('Error %o %o', status, data.message);\n    });\n  }\n\n  function _init() {\n    _getInterpreterSettings();\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/notebookRepos/notebookRepos.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\n  angular.module('zeppelinWebApp').controller('HeliumCtrl', HeliumCtrl);\n\n  HeliumCtrl.$inject = ['$scope', '$rootScope', '$sce', 'baseUrlSrv', 'ngToast', 'heliumService'];\n\n  function HeliumCtrl($scope, $rootScope, $sce, baseUrlSrv, ngToast, heliumService) {\n    $scope.packageInfos = {};\n    $scope.defaultVersions = {};\n    $scope.showVersions = {};\n    $scope.visualizationOrder = [];\n    $scope.visualizationOrderChanged = false;\n\n    var buildDefaultVersionListToDisplay = function(packageInfos) {\n      var defaultVersions = {};\n      // show enabled version if any version of package is enabled\n      for (var name in packageInfos) {\n        var pkgs = packageInfos[name];\n        for (var pkgIdx in pkgs) {\n          var pkg = pkgs[pkgIdx];\n          pkg.pkg.icon = $sce.trustAsHtml(pkg.pkg.icon);\n          if (pkg.enabled) {\n            defaultVersions[name] = pkg;\n            pkgs.splice(pkgIdx, 1);\n            break;\n          }\n        }\n\n        // show first available version if package is not enabled\n        if (!defaultVersions[name]) {\n          defaultVersions[name] = pkgs[0];\n          pkgs.splice(0, 1);\n        }\n      }\n      $scope.defaultVersions = defaultVersions;\n    };\n\n    var getAllPackageInfo = function() {\n      heliumService.getAllPackageInfo().\n        success(function(data, status) {\n          $scope.packageInfos = data.body;\n          buildDefaultVersionListToDisplay($scope.packageInfos);\n        }).\n        error(function(data, status) {\n          console.log('Can not load package info %o %o', status, data);\n        });\n    };\n\n    var getVisualizationOrder = function() {\n      heliumService.getVisualizationOrder().\n        success(function(data, status) {\n          $scope.visualizationOrder = data.body;\n        }).\n        error(function(data, status) {\n          console.log('Can not get visualization order %o %o', status, data);\n        });\n    };\n\n    $scope.visualizationOrderListeners = {\n      accept: function(sourceItemHandleScope, destSortableScope) {return true;},\n      itemMoved: function(event) {},\n      orderChanged: function(event) {\n        $scope.visualizationOrderChanged = true;\n      }\n    };\n\n    var init = function() {\n      getAllPackageInfo();\n      getVisualizationOrder();\n      $scope.visualizationOrderChanged = false;\n    };\n\n    init();\n\n    $scope.saveVisualizationOrder = function() {\n      var confirm = BootstrapDialog.confirm({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: '',\n        message: 'Save changes?',\n        callback: function(result) {\n          if (result) {\n            confirm.$modalFooter.find('button').addClass('disabled');\n            confirm.$modalFooter.find('button:contains(\"OK\")')\n              .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n            heliumService.setVisualizationOrder($scope.visualizationOrder).\n              success(function(data, status) {\n                init();\n                confirm.close();\n              }).\n              error(function(data, status) {\n                confirm.close();\n                console.log('Failed to save order');\n                BootstrapDialog.show({\n                  title: 'Error on saving order ',\n                  message: data.message\n                });\n              });\n            return false;\n          }\n        }\n      });\n    }\n\n    var getLicense = function(name, artifact) {\n      var pkg = _.filter($scope.defaultVersions[name], function(p) {\n        return p.artifact === artifact;\n      });\n\n      var license;\n      if (pkg.length === 0) {\n        pkg = _.filter($scope.packageInfos[name], function(p) {\n          return p.pkg.artifact === artifact;\n        });\n\n        if (pkg.length > 0) {\n          license  = pkg[0].pkg.license;\n        }\n      } else {\n        license = pkg[0].license;\n      }\n\n      if (!license) {\n        license = 'Unknown';\n      }\n      return license;\n    }\n\n    $scope.enable = function(name, artifact) {\n      var license = getLicense(name, artifact);\n\n      var confirm = BootstrapDialog.confirm({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: '',\n        message: 'Do you want to enable ' + name + '?' +\n          '<div style=\"color:gray\">' + artifact + '</div>' +\n          '<div style=\"border-top: 1px solid #efefef; margin-top: 10px; padding-top: 5px;\">License</div>' +\n          '<div style=\"color:gray\">' + license + '</div>',\n        callback: function(result) {\n          if (result) {\n            confirm.$modalFooter.find('button').addClass('disabled');\n            confirm.$modalFooter.find('button:contains(\"OK\")')\n              .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Enabling');\n            heliumService.enable(name, artifact).\n              success(function(data, status) {\n                init();\n                confirm.close();\n              }).\n              error(function(data, status) {\n                confirm.close();\n                console.log('Failed to enable package %o %o. %o', name, artifact, data);\n                BootstrapDialog.show({\n                  title: 'Error on enabling ' + name,\n                  message: data.message\n                });\n              });\n            return false;\n          }\n        }\n      });\n    };\n\n    $scope.disable = function(name) {\n      var confirm = BootstrapDialog.confirm({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: '',\n        message: 'Do you want to disable ' + name + '?',\n        callback: function(result) {\n          if (result) {\n            confirm.$modalFooter.find('button').addClass('disabled');\n            confirm.$modalFooter.find('button:contains(\"OK\")')\n              .html('<i class=\"fa fa-circle-o-notch fa-spin\"></i> Disabling');\n            heliumService.disable(name).\n              success(function(data, status) {\n                init();\n                confirm.close();\n              }).\n              error(function(data, status) {\n                confirm.close();\n                console.log('Failed to disable package %o. %o', name, data);\n                BootstrapDialog.show({\n                  title: 'Error on disabling ' + name,\n                  message: data.message\n                });\n              });\n            return false;\n          }\n        }\n      });\n    };\n\n    $scope.toggleVersions = function(pkgName) {\n      if ($scope.showVersions[pkgName]) {\n        $scope.showVersions[pkgName] = false;\n      } else {\n        $scope.showVersions[pkgName] = true;\n      }\n    };\n  \n    $scope.getPackageSize = function(pkgSearchResult) {\n      return _.size(pkgSearchResult)\n    };\n  }\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/helium/helium.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('arrayOrderingSrv', arrayOrderingSrv);\n\narrayOrderingSrv.$inject = ['TRASH_FOLDER_ID'];\n\nfunction arrayOrderingSrv(TRASH_FOLDER_ID) {\n  var arrayOrderingSrv = this;\n\n  this.noteListOrdering = function(note) {\n    if (note.id === TRASH_FOLDER_ID) {\n      return '\\uFFFF';\n    }\n    return arrayOrderingSrv.getNoteName(note);\n  };\n\n  this.getNoteName = function(note) {\n    if (note.name === undefined || note.name.trim() === '') {\n      return 'Note ' + note.id;\n    } else {\n      return note.name;\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/arrayOrderingSrv/arrayOrdering.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nangular.module('zeppelinWebApp').controller('clipboardCtrl', clipboardCtrl);\nclipboardCtrl.$inject = ['$scope'];\n\nfunction clipboardCtrl($scope) {\n  $scope.complete = function(e) {\n    $scope.copied = true;\n    $scope.tooltip = 'Copied!';\n    setTimeout(function() {\n      $scope.tooltip = 'Copy to clipboard';\n    }, 400);\n  };\n  $scope.$watch('input', function() {\n    $scope.copied = false;\n    $scope.tooltip = 'Copy to clipboard';\n  });\n  $scope.clipError = function(e) {\n    console.log('Error: ' + e.name + ' - ' + e.message);\n    $scope.tooltip = 'Not supported browser';\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/clipboard/clipboard.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NavCtrl', NavCtrl);\n\nNavCtrl.$inject = [\n  '$scope',\n  '$rootScope',\n  '$http',\n  '$routeParams',\n  '$location',\n  'noteListDataFactory',\n  'baseUrlSrv',\n  'websocketMsgSrv',\n  'arrayOrderingSrv',\n  'searchService',\n  'TRASH_FOLDER_ID'\n];\n\nfunction NavCtrl($scope, $rootScope, $http, $routeParams, $location,\n                 noteListDataFactory, baseUrlSrv, websocketMsgSrv,\n                 arrayOrderingSrv, searchService, TRASH_FOLDER_ID) {\n  var vm = this;\n  vm.arrayOrderingSrv = arrayOrderingSrv;\n  vm.connected = websocketMsgSrv.isConnected();\n  vm.isActive = isActive;\n  vm.logout = logout;\n  vm.notes = noteListDataFactory;\n  vm.search = search;\n  vm.searchForm = searchService;\n  vm.showLoginWindow = showLoginWindow;\n  vm.TRASH_FOLDER_ID = TRASH_FOLDER_ID;\n  vm.isFilterNote = isFilterNote;\n\n  $scope.query = {q: ''};\n\n  initController();\n\n  function getZeppelinVersion() {\n    $http.get(baseUrlSrv.getRestApiBase() + '/version').success(\n      function(data, status, headers, config) {\n        $rootScope.zeppelinVersion = data.body;\n      }).error(\n      function(data, status, headers, config) {\n        console.log('Error %o %o', status, data.message);\n      });\n  }\n\n  function initController() {\n    $scope.isDrawNavbarNoteList = false;\n    angular.element('#notebook-list').perfectScrollbar({suppressScrollX: true});\n\n    angular.element(document).click(function() {\n      $scope.query.q = '';\n    });\n\n    getZeppelinVersion();\n    loadNotes();\n  }\n\n  function isFilterNote(note) {\n    if (!$scope.query.q) {\n      return true;\n    }\n\n    var noteName = note.name;\n    if (noteName.toLowerCase().indexOf($scope.query.q.toLowerCase()) > -1) {\n      return true;\n    }\n    return false;\n  }\n\n  function isActive(noteId) {\n    return ($routeParams.noteId === noteId);\n  }\n\n  function listConfigurations() {\n    websocketMsgSrv.listConfigurations();\n  }\n\n  function loadNotes() {\n    websocketMsgSrv.getNoteList();\n  }\n\n  function getHomeNote(){\n    websocketMsgSrv.getHomeNote();\n  }\n\n  function logout() {\n    var logoutURL = baseUrlSrv.getRestApiBase() + '/login/logout';\n\n    //for firefox and safari\n    logoutURL = logoutURL.replace('//', '//false:false@');\n    $http.post(logoutURL).error(function() {\n      //force authcBasic (if configured) to logout\n      $http.post(logoutURL).error(function() {\n        $rootScope.userName = '';\n        $rootScope.ticket.principal = '';\n        $rootScope.ticket.ticket = '';\n        $rootScope.ticket.roles = '';\n        BootstrapDialog.show({\n          message: 'Logout Success'\n        });\n        setTimeout(function() {\n          window.location.replace('/');\n        }, 1000);\n      });\n    });\n  }\n\n  function search(searchTerm) {\n    $location.path('/search/' + searchTerm);\n  }\n\n  function showLoginWindow() {\n    setTimeout(function() {\n      angular.element('#userName').focus();\n    }, 500);\n  }\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteMenu', function(event, notes) {\n    noteListDataFactory.setNotes(notes);\n    initNotebookListEventListener();\n  });\n\n  $scope.$on('setConnectedStatus', function(event, param) {\n    vm.connected = param;\n  });\n\n  $scope.$on('loginSuccess', function(event, param) {\n    listConfigurations();\n    loadNotes();\n    getHomeNote();\n  });\n\n  /*\n   ** Performance optimization for Browser Render.\n   */\n  function initNotebookListEventListener() {\n    angular.element(document).ready(function() {\n      angular.element('.notebook-list-dropdown').on('show.bs.dropdown', function() {\n        $scope.isDrawNavbarNoteList = true;\n      });\n\n      angular.element('.notebook-list-dropdown').on('hide.bs.dropdown', function() {\n        $scope.isDrawNavbarNoteList = false;\n      });\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/navbar/navbar.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('ngEscape', ngEscape);\n\nfunction ngEscape() {\n  return function(scope, element, attrs) {\n    element.bind('keydown keyup', function(event) {\n      if (event.which === 27) {\n        scope.$apply(function() {\n          scope.$eval(attrs.ngEscape);\n        });\n        event.preventDefault();\n      }\n    });\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/ngescape/ngescape.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('interpreterDirective', interpreterDirective);\n\ninterpreterDirective.$inject = ['$timeout'];\n\nfunction interpreterDirective($timeout) {\n  return {\n    restrict: 'A',\n    link: function(scope, element, attr) {\n      if (scope.$last === true) {\n        $timeout(function() {\n          var id = 'ngRenderFinished';\n          scope.$emit(id);\n        });\n      }\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/interpreter/interpreter.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('expandCollapse', expandCollapse);\n\nfunction expandCollapse() {\n  return {\n    restrict: 'EA',\n    link: function(scope, element, attrs) {\n      angular.element(element).click(function(event) {\n        if (angular.element(element).find('.expandable:visible').length > 1) {\n          angular.element(element).find('.expandable:visible').slideUp('slow');\n          angular.element(element).find('i.icon-folder-alt').toggleClass('icon-folder icon-folder-alt');\n        } else {\n          angular.element(element).find('.expandable').first().slideToggle('200',function() {\n            // do not toggle trash folder\n            if (angular.element(element).find('.fa-trash-o').length === 0) {\n              angular.element(element).find('i').first().toggleClass('icon-folder icon-folder-alt');\n            }\n          });\n        }\n        event.stopPropagation();\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/expandCollapse/expandCollapse.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NotenameCtrl', NotenameCtrl);\n\nNotenameCtrl.$inject = [\n  '$scope',\n  'noteListDataFactory',\n  '$routeParams',\n  'websocketMsgSrv'\n];\n\nfunction NotenameCtrl($scope, noteListDataFactory, $routeParams, websocketMsgSrv) {\n  var vm = this;\n  vm.clone = false;\n  vm.notes = noteListDataFactory;\n  vm.websocketMsgSrv = websocketMsgSrv;\n  $scope.note = {};\n  $scope.interpreterSettings = {};\n  $scope.note.defaultInterpreter = null;\n\n  vm.createNote = function() {\n    if (!vm.clone) {\n      var defaultInterpreterId = '';\n      if ($scope.note.defaultInterpreter !== null) {\n        defaultInterpreterId = $scope.note.defaultInterpreter.id;\n      }\n      vm.websocketMsgSrv.createNotebook($scope.note.notename, defaultInterpreterId);\n      $scope.note.defaultInterpreter = $scope.interpreterSettings[0];\n    } else {\n      var noteId = $routeParams.noteId;\n      vm.websocketMsgSrv.cloneNote(noteId, $scope.note.notename);\n    }\n  };\n\n  vm.handleNameEnter = function() {\n    angular.element('#noteNameModal').modal('toggle');\n    vm.createNote();\n  };\n\n  vm.preVisible = function(clone, sourceNoteName) {\n    vm.clone = clone;\n    vm.sourceNoteName = sourceNoteName;\n    $scope.note.notename = vm.clone ? vm.cloneNoteName() : vm.newNoteName();\n    $scope.$apply();\n  };\n\n  vm.newNoteName = function() {\n    var newCount = 1;\n    angular.forEach(vm.notes.flatList, function(noteName) {\n      noteName = noteName.name;\n      if (noteName.match(/^Untitled Note [0-9]*$/)) {\n        var lastCount = noteName.substr(14) * 1;\n        if (newCount <= lastCount) {\n          newCount = lastCount + 1;\n        }\n      }\n    });\n    return 'Untitled Note ' + newCount;\n  };\n\n  vm.cloneNoteName = function() {\n    var copyCount = 1;\n    var newCloneName = '';\n    var lastIndex = vm.sourceNoteName.lastIndexOf(' ');\n    var endsWithNumber = !!vm.sourceNoteName.match('^.+?\\\\s\\\\d$');\n    var noteNamePrefix = endsWithNumber ? vm.sourceNoteName.substr(0, lastIndex) : vm.sourceNoteName;\n    var regexp = new RegExp('^' + noteNamePrefix + ' .+');\n\n    angular.forEach(vm.notes.flatList, function(noteName) {\n      noteName = noteName.name;\n      if (noteName.match(regexp)) {\n        var lastCopyCount = noteName.substr(lastIndex).trim();\n        newCloneName = noteNamePrefix;\n        lastCopyCount = parseInt(lastCopyCount);\n        if (copyCount <= lastCopyCount) {\n          copyCount = lastCopyCount + 1;\n        }\n      }\n    });\n\n    if (!newCloneName) {\n      newCloneName = vm.sourceNoteName;\n    }\n    return newCloneName + ' ' + copyCount;\n  };\n\n  vm.getInterpreterSettings = function() {\n    vm.websocketMsgSrv.getInterpreterSettings();\n  };\n\n\n  $scope.$on('interpreterSettings', function(event, data) {\n    $scope.interpreterSettings = data.interpreterSettings;\n\n    //initialize default interpreter with Spark interpreter\n    $scope.note.defaultInterpreter = data.interpreterSettings[0];\n  });\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteName-create/notename.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('NoteImportCtrl', NoteImportCtrl);\n\nNoteImportCtrl.$inject = ['$scope', '$timeout', 'websocketMsgSrv'];\n\nfunction NoteImportCtrl($scope, $timeout, websocketMsgSrv) {\n  var vm = this;\n  $scope.note = {};\n  $scope.note.step1 = true;\n  $scope.note.step2 = false;\n  $scope.maxLimit = '';\n  var limit = 0;\n\n  websocketMsgSrv.listConfigurations();\n  $scope.$on('configurationsInfo', function(scope, event) {\n    limit = event.configurations['zeppelin.websocket.max.text.message.size'];\n    $scope.maxLimit = Math.round(limit / 1048576);\n  });\n\n  vm.resetFlags = function() {\n    $scope.note = {};\n    $scope.note.step1 = true;\n    $scope.note.step2 = false;\n    angular.element('#noteImportFile').val('');\n  };\n\n  $scope.uploadFile = function() {\n    angular.element('#noteImportFile').click();\n  };\n\n  $scope.importFile = function(element) {\n    $scope.note.errorText = '';\n    $scope.note.importFile = element.files[0];\n    var file = $scope.note.importFile;\n    var reader = new FileReader();\n\n    if (file.size > limit) {\n      $scope.note.errorText = 'File size limit Exceeded!';\n      $scope.$apply();\n      return;\n    }\n\n    reader.onloadend = function() {\n      vm.processImportJson(reader.result);\n    };\n\n    if (file) {\n      reader.readAsText(file);\n    }\n  };\n\n  $scope.uploadURL = function() {\n    $scope.note.errorText = '';\n    $scope.note.step1 = false;\n    $timeout(function() {\n      $scope.note.step2 = true;\n    }, 400);\n  };\n\n  vm.importBack = function() {\n    $scope.note.errorText = '';\n    $timeout(function() {\n      $scope.note.step1 = true;\n    }, 400);\n    $scope.note.step2 = false;\n  };\n\n  vm.importNote = function() {\n    $scope.note.errorText = '';\n    if ($scope.note.importUrl) {\n      jQuery.ajax({\n        url: $scope.note.importUrl,\n        type: 'GET',\n        dataType: 'json',\n        jsonp: false,\n        xhrFields: {\n          withCredentials: false\n        },\n        error: function(xhr, ajaxOptions, thrownError) {\n          $scope.note.errorText = 'Unable to Fetch URL';\n          $scope.$apply();\n        }}).done(function(data) {\n        vm.processImportJson(data);\n      });\n    } else {\n      $scope.note.errorText = 'Enter URL';\n      $scope.$apply();\n    }\n  };\n\n  vm.processImportJson = function(result) {\n    if (typeof result !== 'object') {\n      try {\n        result = JSON.parse(result);\n      } catch (e) {\n        $scope.note.errorText = 'JSON parse exception';\n        $scope.$apply();\n        return;\n      }\n\n    }\n    if (result.paragraphs && result.paragraphs.length > 0) {\n      if (!$scope.note.noteImportName) {\n        $scope.note.noteImportName = result.name;\n      } else {\n        result.name = $scope.note.noteImportName;\n      }\n      websocketMsgSrv.importNote(result);\n      //angular.element('#noteImportModal').modal('hide');\n    } else {\n      $scope.note.errorText = 'Invalid JSON';\n    }\n    $scope.$apply();\n  };\n\n  /*\n   ** $scope.$on functions below\n   */\n\n  $scope.$on('setNoteMenu', function(event, notes) {\n    vm.resetFlags();\n    angular.element('#noteImportModal').modal('hide');\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteName-import/notenameImport.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('popoverHtmlUnsafe', popoverHtmlUnsafe);\n\npopoverHtmlUnsafe.$inject = ['$uibTooltip'];\n\nfunction popoverHtmlUnsafe ($uibTooltip) {\n  return $uibTooltip('popoverHtmlUnsafe', 'popover', 'click')\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/popover-html-unsafe/popover-html-unsafe.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('popoverHtmlUnsafePopup', popoverHtmlUnsafePopup);\n\nfunction popoverHtmlUnsafePopup() {\n  return {\n    restrict: 'EA',\n    replace: true,\n    scope: {title: '@', content: '@', placement: '@', animation: '&', isOpen: '&'},\n    templateUrl: 'components/popover-html-unsafe/popover-html-unsafe-popup.html'\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/popover-html-unsafe/popover-html-unsafe-popup.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('codeEditor', codeEditor);\n\nfunction codeEditor($templateRequest, $compile) {\n  return {\n    restrict: 'AE',\n    scope: {\n      paragraphId: '=paragraphId',\n      paragraph: '=paragraphContext',\n      dirtyText: '=dirtyText',\n      originalText: '=originalText',\n      onLoad: '=onLoad',\n      revisionView: '=revisionView'\n    },\n    link: function(scope, element, attrs, controller) {\n      $templateRequest('components/editor/ace.editor.directive.html').then(function(editorHtml) {\n        var editor = angular.element(editorHtml);\n        editor.attr('id', scope.paragraphId + '_editor');\n        element.append(editor);\n        $compile(editor)(scope);\n        console.log('codeEditor directive revision view is ' + scope.revisionView);\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/editor/codeEditor.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('ngEnter', ngEnter);\n\nfunction ngEnter() {\n  return function(scope, element, attrs) {\n    element.bind('keydown keypress', function(event) {\n      if (event.which === 13) {\n        if (!event.shiftKey) {\n          scope.$apply(function() {\n            scope.$eval(attrs.ngEnter);\n          });\n        }\n        event.preventDefault();\n      }\n    });\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/ngenter/ngenter.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('dropdownInput', dropdownInput);\n\nfunction dropdownInput() {\n  return {\n    restrict: 'A',\n    link: function(scope, element) {\n      element.bind('click', function(event) {\n        event.stopPropagation();\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/dropdowninput/dropdowninput.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('resizable', resizable);\n\nfunction resizable() {\n  var resizableConfig = {\n    autoHide: true,\n    handles: 'se',\n    helper: 'resizable-helper',\n    stop: function() {\n      angular.element(this).css({'width': '100%', 'height': '100%'});\n    }\n  };\n\n  return {\n    restrict: 'A',\n    scope: {\n      callback: '&onResize'\n    },\n    link: function postLink(scope, elem, attrs) {\n      attrs.$observe('resize', function(resize) {\n        var resetResize = function(elem, resize) {\n          var colStep = window.innerWidth / 12;\n          elem.off('resizestop');\n          var conf = angular.copy(resizableConfig);\n          if (resize.graphType === 'TABLE' || resize.graphType === 'TEXT') {\n            conf.grid = [colStep, 10];\n            conf.minHeight = 100;\n          } else {\n            conf.grid = [colStep, 10000];\n            conf.minHeight = 0;\n          }\n          conf.maxWidth = window.innerWidth;\n\n          elem.resizable(conf);\n          elem.on('resizestop', function() {\n            if (scope.callback) {\n              var height = elem.height();\n              if (height < 50) {\n                height = 300;\n              }\n              scope.callback({width: Math.ceil(elem.width() / colStep), height: height});\n            }\n          });\n        };\n\n        resize = JSON.parse(resize);\n        if (resize.allowresize === 'true') {\n          resetResize(elem, resize);\n          angular.element(window).resize(function() {\n            resetResize(elem, resize);\n          });\n        }\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/resizable/resizable.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').directive('modalvisible', modalvisible);\n\nfunction modalvisible() {\n  return {\n    restrict: 'A',\n    scope: {\n      preVisibleCallback: '&previsiblecallback',\n      postVisibleCallback: '&postvisiblecallback',\n      targetinput: '@targetinput'\n    },\n    link: function(scope, element, attrs) {\n      // Add some listeners\n      var previsibleMethod = scope.preVisibleCallback;\n      var postVisibleMethod = scope.postVisibleCallback;\n      element.on('show.bs.modal',function(e) {\n        var relatedTarget = angular.element(e.relatedTarget);\n        var clone = relatedTarget.data('clone');\n        var sourceNoteName = relatedTarget.data('source-note-name');\n        var cloneNote = clone ? true : false;\n        previsibleMethod()(cloneNote, sourceNoteName);\n      });\n      element.on('shown.bs.modal', function(e) {\n        if (scope.targetinput) {\n          angular.element(e.target).find('input#' + scope.targetinput).select();\n        }\n        postVisibleMethod();\n      });\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteName-create/visible.directive.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('websocketMsgSrv', websocketMsgSrv);\n\nwebsocketMsgSrv.$inject = ['$rootScope', 'websocketEvents'];\n\nfunction websocketMsgSrv($rootScope, websocketEvents) {\n  return {\n\n    getHomeNote: function() {\n      websocketEvents.sendNewEvent({op: 'GET_HOME_NOTE'});\n    },\n\n    createNotebook: function(noteName, defaultInterpreterId) {\n      websocketEvents.sendNewEvent({\n        op: 'NEW_NOTE',\n        data: {\n          name: noteName,\n          defaultInterpreterId: defaultInterpreterId\n        }\n      });\n    },\n\n    moveNoteToTrash: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'MOVE_NOTE_TO_TRASH', data: {id: noteId}});\n    },\n\n    moveFolderToTrash: function(folderId) {\n      websocketEvents.sendNewEvent({op: 'MOVE_FOLDER_TO_TRASH', data: {id: folderId}});\n    },\n\n    restoreNote: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'RESTORE_NOTE', data: {id: noteId}});\n    },\n\n    restoreFolder: function(folderId) {\n      websocketEvents.sendNewEvent({op: 'RESTORE_FOLDER', data: {id: folderId}});\n    },\n\n    restoreAll: function() {\n      websocketEvents.sendNewEvent({op: 'RESTORE_ALL'});\n    },\n\n    deleteNote: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'DEL_NOTE', data: {id: noteId}});\n    },\n\n    removeFolder: function(folderId) {\n      websocketEvents.sendNewEvent({op: 'REMOVE_FOLDER', data: {id: folderId}});\n    },\n\n    emptyTrash: function() {\n      websocketEvents.sendNewEvent({op: 'EMPTY_TRASH'});\n    },\n\n    cloneNote: function(noteIdToClone, newNoteName) {\n      websocketEvents.sendNewEvent({op: 'CLONE_NOTE', data: {id: noteIdToClone, name: newNoteName}});\n    },\n\n    getNoteList: function() {\n      websocketEvents.sendNewEvent({op: 'LIST_NOTES'});\n    },\n\n    reloadAllNotesFromRepo: function() {\n      websocketEvents.sendNewEvent({op: 'RELOAD_NOTES_FROM_REPO'});\n    },\n\n    getNote: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'GET_NOTE', data: {id: noteId}});\n    },\n\n    updateNote: function(noteId, noteName, noteConfig) {\n      websocketEvents.sendNewEvent({op: 'NOTE_UPDATE', data: {id: noteId, name: noteName, config: noteConfig}});\n    },\n\n    updatePersonalizedMode: function(noteId, modeValue) {\n      websocketEvents.sendNewEvent({op: 'UPDATE_PERSONALIZED_MODE', data: {id: noteId, personalized: modeValue}});\n    },\n\n    renameNote: function(noteId, noteName) {\n      websocketEvents.sendNewEvent({op: 'NOTE_RENAME', data: {id: noteId, name: noteName}});\n    },\n\n    renameFolder: function(folderId, folderName) {\n      websocketEvents.sendNewEvent({op: 'FOLDER_RENAME', data: {id: folderId, name: folderName}});\n    },\n\n    moveParagraph: function(paragraphId, newIndex) {\n      websocketEvents.sendNewEvent({op: 'MOVE_PARAGRAPH', data: {id: paragraphId, index: newIndex}});\n    },\n\n    insertParagraph: function(newIndex) {\n      websocketEvents.sendNewEvent({op: 'INSERT_PARAGRAPH', data: {index: newIndex}});\n    },\n\n    copyParagraph: function(newIndex, paragraphTitle, paragraphData,\n                            paragraphConfig, paragraphParams) {\n      websocketEvents.sendNewEvent({\n        op: 'COPY_PARAGRAPH',\n        data: {\n          index: newIndex,\n          title: paragraphTitle,\n          paragraph: paragraphData,\n          config: paragraphConfig,\n          params: paragraphParams\n        }\n      });\n    },\n\n    updateAngularObject: function(noteId, paragraphId, name, value, interpreterGroupId) {\n      websocketEvents.sendNewEvent({\n        op: 'ANGULAR_OBJECT_UPDATED',\n        data: {\n          noteId: noteId,\n          paragraphId: paragraphId,\n          name: name,\n          value: value,\n          interpreterGroupId: interpreterGroupId\n        }\n      });\n    },\n\n    clientBindAngularObject: function(noteId, name, value, paragraphId) {\n      websocketEvents.sendNewEvent({\n        op: 'ANGULAR_OBJECT_CLIENT_BIND',\n        data: {\n          noteId: noteId,\n          name: name,\n          value: value,\n          paragraphId: paragraphId\n        }\n      });\n    },\n\n    clientUnbindAngularObject: function(noteId, name, paragraphId) {\n      websocketEvents.sendNewEvent({\n        op: 'ANGULAR_OBJECT_CLIENT_UNBIND',\n        data: {\n          noteId: noteId,\n          name: name,\n          paragraphId: paragraphId\n        }\n      });\n    },\n\n    cancelParagraphRun: function(paragraphId) {\n      websocketEvents.sendNewEvent({op: 'CANCEL_PARAGRAPH', data: {id: paragraphId}});\n    },\n\n    runParagraph: function(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n      websocketEvents.sendNewEvent({\n        op: 'RUN_PARAGRAPH',\n        data: {\n          id: paragraphId,\n          title: paragraphTitle,\n          paragraph: paragraphData,\n          config: paragraphConfig,\n          params: paragraphParams\n        }\n      });\n    },\n\n    runAllParagraphs: function(noteId, paragraphs) {\n      websocketEvents.sendNewEvent({\n        op: 'RUN_ALL_PARAGRAPHS',\n        data: {\n          noteId: noteId,\n          paragraphs: JSON.stringify(paragraphs)\n        }\n      });\n    },\n\n    removeParagraph: function(paragraphId) {\n      websocketEvents.sendNewEvent({op: 'PARAGRAPH_REMOVE', data: {id: paragraphId}});\n    },\n\n    clearParagraphOutput: function(paragraphId) {\n      websocketEvents.sendNewEvent({op: 'PARAGRAPH_CLEAR_OUTPUT', data: {id: paragraphId}});\n    },\n\n    clearAllParagraphOutput: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'PARAGRAPH_CLEAR_ALL_OUTPUT', data: {id: noteId}});\n    },\n\n    completion: function(paragraphId, buf, cursor) {\n      websocketEvents.sendNewEvent({\n        op: 'COMPLETION',\n        data: {\n          id: paragraphId,\n          buf: buf,\n          cursor: cursor\n        }\n      });\n    },\n\n    commitParagraph: function(paragraphId, paragraphTitle, paragraphData, paragraphConfig, paragraphParams) {\n      websocketEvents.sendNewEvent({\n        op: 'COMMIT_PARAGRAPH',\n        data: {\n          id: paragraphId,\n          title: paragraphTitle,\n          paragraph: paragraphData,\n          config: paragraphConfig,\n          params: paragraphParams\n        }\n      });\n    },\n\n    importNote: function(note) {\n      websocketEvents.sendNewEvent({\n        op: 'IMPORT_NOTE',\n        data: {\n          note: note\n        }\n      });\n    },\n\n    checkpointNote: function(noteId, commitMessage) {\n      websocketEvents.sendNewEvent({\n        op: 'CHECKPOINT_NOTE',\n        data: {\n          noteId: noteId,\n          commitMessage: commitMessage\n        }\n      });\n    },\n\n    setNoteRevision: function(noteId, revisionId) {\n      websocketEvents.sendNewEvent({\n        op: 'SET_NOTE_REVISION',\n        data: {\n          noteId: noteId,\n          revisionId: revisionId\n        }\n      });\n    },\n\n    listRevisionHistory: function(noteId) {\n      websocketEvents.sendNewEvent({\n        op: 'LIST_REVISION_HISTORY',\n        data: {\n          noteId: noteId\n        }\n      });\n    },\n\n    getNoteByRevision: function(noteId, revisionId) {\n      websocketEvents.sendNewEvent({\n        op: 'NOTE_REVISION',\n        data: {\n          noteId: noteId,\n          revisionId: revisionId\n        }\n      });\n    },\n\n    getEditorSetting: function(paragraphId, replName) {\n      websocketEvents.sendNewEvent({\n        op: 'EDITOR_SETTING',\n        data: {\n          paragraphId: paragraphId,\n          magic: replName\n        }\n      });\n    },\n\n    isConnected: function() {\n      return websocketEvents.isConnected();\n    },\n\n    getNoteJobsList: function() {\n      websocketEvents.sendNewEvent({op: 'LIST_NOTE_JOBS'});\n    },\n\n    getUpdateNoteJobsList: function(lastUpdateServerUnixTime) {\n      websocketEvents.sendNewEvent(\n        {op: 'LIST_UPDATE_NOTE_JOBS', data: {lastUpdateUnixTime: lastUpdateServerUnixTime * 1}}\n      );\n    },\n\n    unsubscribeJobManager: function() {\n      websocketEvents.sendNewEvent({op: 'UNSUBSCRIBE_UPDATE_NOTE_JOBS'});\n    },\n\n    getInterpreterBindings: function(noteId) {\n      websocketEvents.sendNewEvent({op: 'GET_INTERPRETER_BINDINGS', data: {noteId: noteId}});\n    },\n\n    saveInterpreterBindings: function(noteId, selectedSettingIds) {\n      websocketEvents.sendNewEvent({op: 'SAVE_INTERPRETER_BINDINGS',\n        data: {noteId: noteId, selectedSettingIds: selectedSettingIds}});\n    },\n\n    listConfigurations: function() {\n      websocketEvents.sendNewEvent({op: 'LIST_CONFIGURATIONS'});\n    },\n\n    getInterpreterSettings: function() {\n      websocketEvents.sendNewEvent({op: 'GET_INTERPRETER_SETTINGS'});\n    }\n\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/websocketEvents/websocketMsg.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').factory('websocketEvents', websocketEvents);\n\nwebsocketEvents.$inject = ['$rootScope', '$websocket', '$location', 'baseUrlSrv'];\n\nfunction websocketEvents($rootScope, $websocket, $location, baseUrlSrv) {\n  var websocketCalls = {};\n  var pingIntervalId;\n\n  websocketCalls.ws = $websocket(baseUrlSrv.getWebsocketUrl());\n  websocketCalls.ws.reconnectIfNotNormalClose = true;\n\n  websocketCalls.ws.onOpen(function() {\n    console.log('Websocket created');\n    $rootScope.$broadcast('setConnectedStatus', true);\n    pingIntervalId = setInterval(function() {\n      websocketCalls.sendNewEvent({op: 'PING'});\n    }, 10000);\n  });\n\n  websocketCalls.sendNewEvent = function(data) {\n    if ($rootScope.ticket !== undefined) {\n      data.principal = $rootScope.ticket.principal;\n      data.ticket = $rootScope.ticket.ticket;\n      data.roles = $rootScope.ticket.roles;\n    } else {\n      data.principal = '';\n      data.ticket = '';\n      data.roles = '';\n    }\n    console.log('Send >> %o, %o, %o, %o, %o', data.op, data.principal, data.ticket, data.roles, data);\n    websocketCalls.ws.send(JSON.stringify(data));\n  };\n\n  websocketCalls.isConnected = function() {\n    return (websocketCalls.ws.socket.readyState === 1);\n  };\n\n  websocketCalls.ws.onMessage(function(event) {\n    var payload;\n    if (event.data) {\n      payload = angular.fromJson(event.data);\n    }\n    console.log('Receive << %o, %o', payload.op, payload);\n    var op = payload.op;\n    var data = payload.data;\n    if (op === 'NOTE') {\n      $rootScope.$broadcast('setNoteContent', data.note);\n    } else if (op === 'NEW_NOTE') {\n      $location.path('/notebook/' + data.note.id);\n    } else if (op === 'NOTES_INFO') {\n      $rootScope.$broadcast('setNoteMenu', data.notes);\n    } else if (op === 'LIST_NOTE_JOBS') {\n      $rootScope.$broadcast('setNoteJobs', data.noteJobs);\n    } else if (op === 'LIST_UPDATE_NOTE_JOBS') {\n      $rootScope.$broadcast('setUpdateNoteJobs', data.noteRunningJobs);\n    } else if (op === 'AUTH_INFO') {\n      var btn = [];\n      if ($rootScope.ticket.roles === '[]') {\n        btn = [{\n          label: 'Close',\n          action: function(dialog) {\n            dialog.close();\n          }\n        }];\n      } else {\n        btn = [{\n          label: 'Login',\n          action: function(dialog) {\n            dialog.close();\n            angular.element('#loginModal').modal({\n              show: 'true'\n            });\n          }\n        }, {\n          label: 'Cancel',\n          action: function(dialog) {\n            dialog.close();\n            // using $rootScope.apply to trigger angular digest cycle\n            // changing $location.path inside bootstrap modal wont trigger digest\n            $rootScope.$apply(function() {\n              $location.path('/');\n            });\n          }\n        }];\n      }\n\n      BootstrapDialog.show({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: 'Insufficient privileges',\n        message: data.info.toString(),\n        buttons: btn\n      });\n\n    } else if (op === 'PARAGRAPH') {\n      $rootScope.$broadcast('updateParagraph', data);\n    } else if (op === 'PARAGRAPH_APPEND_OUTPUT') {\n      $rootScope.$broadcast('appendParagraphOutput', data);\n    } else if (op === 'PARAGRAPH_UPDATE_OUTPUT') {\n      $rootScope.$broadcast('updateParagraphOutput', data);\n    } else if (op === 'PROGRESS') {\n      $rootScope.$broadcast('updateProgress', data);\n    } else if (op === 'COMPLETION_LIST') {\n      $rootScope.$broadcast('completionList', data);\n    } else if (op === 'EDITOR_SETTING') {\n      $rootScope.$broadcast('editorSetting', data);\n    } else if (op === 'ANGULAR_OBJECT_UPDATE') {\n      $rootScope.$broadcast('angularObjectUpdate', data);\n    } else if (op === 'ANGULAR_OBJECT_REMOVE') {\n      $rootScope.$broadcast('angularObjectRemove', data);\n    } else if (op === 'APP_APPEND_OUTPUT') {\n      $rootScope.$broadcast('appendAppOutput', data);\n    } else if (op === 'APP_UPDATE_OUTPUT') {\n      $rootScope.$broadcast('updateAppOutput', data);\n    } else if (op === 'APP_LOAD') {\n      $rootScope.$broadcast('appLoad', data);\n    } else if (op === 'APP_STATUS_CHANGE') {\n      $rootScope.$broadcast('appStatusChange', data);\n    } else if (op === 'LIST_REVISION_HISTORY') {\n      $rootScope.$broadcast('listRevisionHistory', data);\n    } else if (op === 'NOTE_REVISION') {\n      $rootScope.$broadcast('noteRevision', data);\n    } else if (op === 'INTERPRETER_BINDINGS') {\n      $rootScope.$broadcast('interpreterBindings', data);\n    } else if (op === 'ERROR_INFO') {\n      BootstrapDialog.show({\n        closable: false,\n        closeByBackdrop: false,\n        closeByKeyboard: false,\n        title: 'Details',\n        message: data.info.toString(),\n        buttons: [{\n          // close all the dialogs when there are error on running all paragraphs\n          label: 'Close',\n          action: function() {\n            BootstrapDialog.closeAll();\n          }\n        }]\n      });\n    } else if (op === 'SESSION_LOGOUT') {\n      $rootScope.$broadcast('session_logout', data);\n    } else if (op === 'CONFIGURATIONS_INFO') {\n      $rootScope.$broadcast('configurationsInfo', data);\n    } else if (op === 'INTERPRETER_SETTINGS') {\n      $rootScope.$broadcast('interpreterSettings', data);\n    } else if (op === 'PARAGRAPH_ADDED') {\n      $rootScope.$broadcast('addParagraph', data.paragraph, data.index);\n    } else if (op === 'PARAGRAPH_REMOVED') {\n      $rootScope.$broadcast('removeParagraph', data.id);\n    } else if (op === 'PARAGRAPH_MOVED') {\n      $rootScope.$broadcast('moveParagraph', data.id, data.index);\n    } else if (op === 'NOTE_UPDATED') {\n      $rootScope.$broadcast('updateNote', data.name, data.config, data.info);\n    } else if (op === 'SET_NOTE_REVISION') {\n      $rootScope.$broadcast('setNoteRevisionResult', data);\n    }\n  });\n\n  websocketCalls.ws.onError(function(event) {\n    console.log('error message: ', event);\n    $rootScope.$broadcast('setConnectedStatus', false);\n  });\n\n  websocketCalls.ws.onClose(function(event) {\n    console.log('close message: ', event);\n    if (pingIntervalId !== undefined) {\n      clearInterval(pingIntervalId);\n      pingIntervalId = undefined;\n    }\n    $rootScope.$broadcast('setConnectedStatus', false);\n  });\n\n  return websocketCalls;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/websocketEvents/websocketEvents.factory.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').factory('noteListDataFactory', noteListDataFactory);\n\nnoteListDataFactory.$inject = ['TRASH_FOLDER_ID'];\n\nfunction noteListDataFactory(TRASH_FOLDER_ID) {\n  var notes = {\n    root: {children: []},\n    flatList: [],\n    flatFolderMap: {},\n\n    setNotes: function(notesList) {\n      // a flat list to boost searching\n      notes.flatList = _.map(notesList, (note) => {\n        note.isTrash = note.name ?\n          note.name.split('/')[0] === TRASH_FOLDER_ID : false;\n        return note;\n      });\n\n      // construct the folder-based tree\n      notes.root = {children: []};\n      notes.flatFolderMap = {};\n      _.reduce(notesList, function(root, note) {\n        var noteName = note.name || note.id;\n        var nodes = noteName.match(/([^\\/][^\\/]*)/g);\n\n        // recursively add nodes\n        addNode(root, nodes, note.id);\n\n        return root;\n      }, notes.root);\n    }\n  };\n\n  var addNode = function(curDir, nodes, noteId) {\n    if (nodes.length === 1) {  // the leaf\n      curDir.children.push({\n        name: nodes[0],\n        id: noteId,\n        path: curDir.id ? curDir.id + '/' + nodes[0] : nodes[0],\n        isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n      });\n    } else {  // a folder node\n      var node = nodes.shift();\n      var dir = _.find(curDir.children,\n        function(c) {return c.name === node && c.children !== undefined;});\n      if (dir !== undefined) { // found an existing dir\n        addNode(dir, nodes, noteId);\n      } else {\n        var newDir = {\n          id: curDir.id ? curDir.id + '/' + node : node,\n          name: node,\n          hidden: true,\n          children: [],\n          isTrash: curDir.id ? curDir.id.split('/')[0] === TRASH_FOLDER_ID : false\n        };\n\n        // add the folder to flat folder map\n        notes.flatFolderMap[newDir.id] = newDir;\n\n        curDir.children.push(newDir);\n        addNode(newDir, nodes, noteId);\n      }\n    }\n  };\n\n  return notes;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteListDataFactory/noteList.datafactory.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('baseUrlSrv', baseUrlSrv);\n\nfunction baseUrlSrv() {\n  this.getPort = function() {\n    var port = Number(location.port);\n    if (!port) {\n      port = 80;\n      if (location.protocol === 'https:') {\n        port = 443;\n      }\n    }\n    //Exception for when running locally via grunt\n    if (port === 9000) {\n      port = process.env.SERVER_PORT;\n    }\n    return port;\n  };\n\n  this.getWebsocketUrl = function() {\n    var wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';\n    return wsProtocol + '//' + location.hostname + ':' + this.getPort() +\n      skipTrailingSlash(location.pathname) + '/ws';\n  };\n\n  this.getRestApiBase = function() {\n    return location.protocol + '//' + location.hostname + ':' +\n      this.getPort() + skipTrailingSlash(location.pathname) +\n      '/api';\n  };\n\n  var skipTrailingSlash = function(path) {\n    return path.replace(/\\/$/, '');\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/baseUrl/baseUrl.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('browserDetectService', browserDetectService);\n\nfunction browserDetectService() {\n  this.detectIE = function() {\n    var ua = window.navigator.userAgent;\n    var msie = ua.indexOf('MSIE ');\n    if (msie > 0) {\n      // IE 10 or older => return version number\n      return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n    var trident = ua.indexOf('Trident/');\n    if (trident > 0) {\n      // IE 11 => return version number\n      var rv = ua.indexOf('rv:');\n      return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n    var edge = ua.indexOf('Edge/');\n    if (edge > 0) {\n      // IE 12 (aka Edge) => return version number\n      return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n    }\n    // other browser\n    return false;\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/browser-detect/browserDetect.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('saveAsService', saveAsService);\n\nsaveAsService.$inject = ['browserDetectService'];\n\nfunction saveAsService(browserDetectService) {\n  this.saveAs = function(content, filename, extension) {\n    var BOM = '\\uFEFF';\n    if (browserDetectService.detectIE()) {\n      angular.element('body').append('<iframe id=\"SaveAsId\" style=\"display: none\"></iframe>');\n      var frameSaveAs = angular.element('body > iframe#SaveAsId')[0].contentWindow;\n      content = BOM + content;\n      frameSaveAs.document.open('text/json', 'replace');\n      frameSaveAs.document.write(content);\n      frameSaveAs.document.close();\n      frameSaveAs.focus();\n      var t1 = Date.now();\n      frameSaveAs.document.execCommand('SaveAs', false, filename + '.' + extension);\n      var t2 = Date.now();\n\n      //This means, this version of IE dosen't support auto download of a file with extension provided in param\n      //falling back to \".txt\"\n      if (t1 === t2) {\n        frameSaveAs.document.execCommand('SaveAs', true, filename + '.txt');\n      }\n      angular.element('body > iframe#SaveAsId').remove();\n    } else {\n      content = 'data:image/svg;charset=utf-8,' + BOM + encodeURIComponent(content);\n      angular.element('body').append('<a id=\"SaveAsId\"></a>');\n      var saveAsElement = angular.element('body > a#SaveAsId');\n      saveAsElement.attr('href', content);\n      saveAsElement.attr('download', filename + '.' + extension);\n      saveAsElement.attr('target', '_blank');\n      saveAsElement[0].click();\n      saveAsElement.remove();\n    }\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/saveAs/saveAs.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('searchService', searchService);\n\nsearchService.$inject = ['$resource', 'baseUrlSrv'];\n\nfunction searchService($resource, baseUrlSrv) {\n  this.search = function(term) {\n    this.searchTerm = term.q;\n    console.log('Searching for: %o', term.q);\n    if (!term.q) { //TODO(bzz): empty string check\n      return;\n    }\n    var encQuery = window.encodeURIComponent(term.q);\n    return $resource(baseUrlSrv.getRestApiBase() + '/notebook/search?q=' + encQuery, {}, {\n      query: {method: 'GET'}\n    });\n  };\n\n  this.searchTerm = '';\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/searchService/search.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('LoginCtrl', LoginCtrl);\n\nLoginCtrl.$inject = ['$scope', '$rootScope', '$http', '$httpParamSerializer', 'baseUrlSrv', '$location', '$timeout'];\nfunction LoginCtrl($scope, $rootScope, $http, $httpParamSerializer, baseUrlSrv, $location, $timeout) {\n\n  $scope.SigningIn = false;\n  $scope.loginParams = {};\n  $scope.login = function() {\n\n    $scope.SigningIn = true;\n    $http({\n      method: 'POST',\n      url: baseUrlSrv.getRestApiBase() + '/login',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      },\n      data: $httpParamSerializer({\n        'userName': $scope.loginParams.userName,\n        'password': $scope.loginParams.password\n      })\n    }).then(function successCallback(response) {\n      $rootScope.ticket = response.data.body;\n      angular.element('#loginModal').modal('toggle');\n      $rootScope.$broadcast('loginSuccess', true);\n      $rootScope.userName = $scope.loginParams.userName;\n      $scope.SigningIn = false;\n\n      //redirect to the page from where the user originally was\n      if ($location.search() && $location.search()['ref']) {\n        $timeout(function() {\n          var redirectLocation = $location.search()['ref'];\n          $location.$$search = {};\n          $location.path(redirectLocation);\n        }, 100);\n\n      }\n    }, function errorCallback(errorResponse) {\n      $scope.loginParams.errorText = 'The username and password that you entered don\\'t match.';\n      $scope.SigningIn = false;\n    });\n\n  };\n\n  var initValues = function() {\n    $scope.loginParams = {\n      userName: '',\n      password: ''\n    };\n  };\n\n  //handle session logout message received from WebSocket\n  $rootScope.$on('session_logout', function(event, data) {\n    if ($rootScope.userName !== '') {\n      $rootScope.userName = '';\n      $rootScope.ticket = undefined;\n\n      setTimeout(function() {\n        $scope.loginParams = {};\n        $scope.loginParams.errorText = data.info;\n        angular.element('.nav-login-btn').click();\n      }, 1000);\n      var locationPath = $location.path();\n      $location.path('/').search('ref', locationPath);\n    }\n  });\n\n  /*\n   ** $scope.$on functions below\n   */\n  $scope.$on('initLoginValues', function() {\n    initValues();\n  });\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/login/login.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('ElasticInputCtrl', ElasticInputCtrl);\n\nfunction ElasticInputCtrl() {\n  var vm = this;\n  vm.showEditor = false;\n  vm.value = '';\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/elasticInputCtrl/elasticInput.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('noteActionSrv', noteActionSrv);\n\nnoteActionSrv.$inject = ['websocketMsgSrv', '$location', 'renameSrv', 'noteListDataFactory'];\n\nfunction noteActionSrv(websocketMsgSrv, $location, renameSrv, noteListDataFactory) {\n  this.moveNoteToTrash = function(noteId, redirectToHome) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: 'Move this note to trash?',\n      message: 'This note will be moved to <strong>trash</strong>.',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.moveNoteToTrash(noteId);\n          if (redirectToHome) {\n            $location.path('/');\n          }\n        }\n      }\n    });\n  };\n\n  this.moveFolderToTrash = function(folderId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: 'Move this folder to trash?',\n      message: 'This folder will be moved to <strong>trash</strong>.',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.moveFolderToTrash(folderId);\n        }\n      }\n    });\n  };\n\n  this.removeNote = function(noteId, redirectToHome) {\n    BootstrapDialog.confirm({\n      type: BootstrapDialog.TYPE_WARNING,\n      closable: true,\n      title: 'WARNING! This note will be removed permanently',\n      message: 'This cannot be undone. Are you sure?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.deleteNote(noteId);\n          if (redirectToHome) {\n            $location.path('/');\n          }\n        }\n      }\n    });\n  };\n\n  this.removeFolder = function(folderId) {\n    BootstrapDialog.confirm({\n      type: BootstrapDialog.TYPE_WARNING,\n      closable: true,\n      title: 'WARNING! This folder will be removed permanently',\n      message: 'This cannot be undone. Are you sure?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.removeFolder(folderId);\n        }\n      }\n    });\n  };\n\n  this.restoreAll = function() {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: 'Are you sure want to restore all notes in the trash?',\n      message: 'Folders and notes in the trash will be ' +\n      '<strong>merged</strong> into their original position.',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.restoreAll();\n        }\n      }\n    });\n  };\n\n  this.emptyTrash = function() {\n    BootstrapDialog.confirm({\n      type: BootstrapDialog.TYPE_WARNING,\n      closable: true,\n      title: 'WARNING! Notes under trash will be removed permanently',\n      message: 'This cannot be undone. Are you sure?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.emptyTrash();\n        }\n      }\n    });\n  };\n\n  this.clearAllParagraphOutput = function(noteId) {\n    BootstrapDialog.confirm({\n      closable: true,\n      title: '',\n      message: 'Do you want to clear all output?',\n      callback: function(result) {\n        if (result) {\n          websocketMsgSrv.clearAllParagraphOutput(noteId);\n        }\n      }\n    });\n  };\n\n  this.renameNote = function(noteId, notePath) {\n    renameSrv.openRenameModal({\n      title: 'Rename note',\n      oldName: notePath,\n      callback: function(newName) {\n        websocketMsgSrv.renameNote(noteId, newName);\n      }\n    });\n  };\n\n  this.renameFolder = function(folderId) {\n    renameSrv.openRenameModal({\n      title: 'Rename folder',\n      oldName: folderId,\n      callback: function(newName) {\n        var newFolderId = normalizeFolderId(newName);\n        if (_.has(noteListDataFactory.flatFolderMap, newFolderId)) {\n          BootstrapDialog.confirm({\n            type: BootstrapDialog.TYPE_WARNING,\n            closable: true,\n            title: 'WARNING! The folder will be MERGED',\n            message: 'The folder will be merged into <strong>' + newFolderId + '</strong>. Are you sure?',\n            callback: function(result) {\n              if (result) {\n                websocketMsgSrv.renameFolder(folderId, newFolderId);\n              }\n            }\n          });\n        } else {\n          websocketMsgSrv.renameFolder(folderId, newFolderId);\n        }\n      }\n    });\n  };\n\n  function normalizeFolderId(folderId) {\n    folderId = folderId.trim();\n\n    while (folderId.indexOf('\\\\') > -1) {\n      folderId = folderId.replace('\\\\', '/');\n    }\n\n    while (folderId.indexOf('///') > -1) {\n      folderId = folderId.replace('///', '/');\n    }\n\n    folderId = folderId.replace('//', '/');\n\n    if (folderId === '/') {\n      return '/';\n    }\n\n    if (folderId[0] === '/') {\n      folderId = folderId.substring(1);\n    }\n\n    if (folderId.slice(-1) === '/') {\n      folderId = folderId.slice(0, -1);\n    }\n\n    return folderId;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/noteAction/noteAction.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('noteVarShareService', noteVarShareService);\n\nnoteVarShareService.$inject = [];\n\nfunction noteVarShareService() {\n  var store = {};\n\n  this.clear = function() {\n    store = {};\n  };\n\n  this.put = function(key, value) {\n    store[key] = value;\n  };\n\n  this.get = function(key) {\n    return store[key];\n  };\n\n  this.del = function(key) {\n    var v = store[key];\n    delete store[key];\n    return v;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/notevarshareService/notevarshare.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').controller('RenameCtrl', RenameCtrl);\n\nRenameCtrl.$inject = ['$scope'];\n\nfunction RenameCtrl($scope) {\n  var self = this;\n\n  $scope.params = {newName: ''};\n  $scope.isValid = true;\n\n  $scope.rename = function() {\n    angular.element('#renameModal').modal('hide');\n    self.callback($scope.params.newName);\n  };\n\n  $scope.$on('openRenameModal', function(event, options) {\n    self.validator = options.validator || defaultValidator;\n    self.callback = options.callback || function() {};\n\n    $scope.title = options.title || 'Rename';\n    $scope.params.newName = options.oldName || '';\n    $scope.validate = function() {\n      $scope.isValid = self.validator($scope.params.newName);\n    };\n\n    angular.element('#renameModal').modal('show');\n  });\n\n  function defaultValidator(str) {\n    return !!str.trim();\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/rename/rename.controller.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nangular.module('zeppelinWebApp').service('renameSrv', renameSrv);\n\nrenameSrv.$inject = ['$rootScope'];\n\nfunction renameSrv($rootScope) {\n  var self = this;\n\n  /**\n   * <options schema>\n   * title: string - Modal title\n   * oldName: string - name to initialize input\n   * callback: (newName: string)=>void - callback onButtonClick\n   * validator: (str: string)=>boolean - input validator\n   */\n  self.openRenameModal = function(options) {\n    $rootScope.$broadcast('openRenameModal', options);\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/rename/rename.service.js","/*\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n(function() {\n\n  angular.module('zeppelinWebApp').service('heliumService', heliumService);\n\n  heliumService.$inject = ['$http', 'baseUrlSrv', 'ngToast'];\n\n  function heliumService($http, baseUrlSrv, ngToast) {\n\n    var url = baseUrlSrv.getRestApiBase() + '/helium/visualizations/load';\n    if (process.env.HELIUM_VIS_DEV) {\n      url = url + '?refresh=true';\n    }\n    var visualizations = [];\n\n    // load should be promise\n    this.load = $http.get(url).success(function(response) {\n      if (response.substring(0, 'ERROR:'.length) !== 'ERROR:') {\n        eval(response);\n      } else {\n        console.error(response);\n      }\n    });\n\n    this.get = function() {\n      return visualizations;\n    };\n\n    this.getVisualizationOrder = function() {\n      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder');\n    };\n\n    this.setVisualizationOrder = function(list) {\n      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/visualizationOrder', list);\n    };\n\n    this.getAllPackageInfo = function() {\n      return $http.get(baseUrlSrv.getRestApiBase() + '/helium/all');\n    };\n\n    this.enable = function(name, artifact) {\n      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/enable/' + name, artifact);\n    };\n\n    this.disable = function(name) {\n      return $http.post(baseUrlSrv.getRestApiBase() + '/helium/disable/' + name);\n    };\n  };\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/helium/helium.service.js"],"sourceRoot":""}